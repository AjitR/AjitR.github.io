(()=>{"use strict";var je=class{constructor({container:t,inertia:e=.1,threshold:i=.5,useRaf:s=!1}={}){if(this.container=t,!this.container){console.warn("Can't init SmoothScroll class because the container passed does not exist:",t);return}this.inertia=e,this.threshold=i,this._useRaf=s,this._raf=null,this._isScrolling=!1,this.scroll={},this.store={},this.fixedEls=[],this.resize(),this.init()}init(){this.container.style.position="fixed",this.container.style.top=0,this.container.style.left=0,this.container.style.width="100%",this.container.style.contain="content",this.scroll.current!==0&&(this.scrollTo(this.scroll.current),setTimeout(()=>{this.emitScroll()},0)),window.addEventListener("scroll",()=>this.scrollEvent()),this._useRaf&&this.animate()}update(t){this.store.documentHeight=Math.round(t)||this.container.clientHeight,this.store.windowHeight=window.innerHeight,document.body.style.height=`${this.store.documentHeight}px`}resize(){this.update();let t=window.pageYOffset;this.scroll={target:t,current:t,velocity:0},this.scrollTo(this.scroll.current)}lerp(t,e,i){return((1-i)*t+i*e).toFixed(2)}scrollEvent(){this.scroll.target=window.pageYOffset}emitScroll(){this.onScrollCallback&&this.onScrollCallback({current:this.scroll.current,target:this.scroll.target,velocity:this.scroll.velocity})}scrollTo(t){t=Math.max(0,Math.min(t,this.store.documentHeight-this.store.windowHeight)),this.scroll.current=t,this.scroll.target=t,this.scroll.velocity=0,window.scrollTo(0,t),this.updatePosition(),this.emitScroll()}updatePosition(){this.container.style.transform="translate3d(0, "+-this.scroll.current+"px, 0)",this.fixedEls.forEach(t=>{t.position*this.store.windowHeight<=this.scroll.current&&(t.el.style.transform="translate3d(0, "+(this.scroll.current-t.position*this.store.windowHeight)+"px, 0)")})}render(){let t=this.scroll.current;this.scroll.current=this.lerp(this.scroll.current,this.scroll.target,this.inertia),this.scroll.velocity=this.scroll.current-t,Math.abs(this.scroll.current-this.scroll.target)>=this.threshold?(this._isScrolling=!0,this.updatePosition(),this.emitScroll()):this._isScrolling&&(this._isScrolling=!1,this.scroll.current=this.scroll.target,this.scroll.velocity=0,this.updatePosition(),this.emitScroll())}animate(){this.render(),this._raf=window.requestAnimationFrame(()=>this.animate())}onScroll(t){t&&(this.onScrollCallback=t)}destroy(){this._raf&&window.cancelAnimationFrame(this._raf),window.removeEventListener(this.scrollEvent)}};"use strict";var is=0,Xe=class{constructor({root:t,rootMargin:e="0px",threshold:i=0}){window.IntersectionObserver?(this.root=document.querySelector(t),this.root||(this.root="viewport"),this.rootMargin=e,this.threshold=i,this.els=[],this._staggerEls=[],this.observer=new IntersectionObserver(this._callback.bind(this),{root:this.root==="viewport"?null:this.root,rootMargin:this.rootMargin,threshold:this.threshold})):setTimeout(()=>{this._onErrorCallback&&this._onErrorCallback()},0)}_callback(t){t.forEach(e=>{let i=this.els.find(s=>s.el.isSameNode(e.target));if(i){if(e.intersectionRatio>i.triggerRatio){if(i.alwaysTrigger||!i.inView){i.onBeforeElVisible&&i.onBeforeElVisible(i);let s=i.stagger;this._staggerEls.forEach(r=>{r.inView&&(s+=r.stagger)}),this._staggerEls.push(i),setTimeout(()=>{i.onElVisible&&i.onElVisible(i),this._staggerEls=this._staggerEls.filter(r=>i.id!==r.id)},s)}i.inView=!0}else i.inView&&e.intersectionRatio<=i.triggerRatio&&(i.inView=!1,i.onElHidden&&i.onElHidden(i),i.keepObserving||this._unobserve(i));i.ratio=e.intersectionRatio,i.boundingClientRect=e.boundingClientRect}})}observe({elements:t=[],selector:e,keepObserving:i=!1,triggerRatio:s=0,alwaysTrigger:r=!0,stagger:n=0,onBeforeElVisible:a=()=>{},onElVisible:o=()=>{},onElHidden:h=()=>{}}){let l=t.length?t:document.querySelectorAll(e);for(let d=0;d<l.length;d++)this.els.push({el:l[d],id:is,keepObserving:i,triggerRatio:Math.max(0,Math.min(1,s))||0,alwaysTrigger:r,ratio:0,stagger:n,onBeforeElVisible:a,onElVisible:o,onElHidden:h,inView:!1,boundingClientRect:{x:0,y:0,width:0,height:0,top:0,right:0,bottom:0,left:0}}),is++,this.observer.observe(l[d])}_unobserve(t){this.observer.unobserve(t.el),this.els=this.els.filter(e=>!e.el.isSameNode(t.el))}unobserveEl(t){let e=this.els.find(i=>i.el.isSameNode(t));e&&this._unobserve(e)}unobserveEls(t){for(let e=0;e<t.length;e++)this.unobserveEl(t[e])}unobserveAll(){this.observer.disconnect(),this.els=[]}onError(t){return t&&(this._onErrorCallback=t),this}};"use strict";var He=class{constructor({container:t=document.body,cancelNavigationClass:e,cacheLinks:i,cacheNavigatedPages:s=!1,preloadMedias:r=!1,cacheLength:n=10,onStart:a={value:()=>{}},onReady:o={value:()=>{}},onLeaving:h={duration:1e3,value:()=>{}},onWaiting:l={value:()=>{}},onError:d={value:()=>{}}}){this.container=t,this.params={cancelNavigationClass:e,cacheLinks:i,cacheNavigatedPages:s,cacheLength:n,preloadMedias:r,onStart:a,onReady:o,onLeaving:h,onWaiting:l,onError:d},this.router={history:[{href:window.location.href,title:document.title}]},this.cache=[],this._isLoading=!1,this._ajaxCalls=0,this._transitionsManager={override:!1,overrideDuration:50,isWaiting:!1},this.lastLinkClicked=null,this._mutations={mutationObserver:null,isActive:!1},this._initEvents(),this.params.cacheNavigatedPages&&this._cacheResponse(window.location.href,document.documentElement.innerHTML),this.params.cacheLinks&&this._cacheContainerLinks()}_initEvents(){window.addEventListener("hashchange",()=>{this.router.history.push({href:window.location.href,title:document.title})}),window.addEventListener("popstate",()=>{let t,e;t=this.router.history[this.router.history.length-1].href,e=window.location.href;let i,s,r=!1;if(t.indexOf("#")!==-1){let n=t.indexOf("#");i=t.substring(0,n)}else i=t;if(e.indexOf("#")!==-1){let n=e.indexOf("#");s=e.substring(0,n)}else s=e;i===s&&(r=!0),r||this._launchNavigation(window.location.href,!1)}),window.addEventListener("click",t=>{let e=t.target;if(e.name!=="A"&&(e=e.closest("a")),!e)return;let i=e.getAttribute("href");if(!(this.params.cancelNavigationClass&&e.classList.contains(this.params.cancelNavigationClass))&&i.indexOf("mailto:")===-1&&!e.getAttribute("download")&&!(t.ctrlKey||t.metaKey||t.shiftKey||t.altKey)){if(window.location.pathname===i||window.location.href===i){t.preventDefault(),t.stopPropagation();return}this.lastLinkClicked=e,t.preventDefault(),t.stopPropagation(),this._launchNavigation(i,!0)}}),window.MutationObserver&&(this._mutations.isActive=!0,this._mutations.mutationObserver=new MutationObserver((t,e)=>{this._observedMutation(t)}))}_cacheResponse(t,e){if(!e)return;let i={href:t,HTMLContent:this._parseResponseContent(e),title:e.match(/<title[^>]*>([^<]+)<\/title>/).length?e.match(/<title[^>]*>([^<]+)<\/title>/)[1]:""};this.cache.length>=this.params.cacheLength&&this.cache.splice(0,1),this.cache.push(i)}_cacheContainerLinks(){let t=document.querySelectorAll(this.params.cacheLinks);for(let e=0;e<t.length;e++){let i=t[e].href;this.cache.find(r=>r.href===i)||this._AJAXCall(i,!1,(r,n)=>this._cacheResponse(n,r))}}loadPage(t,e,i=()=>{}){let s=(performance||Date).now(),r=this.cache.find(n=>n.href===t);r&&e?e({url:t,content:r.HTMLContent,title:r.title,duration:(performance||Date).now()-s}):this._AJAXCall(t,!1,(n,a)=>{if(!n){i();return}this.params.cacheNavigatedPages&&this._cacheResponse(a,n),e&&e({url:a,content:this._parseResponseContent(n),title:n.match(/<title[^>]*>([^<]+)<\/title>/)[1],duration:(performance||Date).now()-s})})}updateHistory(t,e,i=!0){let s=t||this.router.nextTitle,r=e||this.router.nextHref;i&&window.history.pushState({},s,r),document.title=s,this.router.history.push({href:r,title:s})}_launchNavigation(t,e){if(!this._isLoading){this.router.nextHTMLContent=null,this.params.onStart.value(this.router.history[this.router.history.length-1].href,t);let i=this._transitionsManager.isOverriding?this._transitionsManager.overrideDuration:this.params.onLeaving.duration,s=this.cache.find(r=>r.href===t);s?(this.router.nextHref=s.href,this.router.nextHTMLContent=s.HTMLContent,this.router.nextTitle=s.title):this._routing(t,e),setTimeout(()=>{this.params.onLeaving.value(this.router.history[this.router.history.length-1].href,t),this.router.nextHTMLContent?this._appendData(e):this._waitForData(e)},i)}}_parseResponseContent(t){let e;this.params.preloadMedias?(e=document.createElement("html"),e.innerHTML=t):(e=document.implementation.createHTMLDocument(),e.querySelector("body").innerHTML=t);let i="";if(this.container.getAttribute("id"))i="#"+this.container.getAttribute("id");else if(this.container.classList.length)for(let r=0;r<this.container.classList.length;r++)i+="."+this.container.classList[r];else i=this.container.tagName;let s=e.querySelector(i)?e.querySelector(i).innerHTML:"";return e=null,s}_routing(t,e){this._isLoading=!0,this.router.nextHref=null,t?this.router.nextHref=t:this.router.history.length>0&&(this.router.nextHref=this.router.history[this.router.history.length-1].href),this.router.nextHref&&this._AJAXCall(t,e,(i,s)=>{if(!i){this.params.onError.value(this.router.history[this.router.history.length-1].href,this.router.nextHref);return}this.router.nextHTMLContent=this._parseResponseContent(i),this.router.nextTitle=i.match(/<title[^>]*>([^<]+)<\/title>/).length?i.match(/<title[^>]*>([^<]+)<\/title>/)[1]:"",this.params.cacheNavigatedPages&&(this.cache.find(n=>n.href===t)||this._cacheResponse(s,i))})}_AJAXCall(t,e,i){let s=new XMLHttpRequest;s.onreadystatechange=()=>{s.readyState===4&&(s.status===200||s.status===0)?i&&i(s.response,s.responseURL):s.readyState===4&&s.status!==404&&this._ajaxCalls<4?(console.warn("waiting for",t),this._ajaxCalls===0&&!this._transitionsManager.isWaiting&&(this._transitionsManager.isWaiting=!0,this.params.onWaiting.value(this.router.history[this.router.history.length-1].href,this.router.nextHref)),this._ajaxCalls++,this._routing(s.responseURL,e,i)):s.readyState===4&&(this._resetRoutingState(),this.params.onError.value(this.router.history[this.router.history.length-1].href,this.router.nextHref))},s.open("GET",t,!0),s.setRequestHeader("Accept","text/html"),s.send(null)}_waitForData(t){this._transitionsManager.isWaiting||(this._transitionsManager.isWaiting=!0,this.params.onWaiting.value(this.router.history[this.router.history.length-1].href,this.router.nextHref));let e=setInterval(()=>{this.router.nextHTMLContent&&(clearInterval(e),this._appendData(t))},1e3)}_observedMutation(t){for(let e=0;e<t.length;e++)if(t[e].addedNodes.length&&t[e].target.isEqualNode(this.container)){this._mutations.mutationObserver.disconnect(),setTimeout(()=>{this._newContentAdded()},34);break}}_newContentAdded(){setTimeout(()=>{this.params.onReady.value(this.router.history[this.router.history.length-2].href,this.router.history[this.router.history.length-1].href),this._resetRoutingState(),this.params.cacheLinks&&this._cacheContainerLinks()},0)}_appendData(t){this.updateHistory(this.router.nextTitle,this.router.nextHref,t);let e=this.router.nextHTMLContent;e&&(this._mutations.isActive?this._mutations.mutationObserver.observe(this.container,{childList:!0}):setTimeout(()=>{this._newContentAdded()},e.children.length*25),this.container.textContent="",this.container.insertAdjacentHTML("beforeend",e))}_resetRoutingState(){this._ajaxCalls=0,this._isLoading=!1,this._transitionsManager.isWaiting=!1,this._transitionsManager.isOverriding=!1}overrideTransitionDuration(t=50){this._transitionsManager.isOverriding=!0,this._transitionsManager.overrideDuration=t}isTransitionOverrided(){return this._transitionsManager.isOverriding}};function bt(u){if(u===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u}function ss(u,t){u.prototype=Object.create(t.prototype),u.prototype.constructor=u,u.__proto__=t}var Q={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Kt={duration:.5,overwrite:!1,delay:0},Ge,_t=1e8,F=1/_t,Ye=Math.PI*2,vr=Ye/4,br=0,rs=Math.sqrt,wr=Math.cos,Pr=Math.sin,H=function(t){return typeof t=="string"},X=function(t){return typeof t=="function"},wt=function(t){return typeof t=="number"},Se=function(t){return typeof t=="undefined"},Pt=function(t){return typeof t=="object"},J=function(t){return t!==!1},ns=function(){return typeof window!="undefined"},as=function(t){return X(t)||H(t)},os=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},it=Array.isArray,qe=/(?:-?\.?\d|\.)+/gi,Qe=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,jt=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,Ze=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,Ke=/[+-]=-?[.\d]+/,hs=/[^,'"\[\]\s]+/gi,Tr=/[\d.+\-=]+(?:e[-+]\d*)*/i,N,mt,Je,$e,st={},Re={},ls,us=function(t){return(Re=$t(t,st))&&ut},Ee=function(t,e){return console.warn("Invalid property",t,"set to",e,"Missing plugin? gsap.registerPlugin()")},Me=function(t,e){return!e&&console.warn(t)},ds=function(t,e){return t&&(st[t]=e)&&Re&&(Re[t]=e)||st},Jt=function(){return 0},ti={},Et=[],ei={},cs,$={},ii={},fs=30,Ae=[],si="",ri=function(t){var e=t[0],i,s;if(Pt(e)||X(e)||(t=[t]),!(i=(e._gsap||{}).harness)){for(s=Ae.length;s--&&!Ae[s].targetTest(e););i=Ae[s]}for(s=t.length;s--;)t[s]&&(t[s]._gsap||(t[s]._gsap=new gi(t[s],i)))||t.splice(s,1);return t},Mt=function(t){return t._gsap||ri(ht(t))[0]._gsap},ni=function(t,e,i){return(i=t[e])&&X(i)?t[e]():Se(i)&&t.getAttribute&&t.getAttribute(e)||i},tt=function(t,e){return(t=t.split(",")).forEach(e)||t},A=function(t){return Math.round(t*1e5)/1e5||0},Sr=function(t,e){for(var i=e.length,s=0;t.indexOf(e[s])<0&&++s<i;);return s<i},Ce=function(){var t=Et.length,e=Et.slice(0),i,s;for(ei={},Et.length=0,i=0;i<t;i++)s=e[i],s&&s._lazy&&(s.render(s._lazy[0],s._lazy[1],!0)._lazy=0)},ps=function(t,e,i,s){Et.length&&Ce(),t.render(e,i,s),Et.length&&Ce()},gs=function(t){var e=parseFloat(t);return(e||e===0)&&(t+"").match(hs).length<2?e:H(t)?t.trim():t},_s=function(t){return t},at=function(t,e){for(var i in e)i in t||(t[i]=e[i]);return t},Rr=function(t,e){for(var i in e)i in t||i==="duration"||i==="ease"||(t[i]=e[i])},$t=function(t,e){for(var i in e)t[i]=e[i];return t},ms=function u(t,e){for(var i in e)i!=="__proto__"&&i!=="constructor"&&i!=="prototype"&&(t[i]=Pt(e[i])?u(t[i]||(t[i]={}),e[i]):e[i]);return t},ai=function(t,e){var i={},s;for(s in t)s in e||(i[s]=t[s]);return i},Le=function(t){var e=t.parent||N,i=t.keyframes?Rr:at;if(J(t.inherit))for(;e;)i(t,e.vars.defaults),e=e.parent||e._dp;return t},Er=function(t,e){for(var i=t.length,s=i===e.length;s&&i--&&t[i]===e[i];);return i<0},Mr=function(t,e,i,s,r){i===void 0&&(i="_first"),s===void 0&&(s="_last");var n=t[s],a;if(r)for(a=e[r];n&&n[r]>a;)n=n._prev;return n?(e._next=n._next,n._next=e):(e._next=t[i],t[i]=e),e._next?e._next._prev=e:t[s]=e,e._prev=n,e.parent=e._dp=t,e},ke=function(t,e,i,s){i===void 0&&(i="_first"),s===void 0&&(s="_last");var r=e._prev,n=e._next;r?r._next=n:t[i]===e&&(t[i]=n),n?n._prev=r:t[s]===e&&(t[s]=r),e._next=e._prev=e.parent=null},At=function(t,e){t.parent&&(!e||t.parent.autoRemoveChildren)&&t.parent.remove(t),t._act=0},Xt=function(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var i=t;i;)i._dirty=1,i=i.parent;return t},Ar=function(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t},Cr=function u(t){return!t||t._ts&&u(t.parent)},xs=function(t){return t._repeat?te(t._tTime,t=t.duration()+t._rDelay)*t:0},te=function(t,e){var i=Math.floor(t/=e);return t&&i===t?i-1:i},De=function(t,e){return(t-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},oi=function(t){return t._end=A(t._start+(t._tDur/Math.abs(t._ts||t._rts||F)||0))},ys=function(t,e){var i=t._dp;return i&&i.smoothChildTiming&&t._ts&&(t._start=A(i._time-(t._ts>0?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),oi(t),i._dirty||Xt(i,t)),t},vs=function(t,e){var i;if((e._time||e._initted&&!e._dur)&&(i=De(t.rawTime(),e),(!e._dur||fe(0,e.totalDuration(),i)-e._tTime>F)&&e.render(i,!0)),Xt(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(i=t;i._dp;)i.rawTime()>=0&&i.totalTime(i._tTime),i=i._dp;t._zTime=-F}},xt=function(t,e,i,s){return e.parent&&At(e),e._start=A((wt(i)?i:i||t!==N?ot(t,i,e):t._time)+e._delay),e._end=A(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),Mr(t,e,"_first","_last",t._sort?"_start":0),hi(e)||(t._recent=e),s||vs(t,e),t},bs=function(t,e){return(st.ScrollTrigger||Ee("scrollTrigger",e))&&st.ScrollTrigger.create(e,t)},ws=function(t,e,i,s){if($r(t,e),!t._initted)return 1;if(!i&&t._pt&&(t._dur&&t.vars.lazy!==!1||!t._dur&&t.vars.lazy)&&cs!==rt.frame)return Et.push(t),t._lazy=[e,s],1},Lr=function u(t){var e=t.parent;return e&&e._ts&&e._initted&&!e._lock&&(e.rawTime()<0||u(e))},hi=function(t){var e=t.data;return e==="isFromStart"||e==="isStart"},kr=function(t,e,i,s){var r=t.ratio,n=e<0||!e&&(!t._start&&Lr(t)&&!(!t._initted&&hi(t))||(t._ts<0||t._dp._ts<0)&&!hi(t))?0:1,a=t._rDelay,o=0,h,l,d;if(a&&t._repeat&&(o=fe(0,t._tDur,e),l=te(o,a),d=te(t._tTime,a),t._yoyo&&l&1&&(n=1-n),l!==d&&(r=1-n,t.vars.repeatRefresh&&t._initted&&t.invalidate())),n!==r||s||t._zTime===F||!e&&t._zTime){if(!t._initted&&ws(t,e,s,i))return;for(d=t._zTime,t._zTime=e||(i?F:0),i||(i=e&&!d),t.ratio=n,t._from&&(n=1-n),t._time=0,t._tTime=o,h=t._pt;h;)h.r(n,h.d),h=h._next;t._startAt&&e<0&&t._startAt.render(e,!0,!0),t._onUpdate&&!i&&lt(t,"onUpdate"),o&&t._repeat&&!i&&t.parent&&lt(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===n&&(n&&At(t,1),i||(lt(t,n?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)},Dr=function(t,e,i){var s;if(i>e)for(s=t._first;s&&s._start<=i;){if(!s._dur&&s.data==="isPause"&&s._start>e)return s;s=s._next}else for(s=t._last;s&&s._start>=i;){if(!s._dur&&s.data==="isPause"&&s._start<e)return s;s=s._prev}},ee=function(t,e,i,s){var r=t._repeat,n=A(e)||0,a=t._tTime/t._tDur;return a&&!s&&(t._time*=n/t._dur),t._dur=n,t._tDur=r?r<0?1e10:A(n*(r+1)+t._rDelay*r):n,a&&!s?ys(t,t._tTime=t._tDur*a):t.parent&&oi(t),i||Xt(t.parent,t),t},Ps=function(t){return t instanceof Y?Xt(t):ee(t,t._dur)},Or={_start:0,endTime:Jt,totalDuration:Jt},ot=function u(t,e,i){var s=t.labels,r=t._recent||Or,n=t.duration()>=_t?r.endTime(!1):t._dur,a,o,h;return H(e)&&(isNaN(e)||e in s)?(o=e.charAt(0),h=e.substr(-1)==="%",a=e.indexOf("="),o==="<"||o===">"?(a>=0&&(e=e.replace(/=/,"")),(o==="<"?r._start:r.endTime(r._repeat>=0))+(parseFloat(e.substr(1))||0)*(h?(a<0?r:i).totalDuration()/100:1)):a<0?(e in s||(s[e]=n),s[e]):(o=parseFloat(e.charAt(a-1)+e.substr(a+1)),h&&i&&(o=o/100*(it(i)?i[0]:i).totalDuration()),a>1?u(t,e.substr(0,a-1),i)+o:n+o)):e==null?n:+e},ce=function(t,e,i){var s=wt(e[1]),r=(s?2:1)+(t<2?0:1),n=e[r],a,o;if(s&&(n.duration=e[1]),n.parent=i,t){for(a=n,o=i;o&&!("immediateRender"in a);)a=o.vars.defaults||{},o=J(o.vars.inherit)&&o.parent;n.immediateRender=J(a.immediateRender),t<2?n.runBackwards=1:n.startAt=e[r-1]}return new j(e[0],n,e[r+1])},Ct=function(t,e){return t||t===0?e(t):e},fe=function(t,e,i){return i<t?t:i>e?e:i},et=function(t){if(typeof t!="string")return"";var e=Tr.exec(t);return e?t.substr(e.index+e[0].length):""},Fr=function(t,e,i){return Ct(i,function(s){return fe(t,e,s)})},li=[].slice,Ts=function(t,e){return t&&Pt(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&Pt(t[0]))&&!t.nodeType&&t!==mt},zr=function(t,e,i){return i===void 0&&(i=[]),t.forEach(function(s){var r;return H(s)&&!e||Ts(s,1)?(r=i).push.apply(r,ht(s)):i.push(s)})||i},ht=function(t,e,i){return H(t)&&!i&&(Je||!se())?li.call((e||$e).querySelectorAll(t),0):it(t)?zr(t,i):Ts(t)?li.call(t,0):t?[t]:[]},Vr=function(t){return t=ht(t)[0]||Me("Invalid scope")||{},function(e){var i=t.current||t.nativeElement||t;return ht(e,i.querySelectorAll?i:i===t?Me("Invalid scope")||$e.createElement("div"):t)}},Ss=function(t){return t.sort(function(){return .5-Math.random()})},Rs=function(t){if(X(t))return t;var e=Pt(t)?t:{each:t},i=re(e.ease),s=e.from||0,r=parseFloat(e.base)||0,n={},a=s>0&&s<1,o=isNaN(s)||a,h=e.axis,l=s,d=s;return H(s)?l=d={center:.5,edges:.5,end:1}[s]||0:!a&&o&&(l=s[0],d=s[1]),function(p,f,g){var c=(g||e).length,_=n[c],m,b,v,P,x,y,T,S,w;if(!_){if(w=e.grid==="auto"?0:(e.grid||[1,_t])[1],!w){for(T=-_t;T<(T=g[w++].getBoundingClientRect().left)&&w<c;);w--}for(_=n[c]=[],m=o?Math.min(w,c)*l-.5:s%w,b=o?c*d/w-.5:s/w|0,T=0,S=_t,y=0;y<c;y++)v=y%w-m,P=b-(y/w|0),_[y]=x=h?Math.abs(h==="y"?P:v):rs(v*v+P*P),x>T&&(T=x),x<S&&(S=x);s==="random"&&Ss(_),_.max=T-S,_.min=S,_.v=c=(parseFloat(e.amount)||parseFloat(e.each)*(w>c?c-1:h?h==="y"?c/w:w:Math.max(w,c/w))||0)*(s==="edges"?-1:1),_.b=c<0?r-c:r,_.u=et(e.amount||e.each)||0,i=i&&c<0?Fs(i):i}return c=(_[p]-_.min)/_.max||0,A(_.b+(i?i(c):c)*_.v)+_.u}},ui=function(t){var e=t<1?Math.pow(10,(t+"").length-2):1;return function(i){var s=Math.round(parseFloat(i)/t)*t*e;return(s-s%1)/e+(wt(i)?0:et(i))}},Es=function(t,e){var i=it(t),s,r;return!i&&Pt(t)&&(s=i=t.radius||_t,t.values?(t=ht(t.values),(r=!wt(t[0]))&&(s*=s)):t=ui(t.increment)),Ct(e,i?X(t)?function(n){return r=t(n),Math.abs(r-n)<=s?r:n}:function(n){for(var a=parseFloat(r?n.x:n),o=parseFloat(r?n.y:0),h=_t,l=0,d=t.length,p,f;d--;)r?(p=t[d].x-a,f=t[d].y-o,p=p*p+f*f):p=Math.abs(t[d]-a),p<h&&(h=p,l=d);return l=!s||h<=s?t[l]:n,r||l===n||wt(n)?l:l+et(n)}:ui(t))},Ms=function(t,e,i,s){return Ct(it(t)?!e:i===!0?!!(i=0):!s,function(){return it(t)?t[~~(Math.random()*t.length)]:(i=i||1e-5)&&(s=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((t-i/2+Math.random()*(e-t+i*.99))/i)*i*s)/s})},Ir=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return function(s){return e.reduce(function(r,n){return n(r)},s)}},Br=function(t,e){return function(i){return t(parseFloat(i))+(e||et(i))}},Ur=function(t,e,i){return Cs(t,e,0,1,i)},As=function(t,e,i){return Ct(i,function(s){return t[~~e(s)]})},Nr=function u(t,e,i){var s=e-t;return it(t)?As(t,u(0,t.length),e):Ct(i,function(r){return(s+(r-t)%s)%s+t})},Wr=function u(t,e,i){var s=e-t,r=s*2;return it(t)?As(t,u(0,t.length-1),e):Ct(i,function(n){return n=(r+(n-t)%r)%r||0,t+(n>s?r-n:n)})},pe=function(t){for(var e=0,i="",s,r,n,a;~(s=t.indexOf("random(",e));)n=t.indexOf(")",s),a=t.charAt(s+7)==="[",r=t.substr(s+7,n-s-7).match(a?hs:qe),i+=t.substr(e,s-e)+Ms(a?r:+r[0],a?0:+r[1],+r[2]||1e-5),e=n+1;return i+t.substr(e,t.length-e)},Cs=function(t,e,i,s,r){var n=e-t,a=s-i;return Ct(r,function(o){return i+((o-t)/n*a||0)})},jr=function u(t,e,i,s){var r=isNaN(t+e)?0:function(f){return(1-f)*t+f*e};if(!r){var n=H(t),a={},o,h,l,d,p;if(i===!0&&(s=1)&&(i=null),n)t={p:t},e={p:e};else if(it(t)&&!it(e)){for(l=[],d=t.length,p=d-2,h=1;h<d;h++)l.push(u(t[h-1],t[h]));d--,r=function(g){g*=d;var c=Math.min(p,~~g);return l[c](g-c)},i=e}else s||(t=$t(it(t)?[]:{},t));if(!l){for(o in e)_i.call(a,t,o,"get",e[o]);r=function(g){return vi(g,a)||(n?t.p:t)}}}return Ct(i,r)},Ls=function(t,e,i){var s=t.labels,r=_t,n,a,o;for(n in s)a=s[n]-e,a<0==!!i&&a&&r>(a=Math.abs(a))&&(o=n,r=a);return o},lt=function(t,e,i){var s=t.vars,r=s[e],n,a;if(!!r)return n=s[e+"Params"],a=s.callbackScope||t,i&&Et.length&&Ce(),n?r.apply(a,n):r.call(a)},ge=function(t){return At(t),t.scrollTrigger&&t.scrollTrigger.kill(!1),t.progress()<1&&lt(t,"onInterrupt"),t},ie,Xr=function(t){t=!t.name&&t.default||t;var e=t.name,i=X(t),s=e&&!i&&t.init?function(){this._props=[]}:t,r={init:Jt,render:vi,add:_i,kill:on,modifier:an,rawVars:0},n={targetTest:0,get:0,getSetter:Fe,aliases:{},register:0};if(se(),t!==s){if($[e])return;at(s,at(ai(t,r),n)),$t(s.prototype,$t(r,ai(t,n))),$[s.prop=e]=s,t.targetTest&&(Ae.push(s),ti[e]=1),e=(e==="css"?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}ds(e,s),t.register&&t.register(ut,s,Z)},V=255,_e={aqua:[0,V,V],lime:[0,V,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,V],navy:[0,0,128],white:[V,V,V],olive:[128,128,0],yellow:[V,V,0],orange:[V,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[V,0,0],pink:[V,192,203],cyan:[0,V,V],transparent:[V,V,V,0]},di=function(t,e,i){return t=t<0?t+1:t>1?t-1:t,(t*6<1?e+(i-e)*t*6:t<.5?i:t*3<2?e+(i-e)*(2/3-t)*6:e)*V+.5|0},ks=function(t,e,i){var s=t?wt(t)?[t>>16,t>>8&V,t&V]:0:_e.black,r,n,a,o,h,l,d,p,f,g;if(!s){if(t.substr(-1)===","&&(t=t.substr(0,t.length-1)),_e[t])s=_e[t];else if(t.charAt(0)==="#"){if(t.length<6&&(r=t.charAt(1),n=t.charAt(2),a=t.charAt(3),t="#"+r+r+n+n+a+a+(t.length===5?t.charAt(4)+t.charAt(4):"")),t.length===9)return s=parseInt(t.substr(1,6),16),[s>>16,s>>8&V,s&V,parseInt(t.substr(7),16)/255];t=parseInt(t.substr(1),16),s=[t>>16,t>>8&V,t&V]}else if(t.substr(0,3)==="hsl"){if(s=g=t.match(qe),!e)o=+s[0]%360/360,h=+s[1]/100,l=+s[2]/100,n=l<=.5?l*(h+1):l+h-l*h,r=l*2-n,s.length>3&&(s[3]*=1),s[0]=di(o+1/3,r,n),s[1]=di(o,r,n),s[2]=di(o-1/3,r,n);else if(~t.indexOf("="))return s=t.match(Qe),i&&s.length<4&&(s[3]=1),s}else s=t.match(qe)||_e.transparent;s=s.map(Number)}return e&&!g&&(r=s[0]/V,n=s[1]/V,a=s[2]/V,d=Math.max(r,n,a),p=Math.min(r,n,a),l=(d+p)/2,d===p?o=h=0:(f=d-p,h=l>.5?f/(2-d-p):f/(d+p),o=d===r?(n-a)/f+(n<a?6:0):d===n?(a-r)/f+2:(r-n)/f+4,o*=60),s[0]=~~(o+.5),s[1]=~~(h*100+.5),s[2]=~~(l*100+.5)),i&&s.length<4&&(s[3]=1),s},Ds=function(t){var e=[],i=[],s=-1;return t.split(Tt).forEach(function(r){var n=r.match(jt)||[];e.push.apply(e,n),i.push(s+=n.length+1)}),e.c=i,e},Os=function(t,e,i){var s="",r=(t+s).match(Tt),n=e?"hsla(":"rgba(",a=0,o,h,l,d;if(!r)return t;if(r=r.map(function(p){return(p=ks(p,e,1))&&n+(e?p[0]+","+p[1]+"%,"+p[2]+"%,"+p[3]:p.join(","))+")"}),i&&(l=Ds(t),o=i.c,o.join(s)!==l.c.join(s)))for(h=t.replace(Tt,"1").split(jt),d=h.length-1;a<d;a++)s+=h[a]+(~o.indexOf(a)?r.shift()||n+"0,0,0,0)":(l.length?l:r.length?r:i).shift());if(!h)for(h=t.split(Tt),d=h.length-1;a<d;a++)s+=h[a]+r[a];return s+h[d]},Tt=function(){var u="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",t;for(t in _e)u+="|"+t+"\\b";return new RegExp(u+")","gi")}(),Hr=/hsl[a]?\(/,ci=function(t){var e=t.join(" "),i;if(Tt.lastIndex=0,Tt.test(e))return i=Hr.test(e),t[1]=Os(t[1],i),t[0]=Os(t[0],i,Ds(t[1])),!0},Oe,rt=function(){var u=Date.now,t=500,e=33,i=u(),s=i,r=1e3/240,n=r,a=[],o,h,l,d,p,f,g=function c(_){var m=u()-s,b=_===!0,v,P,x,y;if(m>t&&(i+=m-e),s+=m,x=s-i,v=x-n,(v>0||b)&&(y=++d.frame,p=x-d.time*1e3,d.time=x=x/1e3,n+=v+(v>=r?4:r-v),P=1),b||(o=h(c)),P)for(f=0;f<a.length;f++)a[f](x,p,y,_)};return d={time:0,frame:0,tick:function(){g(!0)},deltaRatio:function(_){return p/(1e3/(_||60))},wake:function(){ls&&(!Je&&ns()&&(mt=Je=window,$e=mt.document||{},st.gsap=ut,(mt.gsapVersions||(mt.gsapVersions=[])).push(ut.version),us(Re||mt.GreenSockGlobals||!mt.gsap&&mt||{}),l=mt.requestAnimationFrame),o&&d.sleep(),h=l||function(_){return setTimeout(_,n-d.time*1e3+1|0)},Oe=1,g(2))},sleep:function(){(l?mt.cancelAnimationFrame:clearTimeout)(o),Oe=0,h=Jt},lagSmoothing:function(_,m){t=_||1/F,e=Math.min(m,t,0)},fps:function(_){r=1e3/(_||240),n=d.time*1e3+r},add:function(_){a.indexOf(_)<0&&a.push(_),se()},remove:function(_){var m;~(m=a.indexOf(_))&&a.splice(m,1)&&f>=m&&f--},_listeners:a},d}(),se=function(){return!Oe&&rt.wake()},L={},Gr=/^[\d.\-M][\d.\-,\s]/,Yr=/["']/g,qr=function(t){for(var e={},i=t.substr(1,t.length-3).split(":"),s=i[0],r=1,n=i.length,a,o,h;r<n;r++)o=i[r],a=r!==n-1?o.lastIndexOf(","):o.length,h=o.substr(0,a),e[s]=isNaN(h)?h.replace(Yr,"").trim():+h,s=o.substr(a+1).trim();return e},Qr=function(t){var e=t.indexOf("(")+1,i=t.indexOf(")"),s=t.indexOf("(",e);return t.substring(e,~s&&s<i?t.indexOf(")",i+1):i)},Zr=function(t){var e=(t+"").split("("),i=L[e[0]];return i&&e.length>1&&i.config?i.config.apply(null,~t.indexOf("{")?[qr(e[1])]:Qr(t).split(",").map(gs)):L._CE&&Gr.test(t)?L._CE("",t):i},Fs=function(t){return function(e){return 1-t(1-e)}},zs=function u(t,e){for(var i=t._first,s;i;)i instanceof Y?u(i,e):i.vars.yoyoEase&&(!i._yoyo||!i._repeat)&&i._yoyo!==e&&(i.timeline?u(i.timeline,e):(s=i._ease,i._ease=i._yEase,i._yEase=s,i._yoyo=e)),i=i._next},re=function(t,e){return t&&(X(t)?t:L[t]||Zr(t))||e},Ht=function(t,e,i,s){i===void 0&&(i=function(o){return 1-e(1-o)}),s===void 0&&(s=function(o){return o<.5?e(o*2)/2:1-e((1-o)*2)/2});var r={easeIn:e,easeOut:i,easeInOut:s},n;return tt(t,function(a){L[a]=st[a]=r,L[n=a.toLowerCase()]=i;for(var o in r)L[n+(o==="easeIn"?".in":o==="easeOut"?".out":".inOut")]=L[a+"."+o]=r[o]}),r},Vs=function(t){return function(e){return e<.5?(1-t(1-e*2))/2:.5+t((e-.5)*2)/2}},fi=function u(t,e,i){var s=e>=1?e:1,r=(i||(t?.3:.45))/(e<1?e:1),n=r/Ye*(Math.asin(1/s)||0),a=function(l){return l===1?1:s*Math.pow(2,-10*l)*Pr((l-n)*r)+1},o=t==="out"?a:t==="in"?function(h){return 1-a(1-h)}:Vs(a);return r=Ye/r,o.config=function(h,l){return u(t,h,l)},o},pi=function u(t,e){e===void 0&&(e=1.70158);var i=function(n){return n?--n*n*((e+1)*n+e)+1:0},s=t==="out"?i:t==="in"?function(r){return 1-i(1-r)}:Vs(i);return s.config=function(r){return u(t,r)},s};tt("Linear,Quad,Cubic,Quart,Quint,Strong",function(u,t){var e=t<5?t+1:t;Ht(u+",Power"+(e-1),t?function(i){return Math.pow(i,e)}:function(i){return i},function(i){return 1-Math.pow(1-i,e)},function(i){return i<.5?Math.pow(i*2,e)/2:1-Math.pow((1-i)*2,e)/2})});L.Linear.easeNone=L.none=L.Linear.easeIn;Ht("Elastic",fi("in"),fi("out"),fi());(function(u,t){var e=1/t,i=2*e,s=2.5*e,r=function(a){return a<e?u*a*a:a<i?u*Math.pow(a-1.5/t,2)+.75:a<s?u*(a-=2.25/t)*a+.9375:u*Math.pow(a-2.625/t,2)+.984375};Ht("Bounce",function(n){return 1-r(1-n)},r)})(7.5625,2.75);Ht("Expo",function(u){return u?Math.pow(2,10*(u-1)):0});Ht("Circ",function(u){return-(rs(1-u*u)-1)});Ht("Sine",function(u){return u===1?1:-wr(u*vr)+1});Ht("Back",pi("in"),pi("out"),pi());L.SteppedEase=L.steps=st.SteppedEase={config:function(t,e){t===void 0&&(t=1);var i=1/t,s=t+(e?0:1),r=e?1:0,n=1-F;return function(a){return((s*fe(0,n,a)|0)+r)*i}}};Kt.ease=L["quad.out"];tt("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(u){return si+=u+","+u+"Params,"});var gi=function(t,e){this.id=br++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:ni,this.set=e?e.getSetter:Fe},me=function(){function u(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===Infinity?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,ee(this,+e.duration,1,1),this.data=e.data,Oe||rt.wake()}var t=u.prototype;return t.delay=function(i){return i||i===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+i-this._delay),this._delay=i,this):this._delay},t.duration=function(i){return arguments.length?this.totalDuration(this._repeat>0?i+(i+this._rDelay)*this._repeat:i):this.totalDuration()&&this._dur},t.totalDuration=function(i){return arguments.length?(this._dirty=0,ee(this,this._repeat<0?i:(i-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(i,s){if(se(),!arguments.length)return this._tTime;var r=this._dp;if(r&&r.smoothChildTiming&&this._ts){for(ys(this,i),!r._dp||r.parent||vs(r,this);r.parent;)r.parent._time!==r._start+(r._ts>=0?r._tTime/r._ts:(r.totalDuration()-r._tTime)/-r._ts)&&r.totalTime(r._tTime,!0),r=r.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&i<this._tDur||this._ts<0&&i>0||!this._tDur&&!i)&&xt(this._dp,this,this._start-this._delay)}return(this._tTime!==i||!this._dur&&!s||this._initted&&Math.abs(this._zTime)===F||!i&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=i),ps(this,i,s)),this},t.time=function(i,s){return arguments.length?this.totalTime(Math.min(this.totalDuration(),i+xs(this))%(this._dur+this._rDelay)||(i?this._dur:0),s):this._time},t.totalProgress=function(i,s){return arguments.length?this.totalTime(this.totalDuration()*i,s):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},t.progress=function(i,s){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-i:i)+xs(this),s):this.duration()?Math.min(1,this._time/this._dur):this.ratio},t.iteration=function(i,s){var r=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(i-1)*r,s):this._repeat?te(this._tTime,r)+1:1},t.timeScale=function(i){if(!arguments.length)return this._rts===-F?0:this._rts;if(this._rts===i)return this;var s=this.parent&&this._ts?De(this.parent._time,this):this._tTime;return this._rts=+i||0,this._ts=this._ps||i===-F?0:this._rts,Ar(this.totalTime(fe(-this._delay,this._tDur,s),!0))},t.paused=function(i){return arguments.length?(this._ps!==i&&(this._ps=i,i?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(se(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==F&&(this._tTime-=F)))),this):this._ps},t.startTime=function(i){if(arguments.length){this._start=i;var s=this.parent||this._dp;return s&&(s._sort||!this.parent)&&xt(s,this,i-this._delay),this}return this._start},t.endTime=function(i){return this._start+(J(i)?this.totalDuration():this.duration())/Math.abs(this._ts)},t.rawTime=function(i){var s=this.parent||this._dp;return s?i&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?De(s.rawTime(i),this):this._tTime:this._tTime},t.globalTime=function(i){for(var s=this,r=arguments.length?i:s.rawTime();s;)r=s._start+r/(s._ts||1),s=s._dp;return r},t.repeat=function(i){return arguments.length?(this._repeat=i===Infinity?-2:i,Ps(this)):this._repeat===-2?Infinity:this._repeat},t.repeatDelay=function(i){if(arguments.length){var s=this._time;return this._rDelay=i,Ps(this),s?this.time(s):this}return this._rDelay},t.yoyo=function(i){return arguments.length?(this._yoyo=i,this):this._yoyo},t.seek=function(i,s){return this.totalTime(ot(this,i),J(s))},t.restart=function(i,s){return this.play().totalTime(i?-this._delay:0,J(s))},t.play=function(i,s){return i!=null&&this.seek(i,s),this.reversed(!1).paused(!1)},t.reverse=function(i,s){return i!=null&&this.seek(i||this.totalDuration(),s),this.reversed(!0).paused(!1)},t.pause=function(i,s){return i!=null&&this.seek(i,s),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(i){return arguments.length?(!!i!==this.reversed()&&this.timeScale(-this._rts||(i?-F:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-F,this},t.isActive=function(){var i=this.parent||this._dp,s=this._start,r;return!!(!i||this._ts&&this._initted&&i.isActive()&&(r=i.rawTime(!0))>=s&&r<this.endTime(!0)-F)},t.eventCallback=function(i,s,r){var n=this.vars;return arguments.length>1?(s?(n[i]=s,r&&(n[i+"Params"]=r),i==="onUpdate"&&(this._onUpdate=s)):delete n[i],this):n[i]},t.then=function(i){var s=this;return new Promise(function(r){var n=X(i)?i:_s,a=function(){var h=s.then;s.then=null,X(n)&&(n=n(s))&&(n.then||n===s)&&(s.then=h),r(n),s.then=h};s._initted&&s.totalProgress()===1&&s._ts>=0||!s._tTime&&s._ts<0?a():s._prom=a})},t.kill=function(){ge(this)},u}();at(me.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-F,_prom:0,_ps:!1,_rts:1});var Y=function(u){ss(t,u);function t(i,s){var r;return i===void 0&&(i={}),r=u.call(this,i)||this,r.labels={},r.smoothChildTiming=!!i.smoothChildTiming,r.autoRemoveChildren=!!i.autoRemoveChildren,r._sort=J(i.sortChildren),N&&xt(i.parent||N,bt(r),s),i.reversed&&r.reverse(),i.paused&&r.paused(!0),i.scrollTrigger&&bs(bt(r),i.scrollTrigger),r}var e=t.prototype;return e.to=function(s,r,n){return ce(0,arguments,this),this},e.from=function(s,r,n){return ce(1,arguments,this),this},e.fromTo=function(s,r,n,a){return ce(2,arguments,this),this},e.set=function(s,r,n){return r.duration=0,r.parent=this,Le(r).repeatDelay||(r.repeat=0),r.immediateRender=!!r.immediateRender,new j(s,r,ot(this,n),1),this},e.call=function(s,r,n){return xt(this,j.delayedCall(0,s,r),n)},e.staggerTo=function(s,r,n,a,o,h,l){return n.duration=r,n.stagger=n.stagger||a,n.onComplete=h,n.onCompleteParams=l,n.parent=this,new j(s,n,ot(this,o)),this},e.staggerFrom=function(s,r,n,a,o,h,l){return n.runBackwards=1,Le(n).immediateRender=J(n.immediateRender),this.staggerTo(s,r,n,a,o,h,l)},e.staggerFromTo=function(s,r,n,a,o,h,l,d){return a.startAt=n,Le(a).immediateRender=J(a.immediateRender),this.staggerTo(s,r,a,o,h,l,d)},e.render=function(s,r,n){var a=this._time,o=this._dirty?this.totalDuration():this._tDur,h=this._dur,l=this!==N&&s>o-F&&s>=0?o:s<F?0:s,d=this._zTime<0!=s<0&&(this._initted||!h),p,f,g,c,_,m,b,v,P,x,y,T;if(l!==this._tTime||n||d){if(a!==this._time&&h&&(l+=this._time-a,s+=this._time-a),p=l,P=this._start,v=this._ts,m=!v,d&&(h||(a=this._zTime),(s||!r)&&(this._zTime=s)),this._repeat){if(y=this._yoyo,_=h+this._rDelay,this._repeat<-1&&s<0)return this.totalTime(_*100+s,r,n);if(p=A(l%_),l===o?(c=this._repeat,p=h):(c=~~(l/_),c&&c===l/_&&(p=h,c--),p>h&&(p=h)),x=te(this._tTime,_),!a&&this._tTime&&x!==c&&(x=c),y&&c&1&&(p=h-p,T=1),c!==x&&!this._lock){var S=y&&x&1,w=S===(y&&c&1);if(c<x&&(S=!S),a=S?0:h,this._lock=1,this.render(a||(T?0:A(c*_)),r,!h)._lock=0,this._tTime=l,!r&&this.parent&&lt(this,"onRepeat"),this.vars.repeatRefresh&&!T&&(this.invalidate()._lock=1),a&&a!==this._time||m!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(h=this._dur,o=this._tDur,w&&(this._lock=2,a=S?h:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!T&&this.invalidate()),this._lock=0,!this._ts&&!m)return this;zs(this,T)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(b=Dr(this,A(a),A(p)),b&&(l-=p-(p=b._start))),this._tTime=l,this._time=p,this._act=!v,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=s,a=0),!a&&p&&!r&&(lt(this,"onStart"),this._tTime!==l))return this;if(p>=a&&s>=0)for(f=this._first;f;){if(g=f._next,(f._act||p>=f._start)&&f._ts&&b!==f){if(f.parent!==this)return this.render(s,r,n);if(f.render(f._ts>0?(p-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(p-f._start)*f._ts,r,n),p!==this._time||!this._ts&&!m){b=0,g&&(l+=this._zTime=-F);break}}f=g}else{f=this._last;for(var E=s<0?s:p;f;){if(g=f._prev,(f._act||E<=f._end)&&f._ts&&b!==f){if(f.parent!==this)return this.render(s,r,n);if(f.render(f._ts>0?(E-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(E-f._start)*f._ts,r,n),p!==this._time||!this._ts&&!m){b=0,g&&(l+=this._zTime=E?-F:F);break}}f=g}}if(b&&!r&&(this.pause(),b.render(p>=a?0:-F)._zTime=p>=a?1:-1,this._ts))return this._start=P,oi(this),this.render(s,r,n);this._onUpdate&&!r&&lt(this,"onUpdate",!0),(l===o&&o>=this.totalDuration()||!l&&a)&&(P===this._start||Math.abs(v)!==Math.abs(this._ts))&&(this._lock||((s||!h)&&(l===o&&this._ts>0||!l&&this._ts<0)&&At(this,1),!r&&!(s<0&&!a)&&(l||a||!o)&&(lt(this,l===o&&s>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(l<o&&this.timeScale()>0)&&this._prom())))}return this},e.add=function(s,r){var n=this;if(wt(r)||(r=ot(this,r,s)),!(s instanceof me)){if(it(s))return s.forEach(function(a){return n.add(a,r)}),this;if(H(s))return this.addLabel(s,r);if(X(s))s=j.delayedCall(0,s);else return this}return this!==s?xt(this,s,r):this},e.getChildren=function(s,r,n,a){s===void 0&&(s=!0),r===void 0&&(r=!0),n===void 0&&(n=!0),a===void 0&&(a=-_t);for(var o=[],h=this._first;h;)h._start>=a&&(h instanceof j?r&&o.push(h):(n&&o.push(h),s&&o.push.apply(o,h.getChildren(!0,r,n)))),h=h._next;return o},e.getById=function(s){for(var r=this.getChildren(1,1,1),n=r.length;n--;)if(r[n].vars.id===s)return r[n]},e.remove=function(s){return H(s)?this.removeLabel(s):X(s)?this.killTweensOf(s):(ke(this,s),s===this._recent&&(this._recent=this._last),Xt(this))},e.totalTime=function(s,r){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=A(rt.time-(this._ts>0?s/this._ts:(this.totalDuration()-s)/-this._ts))),u.prototype.totalTime.call(this,s,r),this._forcing=0,this):this._tTime},e.addLabel=function(s,r){return this.labels[s]=ot(this,r),this},e.removeLabel=function(s){return delete this.labels[s],this},e.addPause=function(s,r,n){var a=j.delayedCall(0,r||Jt,n);return a.data="isPause",this._hasPause=1,xt(this,a,ot(this,s))},e.removePause=function(s){var r=this._first;for(s=ot(this,s);r;)r._start===s&&r.data==="isPause"&&At(r),r=r._next},e.killTweensOf=function(s,r,n){for(var a=this.getTweensOf(s,n),o=a.length;o--;)Lt!==a[o]&&a[o].kill(s,r);return this},e.getTweensOf=function(s,r){for(var n=[],a=ht(s),o=this._first,h=wt(r),l;o;)o instanceof j?Sr(o._targets,a)&&(h?(!Lt||o._initted&&o._ts)&&o.globalTime(0)<=r&&o.globalTime(o.totalDuration())>r:!r||o.isActive())&&n.push(o):(l=o.getTweensOf(a,r)).length&&n.push.apply(n,l),o=o._next;return n},e.tweenTo=function(s,r){r=r||{};var n=this,a=ot(n,s),o=r,h=o.startAt,l=o.onStart,d=o.onStartParams,p=o.immediateRender,f,g=j.to(n,at({ease:r.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:r.duration||Math.abs((a-(h&&"time"in h?h.time:n._time))/n.timeScale())||F,onStart:function(){if(n.pause(),!f){var _=r.duration||Math.abs((a-(h&&"time"in h?h.time:n._time))/n.timeScale());g._dur!==_&&ee(g,_,0,1).render(g._time,!0,!0),f=1}l&&l.apply(g,d||[])}},r));return p?g.render(0):g},e.tweenFromTo=function(s,r,n){return this.tweenTo(r,at({startAt:{time:ot(this,s)}},n))},e.recent=function(){return this._recent},e.nextLabel=function(s){return s===void 0&&(s=this._time),Ls(this,ot(this,s))},e.previousLabel=function(s){return s===void 0&&(s=this._time),Ls(this,ot(this,s),1)},e.currentLabel=function(s){return arguments.length?this.seek(s,!0):this.previousLabel(this._time+F)},e.shiftChildren=function(s,r,n){n===void 0&&(n=0);for(var a=this._first,o=this.labels,h;a;)a._start>=n&&(a._start+=s,a._end+=s),a=a._next;if(r)for(h in o)o[h]>=n&&(o[h]+=s);return Xt(this)},e.invalidate=function(){var s=this._first;for(this._lock=0;s;)s.invalidate(),s=s._next;return u.prototype.invalidate.call(this)},e.clear=function(s){s===void 0&&(s=!0);for(var r=this._first,n;r;)n=r._next,this.remove(r),r=n;return this._dp&&(this._time=this._tTime=this._pTime=0),s&&(this.labels={}),Xt(this)},e.totalDuration=function(s){var r=0,n=this,a=n._last,o=_t,h,l,d;if(arguments.length)return n.timeScale((n._repeat<0?n.duration():n.totalDuration())/(n.reversed()?-s:s));if(n._dirty){for(d=n.parent;a;)h=a._prev,a._dirty&&a.totalDuration(),l=a._start,l>o&&n._sort&&a._ts&&!n._lock?(n._lock=1,xt(n,a,l-a._delay,1)._lock=0):o=l,l<0&&a._ts&&(r-=l,(!d&&!n._dp||d&&d.smoothChildTiming)&&(n._start+=l/n._ts,n._time-=l,n._tTime-=l),n.shiftChildren(-l,!1,-Infinity),o=0),a._end>r&&a._ts&&(r=a._end),a=h;ee(n,n===N&&n._time>r?n._time:r,1,1),n._dirty=0}return n._tDur},t.updateRoot=function(s){if(N._ts&&(ps(N,De(s,N)),cs=rt.frame),rt.frame>=fs){fs+=Q.autoSleep||120;var r=N._first;if((!r||!r._ts)&&Q.autoSleep&&rt._listeners.length<2){for(;r&&!r._ts;)r=r._next;r||rt.sleep()}}},t}(me);at(Y.prototype,{_lock:0,_hasPause:0,_forcing:0});var Kr=function(t,e,i,s,r,n,a){var o=new Z(this._pt,t,e,0,1,yi,null,r),h=0,l=0,d,p,f,g,c,_,m,b;for(o.b=i,o.e=s,i+="",s+="",(m=~s.indexOf("random("))&&(s=pe(s)),n&&(b=[i,s],n(b,t,e),i=b[0],s=b[1]),p=i.match(Ze)||[];d=Ze.exec(s);)g=d[0],c=s.substring(h,d.index),f?f=(f+1)%5:c.substr(-5)==="rgba("&&(f=1),g!==p[l++]&&(_=parseFloat(p[l-1])||0,o._pt={_next:o._pt,p:c||l===1?c:",",s:_,c:g.charAt(1)==="="?parseFloat(g.substr(2))*(g.charAt(0)==="-"?-1:1):parseFloat(g)-_,m:f&&f<4?Math.round:0},h=Ze.lastIndex);return o.c=h<s.length?s.substring(h,s.length):"",o.fp=a,(Ke.test(s)||m)&&(o.e=0),this._pt=o,o},_i=function(t,e,i,s,r,n,a,o,h){X(s)&&(s=s(r||0,t,n));var l=t[e],d=i!=="get"?i:X(l)?h?t[e.indexOf("set")||!X(t["get"+e.substr(3)])?e:"get"+e.substr(3)](h):t[e]():l,p=X(l)?h?sn:Bs:xi,f;if(H(s)&&(~s.indexOf("random(")&&(s=pe(s)),s.charAt(1)==="="&&(f=parseFloat(d)+parseFloat(s.substr(2))*(s.charAt(0)==="-"?-1:1)+(et(d)||0),(f||f===0)&&(s=f))),d!==s)return!isNaN(d*s)&&s!==""?(f=new Z(this._pt,t,e,+d||0,s-(d||0),typeof l=="boolean"?nn:Us,0,p),h&&(f.fp=h),a&&f.modifier(a,this,t),this._pt=f):(!l&&!(e in t)&&Ee(e,s),Kr.call(this,t,e,d,s,p,o||Q.stringFilter,h))},Jr=function(t,e,i,s,r){if(X(t)&&(t=xe(t,r,e,i,s)),!Pt(t)||t.style&&t.nodeType||it(t)||os(t))return H(t)?xe(t,r,e,i,s):t;var n={},a;for(a in t)n[a]=xe(t[a],r,e,i,s);return n},mi=function(t,e,i,s,r,n){var a,o,h,l;if($[t]&&(a=new $[t]).init(r,a.rawVars?e[t]:Jr(e[t],s,r,n,i),i,s,n)!==!1&&(i._pt=o=new Z(i._pt,r,t,0,1,a.render,a,0,a.priority),i!==ie))for(h=i._ptLookup[i._targets.indexOf(r)],l=a._props.length;l--;)h[a._props[l]]=o;return a},Lt,$r=function u(t,e){var i=t.vars,s=i.ease,r=i.startAt,n=i.immediateRender,a=i.lazy,o=i.onUpdate,h=i.onUpdateParams,l=i.callbackScope,d=i.runBackwards,p=i.yoyoEase,f=i.keyframes,g=i.autoRevert,c=t._dur,_=t._startAt,m=t._targets,b=t.parent,v=b&&b.data==="nested"?b.parent._targets:m,P=t._overwrite==="auto"&&!Ge,x=t.timeline,y,T,S,w,E,C,z,I,O,B,M,q,pt;if(x&&(!f||!s)&&(s="none"),t._ease=re(s,Kt.ease),t._yEase=p?Fs(re(p===!0?s:p,Kt.ease)):0,p&&t._yoyo&&!t._repeat&&(p=t._yEase,t._yEase=t._ease,t._ease=p),t._from=!x&&!!i.runBackwards,!x){if(I=m[0]?Mt(m[0]).harness:0,q=I&&i[I.prop],y=ai(i,ti),_&&_.render(-1,!0).kill(),r)if(At(t._startAt=j.set(m,at({data:"isStart",overwrite:!1,parent:b,immediateRender:!0,lazy:J(a),startAt:null,delay:0,onUpdate:o,onUpdateParams:h,callbackScope:l,stagger:0},r))),e<0&&!n&&!g&&t._startAt.render(-1,!0),n){if(e>0&&!g&&(t._startAt=0),c&&e<=0){e&&(t._zTime=e);return}}else g===!1&&(t._startAt=0);else if(d&&c){if(_)!g&&(t._startAt=0);else if(e&&(n=!1),S=at({overwrite:!1,data:"isFromStart",lazy:n&&J(a),immediateRender:n,stagger:0,parent:b},y),q&&(S[I.prop]=q),At(t._startAt=j.set(m,S)),e<0&&t._startAt.render(-1,!0),!n)u(t._startAt,F);else if(!e)return}for(t._pt=0,a=c&&J(a)||a&&!c,T=0;T<m.length;T++){if(E=m[T],z=E._gsap||ri(m)[T]._gsap,t._ptLookup[T]=B={},ei[z.id]&&Et.length&&Ce(),M=v===m?T:v.indexOf(E),I&&(O=new I).init(E,q||y,t,M,v)!==!1&&(t._pt=w=new Z(t._pt,E,O.name,0,1,O.render,O,0,O.priority),O._props.forEach(function(gt){B[gt]=w}),O.priority&&(C=1)),!I||q)for(S in y)$[S]&&(O=mi(S,y,t,M,E,v))?O.priority&&(C=1):B[S]=w=_i.call(t,E,S,"get",y[S],M,v,0,i.stringFilter);t._op&&t._op[T]&&t.kill(E,t._op[T]),P&&t._pt&&(Lt=t,N.killTweensOf(E,B,t.globalTime(0)),pt=!t.parent,Lt=0),t._pt&&a&&(ei[z.id]=1)}C&&bi(t),t._onInit&&t._onInit(t)}t._onUpdate=o,t._initted=(!t._op||t._pt)&&!pt},tn=function(t,e){var i=t[0]?Mt(t[0]).harness:0,s=i&&i.aliases,r,n,a,o;if(!s)return e;r=$t({},e);for(n in s)if(n in r)for(o=s[n].split(","),a=o.length;a--;)r[o[a]]=r[n];return r},xe=function(t,e,i,s,r){return X(t)?t.call(e,i,s,r):H(t)&&~t.indexOf("random(")?pe(t):t},Is=si+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase",en=(Is+",id,stagger,delay,duration,paused,scrollTrigger").split(","),j=function(u){ss(t,u);function t(i,s,r,n){var a;typeof s=="number"&&(r.duration=s,s=r,r=null),a=u.call(this,n?s:Le(s))||this;var o=a.vars,h=o.duration,l=o.delay,d=o.immediateRender,p=o.stagger,f=o.overwrite,g=o.keyframes,c=o.defaults,_=o.scrollTrigger,m=o.yoyoEase,b=s.parent||N,v=(it(i)||os(i)?wt(i[0]):"length"in s)?[i]:ht(i),P,x,y,T,S,w,E,C;if(a._targets=v.length?ri(v):Me("GSAP target "+i+" not found. https://greensock.com",!Q.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=f,g||p||as(h)||as(l)){if(s=a.vars,P=a.timeline=new Y({data:"nested",defaults:c||{}}),P.kill(),P.parent=P._dp=bt(a),P._start=0,g)at(P.vars.defaults,{ease:"none"}),p?v.forEach(function(z,I){return g.forEach(function(O,B){return P.to(z,O,B?">":I*p)})}):g.forEach(function(z){return P.to(v,z,">")});else{if(T=v.length,E=p?Rs(p):Jt,Pt(p))for(S in p)~Is.indexOf(S)&&(C||(C={}),C[S]=p[S]);for(x=0;x<T;x++){y={};for(S in s)en.indexOf(S)<0&&(y[S]=s[S]);y.stagger=0,m&&(y.yoyoEase=m),C&&$t(y,C),w=v[x],y.duration=+xe(h,bt(a),x,w,v),y.delay=(+xe(l,bt(a),x,w,v)||0)-a._delay,!p&&T===1&&y.delay&&(a._delay=l=y.delay,a._start+=l,y.delay=0),P.to(w,y,E(x,w,v))}P.duration()?h=l=0:a.timeline=0}h||a.duration(h=P.duration())}else a.timeline=0;return f===!0&&!Ge&&(Lt=bt(a),N.killTweensOf(v),Lt=0),xt(b,bt(a),r),s.reversed&&a.reverse(),s.paused&&a.paused(!0),(d||!h&&!g&&a._start===A(b._time)&&J(d)&&Cr(bt(a))&&b.data!=="nested")&&(a._tTime=-F,a.render(Math.max(0,-l))),_&&bs(bt(a),_),a}var e=t.prototype;return e.render=function(s,r,n){var a=this._time,o=this._tDur,h=this._dur,l=s>o-F&&s>=0?o:s<F?0:s,d,p,f,g,c,_,m,b,v;if(!h)kr(this,s,r,n);else if(l!==this._tTime||!s||n||!this._initted&&this._tTime||this._startAt&&this._zTime<0!=s<0){if(d=l,b=this.timeline,this._repeat){if(g=h+this._rDelay,this._repeat<-1&&s<0)return this.totalTime(g*100+s,r,n);if(d=A(l%g),l===o?(f=this._repeat,d=h):(f=~~(l/g),f&&f===l/g&&(d=h,f--),d>h&&(d=h)),_=this._yoyo&&f&1,_&&(v=this._yEase,d=h-d),c=te(this._tTime,g),d===a&&!n&&this._initted)return this;f!==c&&(b&&this._yEase&&zs(b,_),this.vars.repeatRefresh&&!_&&!this._lock&&(this._lock=n=1,this.render(A(g*f),!0).invalidate()._lock=0))}if(!this._initted){if(ws(this,s<0?s:d,n,r))return this._tTime=0,this;if(h!==this._dur)return this.render(s,r,n)}if(this._tTime=l,this._time=d,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=m=(v||this._ease)(d/h),this._from&&(this.ratio=m=1-m),d&&!a&&!r&&(lt(this,"onStart"),this._tTime!==l))return this;for(p=this._pt;p;)p.r(m,p.d),p=p._next;b&&b.render(s<0?s:!d&&_?-F:b._dur*m,r,n)||this._startAt&&(this._zTime=s),this._onUpdate&&!r&&(s<0&&this._startAt&&this._startAt.render(s,!0,n),lt(this,"onUpdate")),this._repeat&&f!==c&&this.vars.onRepeat&&!r&&this.parent&&lt(this,"onRepeat"),(l===this._tDur||!l)&&this._tTime===l&&(s<0&&this._startAt&&!this._onUpdate&&this._startAt.render(s,!0,!0),(s||!h)&&(l===this._tDur&&this._ts>0||!l&&this._ts<0)&&At(this,1),!r&&!(s<0&&!a)&&(l||a)&&(lt(this,l===o?"onComplete":"onReverseComplete",!0),this._prom&&!(l<o&&this.timeScale()>0)&&this._prom()))}return this},e.targets=function(){return this._targets},e.invalidate=function(){return this._pt=this._op=this._startAt=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(),u.prototype.invalidate.call(this)},e.kill=function(s,r){if(r===void 0&&(r="all"),!s&&(!r||r==="all"))return this._lazy=this._pt=0,this.parent?ge(this):this;if(this.timeline){var n=this.timeline.totalDuration();return this.timeline.killTweensOf(s,r,Lt&&Lt.vars.overwrite!==!0)._first||ge(this),this.parent&&n!==this.timeline.totalDuration()&&ee(this,this._dur*this.timeline._tDur/n,0,1),this}var a=this._targets,o=s?ht(s):a,h=this._ptLookup,l=this._pt,d,p,f,g,c,_,m;if((!r||r==="all")&&Er(a,o))return r==="all"&&(this._pt=0),ge(this);for(d=this._op=this._op||[],r!=="all"&&(H(r)&&(c={},tt(r,function(b){return c[b]=1}),r=c),r=tn(a,r)),m=a.length;m--;)if(~o.indexOf(a[m])){p=h[m],r==="all"?(d[m]=r,g=p,f={}):(f=d[m]=d[m]||{},g=r);for(c in g)_=p&&p[c],_&&((!("kill"in _.d)||_.d.kill(c)===!0)&&ke(this,_,"_pt"),delete p[c]),f!=="all"&&(f[c]=1)}return this._initted&&!this._pt&&l&&ge(this),this},t.to=function(s,r){return new t(s,r,arguments[2])},t.from=function(s,r){return ce(1,arguments)},t.delayedCall=function(s,r,n,a){return new t(r,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:s,onComplete:r,onReverseComplete:r,onCompleteParams:n,onReverseCompleteParams:n,callbackScope:a})},t.fromTo=function(s,r,n){return ce(2,arguments)},t.set=function(s,r){return r.duration=0,r.repeatDelay||(r.repeat=0),new t(s,r)},t.killTweensOf=function(s,r,n){return N.killTweensOf(s,r,n)},t}(me);at(j.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});tt("staggerTo,staggerFrom,staggerFromTo",function(u){j[u]=function(){var t=new Y,e=li.call(arguments,0);return e.splice(u==="staggerFromTo"?5:4,0,0),t[u].apply(t,e)}});var xi=function(t,e,i){return t[e]=i},Bs=function(t,e,i){return t[e](i)},sn=function(t,e,i,s){return t[e](s.fp,i)},rn=function(t,e,i){return t.setAttribute(e,i)},Fe=function(t,e){return X(t[e])?Bs:Se(t[e])&&t.setAttribute?rn:xi},Us=function(t,e){return e.set(e.t,e.p,Math.round((e.s+e.c*t)*1e6)/1e6,e)},nn=function(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},yi=function(t,e){var i=e._pt,s="";if(!t&&e.b)s=e.b;else if(t===1&&e.e)s=e.e;else{for(;i;)s=i.p+(i.m?i.m(i.s+i.c*t):Math.round((i.s+i.c*t)*1e4)/1e4)+s,i=i._next;s+=e.c}e.set(e.t,e.p,s,e)},vi=function(t,e){for(var i=e._pt;i;)i.r(t,i.d),i=i._next},an=function(t,e,i,s){for(var r=this._pt,n;r;)n=r._next,r.p===s&&r.modifier(t,e,i),r=n},on=function(t){for(var e=this._pt,i,s;e;)s=e._next,e.p===t&&!e.op||e.op===t?ke(this,e,"_pt"):e.dep||(i=1),e=s;return!i},hn=function(t,e,i,s){s.mSet(t,e,s.m.call(s.tween,i,s.mt),s)},bi=function(t){for(var e=t._pt,i,s,r,n;e;){for(i=e._next,s=r;s&&s.pr>e.pr;)s=s._next;(e._prev=s?s._prev:n)?e._prev._next=e:r=e,(e._next=s)?s._prev=e:n=e,e=i}t._pt=r},Z=function(){function u(e,i,s,r,n,a,o,h,l){this.t=i,this.s=r,this.c=n,this.p=s,this.r=a||Us,this.d=o||this,this.set=h||xi,this.pr=l||0,this._next=e,e&&(e._prev=this)}var t=u.prototype;return t.modifier=function(i,s,r){this.mSet=this.mSet||this.set,this.set=hn,this.m=i,this.mt=r,this.tween=s},u}();tt(si+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(u){return ti[u]=1});st.TweenMax=st.TweenLite=j;st.TimelineLite=st.TimelineMax=Y;N=new Y({sortChildren:!1,defaults:Kt,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});Q.stringFilter=ci;var ze={registerPlugin:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];e.forEach(function(s){return Xr(s)})},timeline:function(t){return new Y(t)},getTweensOf:function(t,e){return N.getTweensOf(t,e)},getProperty:function(t,e,i,s){H(t)&&(t=ht(t)[0]);var r=Mt(t||{}).get,n=i?_s:gs;return i==="native"&&(i=""),t&&(e?n(($[e]&&$[e].get||r)(t,e,i,s)):function(a,o,h){return n(($[a]&&$[a].get||r)(t,a,o,h))})},quickSetter:function(t,e,i){if(t=ht(t),t.length>1){var s=t.map(function(l){return ut.quickSetter(l,e,i)}),r=s.length;return function(l){for(var d=r;d--;)s[d](l)}}t=t[0]||{};var n=$[e],a=Mt(t),o=a.harness&&(a.harness.aliases||{})[e]||e,h=n?function(l){var d=new n;ie._pt=0,d.init(t,i?l+i:l,ie,0,[t]),d.render(1,d),ie._pt&&vi(1,ie)}:a.set(t,o);return n?h:function(l){return h(t,o,i?l+i:l,a,1)}},isTweening:function(t){return N.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=re(t.ease,Kt.ease)),ms(Kt,t||{})},config:function(t){return ms(Q,t||{})},registerEffect:function(t){var e=t.name,i=t.effect,s=t.plugins,r=t.defaults,n=t.extendTimeline;(s||"").split(",").forEach(function(a){return a&&!$[a]&&!st[a]&&Me(e+" effect requires "+a+" plugin.")}),ii[e]=function(a,o,h){return i(ht(a),at(o||{},r),h)},n&&(Y.prototype[e]=function(a,o,h){return this.add(ii[e](a,Pt(o)?o:(h=o)&&{},this),h)})},registerEase:function(t,e){L[t]=re(e)},parseEase:function(t,e){return arguments.length?re(t,e):L},getById:function(t){return N.getById(t)},exportRoot:function(t,e){t===void 0&&(t={});var i=new Y(t),s,r;for(i.smoothChildTiming=J(t.smoothChildTiming),N.remove(i),i._dp=0,i._time=i._tTime=N._time,s=N._first;s;)r=s._next,(e||!(!s._dur&&s instanceof j&&s.vars.onComplete===s._targets[0]))&&xt(i,s,s._start-s._delay),s=r;return xt(N,i,0),i},utils:{wrap:Nr,wrapYoyo:Wr,distribute:Rs,random:Ms,snap:Es,normalize:Ur,getUnit:et,clamp:Fr,splitColor:ks,toArray:ht,selector:Vr,mapRange:Cs,pipe:Ir,unitize:Br,interpolate:jr,shuffle:Ss},install:us,effects:ii,ticker:rt,updateRoot:Y.updateRoot,plugins:$,globalTimeline:N,core:{PropTween:Z,globals:ds,Tween:j,Timeline:Y,Animation:me,getCache:Mt,_removeLinkedListItem:ke,suppressOverwrites:function(t){return Ge=t}}};tt("to,from,fromTo,delayedCall,set,killTweensOf",function(u){return ze[u]=j[u]});rt.add(Y.updateRoot);ie=ze.to({},{duration:0});var ln=function(t,e){for(var i=t._pt;i&&i.p!==e&&i.op!==e&&i.fp!==e;)i=i._next;return i},un=function(t,e){var i=t._targets,s,r,n;for(s in e)for(r=i.length;r--;)n=t._ptLookup[r][s],n&&(n=n.d)&&(n._pt&&(n=ln(n,s)),n&&n.modifier&&n.modifier(e[s],t,i[r],s))},wi=function(t,e){return{name:t,rawVars:1,init:function(s,r,n){n._onInit=function(a){var o,h;if(H(r)&&(o={},tt(r,function(l){return o[l]=1}),r=o),e){o={};for(h in r)o[h]=e(r[h]);r=o}un(a,r)}}}},ut=ze.registerPlugin({name:"attr",init:function(t,e,i,s,r){var n,a;for(n in e)a=this.add(t,"setAttribute",(t.getAttribute(n)||0)+"",e[n],s,r,0,0,n),a&&(a.op=n),this._props.push(n)}},{name:"endArray",init:function(t,e){for(var i=e.length;i--;)this.add(t,i,t[i]||0,e[i])}},wi("roundProps",ui),wi("modifiers"),wi("snap",Es))||ze;j.version=Y.version=ut.version="3.7.1";ls=1;ns()&&se();var dn=L.Power0,cn=L.Power1,fn=L.Power2,pn=L.Power3,gn=L.Power4,_n=L.Linear,mn=L.Quad,xn=L.Cubic,yn=L.Quart,vn=L.Quint,bn=L.Strong,wn=L.Elastic,Pn=L.Back,Tn=L.SteppedEase,Sn=L.Bounce,Rn=L.Sine,En=L.Expo,Mn=L.Circ;var Ns,kt,ne,Pi,Gt,An,Ws,Cn=function(){return typeof window!="undefined"},Dt={},Yt=180/Math.PI,ae=Math.PI/180,oe=Math.atan2,js=1e8,Xs=/([A-Z])/g,Ln=/(?:left|right|width|margin|padding|x)/i,kn=/[\s,\(]\S/,Ot={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},Hs=function(t,e){return e.set(e.t,e.p,Math.round((e.s+e.c*t)*1e4)/1e4+e.u,e)},Dn=function(t,e){return e.set(e.t,e.p,t===1?e.e:Math.round((e.s+e.c*t)*1e4)/1e4+e.u,e)},On=function(t,e){return e.set(e.t,e.p,t?Math.round((e.s+e.c*t)*1e4)/1e4+e.u:e.b,e)},Fn=function(t,e){var i=e.s+e.c*t;e.set(e.t,e.p,~~(i+(i<0?-.5:.5))+e.u,e)},Gs=function(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},Ys=function(t,e){return e.set(e.t,e.p,t!==1?e.b:e.e,e)},zn=function(t,e,i){return t.style[e]=i},Vn=function(t,e,i){return t.style.setProperty(e,i)},In=function(t,e,i){return t._gsap[e]=i},Bn=function(t,e,i){return t._gsap.scaleX=t._gsap.scaleY=i},Un=function(t,e,i,s,r){var n=t._gsap;n.scaleX=n.scaleY=i,n.renderTransform(r,n)},Nn=function(t,e,i,s,r){var n=t._gsap;n[e]=i,n.renderTransform(r,n)},G="transform",Ft=G+"Origin",qs,Ti=function(t,e){var i=kt.createElementNS?kt.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):kt.createElement(t);return i.style?i:kt.createElement(t)},St=function u(t,e,i){var s=getComputedStyle(t);return s[e]||s.getPropertyValue(e.replace(Xs,"-$1").toLowerCase())||s.getPropertyValue(e)||!i&&u(t,he(e)||e,1)||""},Qs="O,Moz,ms,Ms,Webkit".split(","),he=function(t,e,i){var s=e||Gt,r=s.style,n=5;if(t in r&&!i)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);n--&&!(Qs[n]+t in r););return n<0?null:(n===3?"ms":n>=0?Qs[n]:"")+t},Si=function(){Cn()&&window.document&&(Ns=window,kt=Ns.document,ne=kt.documentElement,Gt=Ti("div")||{style:{}},An=Ti("div"),G=he(G),Ft=G+"Origin",Gt.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",qs=!!he("perspective"),Pi=1)},Ri=function u(t){var e=Ti("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,s=this.nextSibling,r=this.style.cssText,n;if(ne.appendChild(e),e.appendChild(this),this.style.display="block",t)try{n=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=u}catch(a){}else this._gsapBBox&&(n=this._gsapBBox());return i&&(s?i.insertBefore(this,s):i.appendChild(this)),ne.removeChild(e),this.style.cssText=r,n},Zs=function(t,e){for(var i=e.length;i--;)if(t.hasAttribute(e[i]))return t.getAttribute(e[i])},Ks=function(t){var e;try{e=t.getBBox()}catch(i){e=Ri.call(t,!0)}return e&&(e.width||e.height)||t.getBBox===Ri||(e=Ri.call(t,!0)),e&&!e.width&&!e.x&&!e.y?{x:+Zs(t,["x","cx","x1"])||0,y:+Zs(t,["y","cy","y1"])||0,width:0,height:0}:e},Js=function(t){return!!(t.getCTM&&(!t.parentNode||t.ownerSVGElement)&&Ks(t))},ye=function(t,e){if(e){var i=t.style;e in Dt&&e!==Ft&&(e=G),i.removeProperty?((e.substr(0,2)==="ms"||e.substr(0,6)==="webkit")&&(e="-"+e),i.removeProperty(e.replace(Xs,"-$1").toLowerCase())):i.removeAttribute(e)}},zt=function(t,e,i,s,r,n){var a=new Z(t._pt,e,i,0,1,n?Ys:Gs);return t._pt=a,a.b=s,a.e=r,t._props.push(i),a},$s={deg:1,rad:1,turn:1},Vt=function u(t,e,i,s){var r=parseFloat(i)||0,n=(i+"").trim().substr((r+"").length)||"px",a=Gt.style,o=Ln.test(e),h=t.tagName.toLowerCase()==="svg",l=(h?"client":"offset")+(o?"Width":"Height"),d=100,p=s==="px",f=s==="%",g,c,_,m;return s===n||!r||$s[s]||$s[n]?r:(n!=="px"&&!p&&(r=u(t,e,i,"px")),m=t.getCTM&&Js(t),(f||n==="%")&&(Dt[e]||~e.indexOf("adius"))?(g=m?t.getBBox()[o?"width":"height"]:t[l],A(f?r/g*d:r/100*g)):(a[o?"width":"height"]=d+(p?n:s),c=~e.indexOf("adius")||s==="em"&&t.appendChild&&!h?t:t.parentNode,m&&(c=(t.ownerSVGElement||{}).parentNode),(!c||c===kt||!c.appendChild)&&(c=kt.body),_=c._gsap,_&&f&&_.width&&o&&_.time===rt.time?A(r/_.width*d):((f||n==="%")&&(a.position=St(t,"position")),c===t&&(a.position="static"),c.appendChild(Gt),g=Gt[l],c.removeChild(Gt),a.position="absolute",o&&f&&(_=Mt(c),_.time=rt.time,_.width=c[l]),A(p?g*r/d:g&&r?d/g*r:0))))},le=function(t,e,i,s){var r;return Pi||Si(),e in Ot&&e!=="transform"&&(e=Ot[e],~e.indexOf(",")&&(e=e.split(",")[0])),Dt[e]&&e!=="transform"?(r=be(t,s),r=e!=="transformOrigin"?r[e]:r.svg?r.origin:Ie(St(t,Ft))+" "+r.zOrigin+"px"):(r=t.style[e],(!r||r==="auto"||s||~(r+"").indexOf("calc("))&&(r=Ve[e]&&Ve[e](t,e,i)||St(t,e)||ni(t,e)||(e==="opacity"?1:0))),i&&!~(r+"").trim().indexOf(" ")?Vt(t,e,r,i)+i:r},Wn=function(t,e,i,s){if(!i||i==="none"){var r=he(e,t,1),n=r&&St(t,r,1);n&&n!==i?(e=r,i=n):e==="borderColor"&&(i=St(t,"borderTopColor"))}var a=new Z(this._pt,t.style,e,0,1,yi),o=0,h=0,l,d,p,f,g,c,_,m,b,v,P,x,y;if(a.b=i,a.e=s,i+="",s+="",s==="auto"&&(t.style[e]=s,s=St(t,e)||s,t.style[e]=i),l=[i,s],ci(l),i=l[0],s=l[1],p=i.match(jt)||[],y=s.match(jt)||[],y.length){for(;d=jt.exec(s);)_=d[0],b=s.substring(o,d.index),g?g=(g+1)%5:(b.substr(-5)==="rgba("||b.substr(-5)==="hsla(")&&(g=1),_!==(c=p[h++]||"")&&(f=parseFloat(c)||0,P=c.substr((f+"").length),x=_.charAt(1)==="="?+(_.charAt(0)+"1"):0,x&&(_=_.substr(2)),m=parseFloat(_),v=_.substr((m+"").length),o=jt.lastIndex-v.length,v||(v=v||Q.units[e]||P,o===s.length&&(s+=v,a.e+=v)),P!==v&&(f=Vt(t,e,c,v)||0),a._pt={_next:a._pt,p:b||h===1?b:",",s:f,c:x?x*m:m-f,m:g&&g<4||e==="zIndex"?Math.round:0});a.c=o<s.length?s.substring(o,s.length):""}else a.r=e==="display"&&s==="none"?Ys:Gs;return Ke.test(s)&&(a.e=0),this._pt=a,a},tr={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},jn=function(t){var e=t.split(" "),i=e[0],s=e[1]||"50%";return(i==="top"||i==="bottom"||s==="left"||s==="right")&&(t=i,i=s,s=t),e[0]=tr[i]||i,e[1]=tr[s]||s,e.join(" ")},Xn=function(t,e){if(e.tween&&e.tween._time===e.tween._dur){var i=e.t,s=i.style,r=e.u,n=i._gsap,a,o,h;if(r==="all"||r===!0)s.cssText="",o=1;else for(r=r.split(","),h=r.length;--h>-1;)a=r[h],Dt[a]&&(o=1,a=a==="transformOrigin"?Ft:G),ye(i,a);o&&(ye(i,G),n&&(n.svg&&i.removeAttribute("transform"),be(i,1),n.uncache=1))}},Ve={clearProps:function(t,e,i,s,r){if(r.data!=="isFromStart"){var n=t._pt=new Z(t._pt,e,i,0,0,Xn);return n.u=s,n.pr=-10,n.tween=r,t._props.push(i),1}}},ve=[1,0,0,1,0,0],er={},ir=function(t){return t==="matrix(1, 0, 0, 1, 0, 0)"||t==="none"||!t},sr=function(t){var e=St(t,G);return ir(e)?ve:e.substr(7).match(Qe).map(A)},Ei=function(t,e){var i=t._gsap||Mt(t),s=t.style,r=sr(t),n,a,o,h;return i.svg&&t.getAttribute("transform")?(o=t.transform.baseVal.consolidate().matrix,r=[o.a,o.b,o.c,o.d,o.e,o.f],r.join(",")==="1,0,0,1,0,0"?ve:r):(r===ve&&!t.offsetParent&&t!==ne&&!i.svg&&(o=s.display,s.display="block",n=t.parentNode,(!n||!t.offsetParent)&&(h=1,a=t.nextSibling,ne.appendChild(t)),r=sr(t),o?s.display=o:ye(t,"display"),h&&(a?n.insertBefore(t,a):n?n.appendChild(t):ne.removeChild(t))),e&&r.length>6?[r[0],r[1],r[4],r[5],r[12],r[13]]:r)},Mi=function(t,e,i,s,r,n){var a=t._gsap,o=r||Ei(t,!0),h=a.xOrigin||0,l=a.yOrigin||0,d=a.xOffset||0,p=a.yOffset||0,f=o[0],g=o[1],c=o[2],_=o[3],m=o[4],b=o[5],v=e.split(" "),P=parseFloat(v[0])||0,x=parseFloat(v[1])||0,y,T,S,w;i?o!==ve&&(T=f*_-g*c)&&(S=P*(_/T)+x*(-c/T)+(c*b-_*m)/T,w=P*(-g/T)+x*(f/T)-(f*b-g*m)/T,P=S,x=w):(y=Ks(t),P=y.x+(~v[0].indexOf("%")?P/100*y.width:P),x=y.y+(~(v[1]||v[0]).indexOf("%")?x/100*y.height:x)),s||s!==!1&&a.smooth?(m=P-h,b=x-l,a.xOffset=d+(m*f+b*c)-m,a.yOffset=p+(m*g+b*_)-b):a.xOffset=a.yOffset=0,a.xOrigin=P,a.yOrigin=x,a.smooth=!!s,a.origin=e,a.originIsAbsolute=!!i,t.style[Ft]="0px 0px",n&&(zt(n,a,"xOrigin",h,P),zt(n,a,"yOrigin",l,x),zt(n,a,"xOffset",d,a.xOffset),zt(n,a,"yOffset",p,a.yOffset)),t.setAttribute("data-svg-origin",P+" "+x)},be=function(t,e){var i=t._gsap||new gi(t);if("x"in i&&!e&&!i.uncache)return i;var s=t.style,r=i.scaleX<0,n="px",a="deg",o=St(t,Ft)||"0",h,l,d,p,f,g,c,_,m,b,v,P,x,y,T,S,w,E,C,z,I,O,B,M,q,pt,gt,Rt,Nt,es,vt,Wt;return h=l=d=g=c=_=m=b=v=0,p=f=1,i.svg=!!(t.getCTM&&Js(t)),y=Ei(t,i.svg),i.svg&&(M=(!i.uncache||o==="0px 0px")&&!e&&t.getAttribute("data-svg-origin"),Mi(t,M||o,!!M||i.originIsAbsolute,i.smooth!==!1,y)),P=i.xOrigin||0,x=i.yOrigin||0,y!==ve&&(E=y[0],C=y[1],z=y[2],I=y[3],h=O=y[4],l=B=y[5],y.length===6?(p=Math.sqrt(E*E+C*C),f=Math.sqrt(I*I+z*z),g=E||C?oe(C,E)*Yt:0,m=z||I?oe(z,I)*Yt+g:0,m&&(f*=Math.abs(Math.cos(m*ae))),i.svg&&(h-=P-(P*E+x*z),l-=x-(P*C+x*I))):(Wt=y[6],es=y[7],gt=y[8],Rt=y[9],Nt=y[10],vt=y[11],h=y[12],l=y[13],d=y[14],T=oe(Wt,Nt),c=T*Yt,T&&(S=Math.cos(-T),w=Math.sin(-T),M=O*S+gt*w,q=B*S+Rt*w,pt=Wt*S+Nt*w,gt=O*-w+gt*S,Rt=B*-w+Rt*S,Nt=Wt*-w+Nt*S,vt=es*-w+vt*S,O=M,B=q,Wt=pt),T=oe(-z,Nt),_=T*Yt,T&&(S=Math.cos(-T),w=Math.sin(-T),M=E*S-gt*w,q=C*S-Rt*w,pt=z*S-Nt*w,vt=I*w+vt*S,E=M,C=q,z=pt),T=oe(C,E),g=T*Yt,T&&(S=Math.cos(T),w=Math.sin(T),M=E*S+C*w,q=O*S+B*w,C=C*S-E*w,B=B*S-O*w,E=M,O=q),c&&Math.abs(c)+Math.abs(g)>359.9&&(c=g=0,_=180-_),p=A(Math.sqrt(E*E+C*C+z*z)),f=A(Math.sqrt(B*B+Wt*Wt)),T=oe(O,B),m=Math.abs(T)>2e-4?T*Yt:0,v=vt?1/(vt<0?-vt:vt):0),i.svg&&(M=t.getAttribute("transform"),i.forceCSS=t.setAttribute("transform","")||!ir(St(t,G)),M&&t.setAttribute("transform",M))),Math.abs(m)>90&&Math.abs(m)<270&&(r?(p*=-1,m+=g<=0?180:-180,g+=g<=0?180:-180):(f*=-1,m+=m<=0?180:-180)),i.x=h-((i.xPercent=h&&(i.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-h)?-50:0)))?t.offsetWidth*i.xPercent/100:0)+n,i.y=l-((i.yPercent=l&&(i.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-l)?-50:0)))?t.offsetHeight*i.yPercent/100:0)+n,i.z=d+n,i.scaleX=A(p),i.scaleY=A(f),i.rotation=A(g)+a,i.rotationX=A(c)+a,i.rotationY=A(_)+a,i.skewX=m+a,i.skewY=b+a,i.transformPerspective=v+n,(i.zOrigin=parseFloat(o.split(" ")[2])||0)&&(s[Ft]=Ie(o)),i.xOffset=i.yOffset=0,i.force3D=Q.force3D,i.renderTransform=i.svg?Gn:qs?rr:Hn,i.uncache=0,i},Ie=function(t){return(t=t.split(" "))[0]+" "+t[1]},Ai=function(t,e,i){var s=et(e);return A(parseFloat(e)+parseFloat(Vt(t,"x",i+"px",s)))+s},Hn=function(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,rr(t,e)},qt="0deg",we="0px",Qt=") ",rr=function(t,e){var i=e||this,s=i.xPercent,r=i.yPercent,n=i.x,a=i.y,o=i.z,h=i.rotation,l=i.rotationY,d=i.rotationX,p=i.skewX,f=i.skewY,g=i.scaleX,c=i.scaleY,_=i.transformPerspective,m=i.force3D,b=i.target,v=i.zOrigin,P="",x=m==="auto"&&t&&t!==1||m===!0;if(v&&(d!==qt||l!==qt)){var y=parseFloat(l)*ae,T=Math.sin(y),S=Math.cos(y),w;y=parseFloat(d)*ae,w=Math.cos(y),n=Ai(b,n,T*w*-v),a=Ai(b,a,-Math.sin(y)*-v),o=Ai(b,o,S*w*-v+v)}_!==we&&(P+="perspective("+_+Qt),(s||r)&&(P+="translate("+s+"%, "+r+"%) "),(x||n!==we||a!==we||o!==we)&&(P+=o!==we||x?"translate3d("+n+", "+a+", "+o+") ":"translate("+n+", "+a+Qt),h!==qt&&(P+="rotate("+h+Qt),l!==qt&&(P+="rotateY("+l+Qt),d!==qt&&(P+="rotateX("+d+Qt),(p!==qt||f!==qt)&&(P+="skew("+p+", "+f+Qt),(g!==1||c!==1)&&(P+="scale("+g+", "+c+Qt),b.style[G]=P||"translate(0, 0)"},Gn=function(t,e){var i=e||this,s=i.xPercent,r=i.yPercent,n=i.x,a=i.y,o=i.rotation,h=i.skewX,l=i.skewY,d=i.scaleX,p=i.scaleY,f=i.target,g=i.xOrigin,c=i.yOrigin,_=i.xOffset,m=i.yOffset,b=i.forceCSS,v=parseFloat(n),P=parseFloat(a),x,y,T,S,w;o=parseFloat(o),h=parseFloat(h),l=parseFloat(l),l&&(l=parseFloat(l),h+=l,o+=l),o||h?(o*=ae,h*=ae,x=Math.cos(o)*d,y=Math.sin(o)*d,T=Math.sin(o-h)*-p,S=Math.cos(o-h)*p,h&&(l*=ae,w=Math.tan(h-l),w=Math.sqrt(1+w*w),T*=w,S*=w,l&&(w=Math.tan(l),w=Math.sqrt(1+w*w),x*=w,y*=w)),x=A(x),y=A(y),T=A(T),S=A(S)):(x=d,S=p,y=T=0),(v&&!~(n+"").indexOf("px")||P&&!~(a+"").indexOf("px"))&&(v=Vt(f,"x",n,"px"),P=Vt(f,"y",a,"px")),(g||c||_||m)&&(v=A(v+g-(g*x+c*T)+_),P=A(P+c-(g*y+c*S)+m)),(s||r)&&(w=f.getBBox(),v=A(v+s/100*w.width),P=A(P+r/100*w.height)),w="matrix("+x+","+y+","+T+","+S+","+v+","+P+")",f.setAttribute("transform",w),b&&(f.style[G]=w)},Yn=function(t,e,i,s,r,n){var a=360,o=H(r),h=parseFloat(r)*(o&&~r.indexOf("rad")?Yt:1),l=n?h*n:h-s,d=s+l+"deg",p,f;return o&&(p=r.split("_")[1],p==="short"&&(l%=a,l!==l%(a/2)&&(l+=l<0?a:-a)),p==="cw"&&l<0?l=(l+a*js)%a-~~(l/a)*a:p==="ccw"&&l>0&&(l=(l-a*js)%a-~~(l/a)*a)),t._pt=f=new Z(t._pt,e,i,s,l,Dn),f.e=d,f.u="deg",t._props.push(i),f},nr=function(t,e){for(var i in e)t[i]=e[i];return t},qn=function(t,e,i){var s=nr({},i._gsap),r="perspective,force3D,transformOrigin,svgOrigin",n=i.style,a,o,h,l,d,p,f,g;s.svg?(h=i.getAttribute("transform"),i.setAttribute("transform",""),n[G]=e,a=be(i,1),ye(i,G),i.setAttribute("transform",h)):(h=getComputedStyle(i)[G],n[G]=e,a=be(i,1),n[G]=h);for(o in Dt)h=s[o],l=a[o],h!==l&&r.indexOf(o)<0&&(f=et(h),g=et(l),d=f!==g?Vt(i,o,h,g):parseFloat(h),p=parseFloat(l),t._pt=new Z(t._pt,a,o,d,p-d,Hs),t._pt.u=g||0,t._props.push(o));nr(a,s)};tt("padding,margin,Width,Radius",function(u,t){var e="Top",i="Right",s="Bottom",r="Left",n=(t<3?[e,i,s,r]:[e+r,e+i,s+i,s+r]).map(function(a){return t<2?u+a:"border"+a+u});Ve[t>1?"border"+u:u]=function(a,o,h,l,d){var p,f;if(arguments.length<4)return p=n.map(function(g){return le(a,g,h)}),f=p.join(" "),f.split(p[0]).length===5?p[0]:f;p=(l+"").split(" "),f={},n.forEach(function(g,c){return f[g]=p[c]=p[c]||p[(c-1)/2|0]}),a.init(o,f,d)}});var Ci={name:"css",register:Si,targetTest:function(t){return t.style&&t.nodeType},init:function(t,e,i,s,r){var n=this._props,a=t.style,o=i.vars.startAt,h,l,d,p,f,g,c,_,m,b,v,P,x,y,T;Pi||Si();for(c in e)if(c!=="autoRound"&&(l=e[c],!($[c]&&mi(c,e,i,s,t,r)))){if(f=typeof l,g=Ve[c],f==="function"&&(l=l.call(i,s,t,r),f=typeof l),f==="string"&&~l.indexOf("random(")&&(l=pe(l)),g)g(this,t,c,l,i)&&(T=1);else if(c.substr(0,2)==="--")h=(getComputedStyle(t).getPropertyValue(c)+"").trim(),l+="",Tt.lastIndex=0,Tt.test(h)||(_=et(h),m=et(l)),m?_!==m&&(h=Vt(t,c,h,m)+m):_&&(l+=_),this.add(a,"setProperty",h,l,s,r,0,0,c),n.push(c);else if(f!=="undefined"){if(o&&c in o?(h=typeof o[c]=="function"?o[c].call(i,s,t,r):o[c],c in Q.units&&!et(h)&&(h+=Q.units[c]),(h+"").charAt(1)==="="&&(h=le(t,c))):h=le(t,c),p=parseFloat(h),b=f==="string"&&l.charAt(1)==="="?+(l.charAt(0)+"1"):0,b&&(l=l.substr(2)),d=parseFloat(l),c in Ot&&(c==="autoAlpha"&&(p===1&&le(t,"visibility")==="hidden"&&d&&(p=0),zt(this,a,"visibility",p?"inherit":"hidden",d?"inherit":"hidden",!d)),c!=="scale"&&c!=="transform"&&(c=Ot[c],~c.indexOf(",")&&(c=c.split(",")[0]))),v=c in Dt,v){if(P||(x=t._gsap,x.renderTransform&&!e.parseTransform||be(t,e.parseTransform),y=e.smoothOrigin!==!1&&x.smooth,P=this._pt=new Z(this._pt,a,G,0,1,x.renderTransform,x,0,-1),P.dep=1),c==="scale")this._pt=new Z(this._pt,x,"scaleY",x.scaleY,(b?b*d:d-x.scaleY)||0),n.push("scaleY",c),c+="X";else if(c==="transformOrigin"){l=jn(l),x.svg?Mi(t,l,0,y,0,this):(m=parseFloat(l.split(" ")[2])||0,m!==x.zOrigin&&zt(this,x,"zOrigin",x.zOrigin,m),zt(this,a,c,Ie(h),Ie(l)));continue}else if(c==="svgOrigin"){Mi(t,l,1,y,0,this);continue}else if(c in er){Yn(this,x,c,p,l,b);continue}else if(c==="smoothOrigin"){zt(this,x,"smooth",x.smooth,l);continue}else if(c==="force3D"){x[c]=l;continue}else if(c==="transform"){qn(this,l,t);continue}}else c in a||(c=he(c)||c);if(v||(d||d===0)&&(p||p===0)&&!kn.test(l)&&c in a)_=(h+"").substr((p+"").length),d||(d=0),m=et(l)||(c in Q.units?Q.units[c]:_),_!==m&&(p=Vt(t,c,h,m)),this._pt=new Z(this._pt,v?x:a,c,p,b?b*d:d-p,!v&&(m==="px"||c==="zIndex")&&e.autoRound!==!1?Fn:Hs),this._pt.u=m||0,_!==m&&(this._pt.b=h,this._pt.r=On);else if(c in a)Wn.call(this,t,c,h,l);else if(c in t)this.add(t,c,h||t[c],l,s,r);else{Ee(c,l);continue}n.push(c)}}T&&bi(this)},get:le,aliases:Ot,getSetter:function(t,e,i){var s=Ot[e];return s&&s.indexOf(",")<0&&(e=s),e in Dt&&e!==Ft&&(t._gsap.x||le(t,"x"))?i&&Ws===i?e==="scale"?Bn:In:(Ws=i||{})&&(e==="scale"?Un:Nn):t.style&&!Se(t.style[e])?zn:~e.indexOf("-")?Vn:Fe(t,e)},core:{_removeProperty:ye,_getMatrix:Ei}};ut.utils.checkPrefix=he;(function(u,t,e,i){var s=tt(u+","+t+","+e,function(r){Dt[r]=1});tt(t,function(r){Q.units[r]="deg",er[r]=1}),Ot[s[13]]=u+","+t,tt(i,function(r){var n=r.split(":");Ot[n[1]]=s[n[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");tt("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(u){Q.units[u]="px"});ut.registerPlugin(Ci);var D=ut.registerPlugin(Ci)||ut,Aa=D.core.Tween;"use strict";var Li=class{constructor({listeners:t=[]}){this.listeners={},t.forEach(e=>{this.listeners[e]=[]})}addEvents(t){for(let[e,i]of Object.entries(t))this.listeners[e].push({callback:i})}emitEvent(t,e={}){for(let i=0;i<this.listeners[t].length;i++)this.listeners[t][i].callback&&this.listeners[t][i].callback(e)}};var ki=0;function R(){if(!(ki>100)){if(ki===100)console.warn("Curtains: too many warnings thrown, stop logging.");else{let u=Array.prototype.slice.call(arguments);console.warn.apply(console,u)}ki++}}function U(){let u=Array.prototype.slice.call(arguments);console.error.apply(console,u)}function ue(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,u=>{let t=Math.random()*16|0;return(u==="x"?t:t&3|8).toString(16).toUpperCase()})}function ft(u){return(u&u-1)==0}function ar(u,t,e){return(1-e)*u+e*t}var Di=class{constructor(t){if(this.type="Scene",!t||t.type!=="Renderer")U(this.type+": Renderer not passed as first argument",t);else if(!t.gl){U(this.type+": Renderer WebGL context is undefined",t);return}this.renderer=t,this.gl=t.gl,this.initStacks()}initStacks(){this.stacks={pingPong:[],renderTargets:[],opaque:[],transparent:[],renderPasses:[],scenePasses:[]}}resetPlaneStacks(){this.stacks.pingPong=[],this.stacks.renderTargets=[],this.stacks.opaque=[],this.stacks.transparent=[];for(let t=0;t<this.renderer.planes.length;t++)this.addPlane(this.renderer.planes[t])}resetShaderPassStacks(){this.stacks.scenePasses=[],this.stacks.renderPasses=[];for(let t=0;t<this.renderer.shaderPasses.length;t++)this.renderer.shaderPasses[t].index=t,this.renderer.shaderPasses[t]._isScenePass?this.stacks.scenePasses.push(this.renderer.shaderPasses[t]):this.stacks.renderPasses.push(this.renderer.shaderPasses[t]);this.stacks.scenePasses.length===0&&(this.renderer.state.scenePassIndex=null)}addToRenderTargetsStack(t){let e=this.renderer.planes.filter(s=>s.type!=="PingPongPlane"&&s.target&&s.uuid!==t.uuid),i=-1;if(t.target._depth){for(let s=e.length-1;s>=0;s--)if(e[s].target.uuid===t.target.uuid){i=s+1;break}}else i=e.findIndex(s=>s.target.uuid===t.target.uuid);i=Math.max(0,i),e.splice(i,0,t),t.target._depth?(e.sort((s,r)=>s.index-r.index),e.sort((s,r)=>r.renderOrder-s.renderOrder)):(e.sort((s,r)=>r.index-s.index),e.sort((s,r)=>s.renderOrder-r.renderOrder)),e.sort((s,r)=>s.target.index-r.target.index),this.stacks.renderTargets=e}addToRegularPlaneStack(t){let e=this.renderer.planes.filter(s=>s.type!=="PingPongPlane"&&!s.target&&s._transparent===t._transparent&&s.uuid!==t.uuid),i=-1;for(let s=e.length-1;s>=0;s--)if(e[s]._geometry.definition.id===t._geometry.definition.id){i=s+1;break}return i=Math.max(0,i),e.splice(i,0,t),e.sort((s,r)=>s.index-r.index),e}addPlane(t){if(t.type==="PingPongPlane")this.stacks.pingPong.push(t);else if(t.target)this.addToRenderTargetsStack(t);else if(t._transparent){let e=this.addToRegularPlaneStack(t);e.sort((i,s)=>s.relativeTranslation.z-i.relativeTranslation.z),e.sort((i,s)=>s.renderOrder-i.renderOrder),this.stacks.transparent=e}else{let e=this.addToRegularPlaneStack(t);e.sort((i,s)=>s.renderOrder-i.renderOrder),this.stacks.opaque=e}}removePlane(t){t.type==="PingPongPlane"?this.stacks.pingPong=this.stacks.pingPong.filter(e=>e.uuid!==t.uuid):t.target?this.stacks.renderTargets=this.stacks.renderTargets.filter(e=>e.uuid!==t.uuid):t._transparent?this.stacks.transparent=this.stacks.transparent.filter(e=>e.uuid!==t.uuid):this.stacks.opaque=this.stacks.opaque.filter(e=>e.uuid!==t.uuid)}setPlaneRenderOrder(t){if(t.type==="ShaderPass")this.sortShaderPassStack(t._isScenePass?this.stacks.scenePasses:this.stacks.renderPasses);else if(t.type==="PingPongPlane")return;if(t.target)t.target._depth?(this.stacks.renderTargets.sort((e,i)=>e.index-i.index),this.stacks.renderTargets.sort((e,i)=>i.renderOrder-e.renderOrder)):(this.stacks.renderTargets.sort((e,i)=>i.index-e.index),this.stacks.renderTargets.sort((e,i)=>e.renderOrder-i.renderOrder)),this.stacks.renderTargets.sort((e,i)=>e.target.index-i.target.index);else{let e=t._transparent?this.stacks.transparent:this.stacks.opaque,i=this.stacks.scenePasses.find((s,r)=>s._isScenePass&&!s._depth&&r===0);!this.renderer.depth||i?(e.sort((s,r)=>r.index-s.index),t._transparent&&e.sort((s,r)=>s.relativeTranslation.z-r.relativeTranslation.z),e.sort((s,r)=>s.renderOrder-r.renderOrder)):(e.sort((s,r)=>s.index-r.index),t._transparent&&e.sort((s,r)=>r.relativeTranslation.z-s.relativeTranslation.z),e.sort((s,r)=>r.renderOrder-s.renderOrder))}}addShaderPass(t){t._isScenePass?(this.stacks.scenePasses.push(t),this.sortShaderPassStack(this.stacks.scenePasses)):(this.stacks.renderPasses.push(t),this.sortShaderPassStack(this.stacks.renderPasses))}removeShaderPass(t){this.resetShaderPassStacks()}sortShaderPassStack(t){t.sort((e,i)=>e.index-i.index),t.sort((e,i)=>e.renderOrder-i.renderOrder)}enableShaderPass(){this.stacks.scenePasses.length&&this.stacks.renderPasses.length===0&&this.renderer.planes.length&&(this.renderer.state.scenePassIndex=0,this.renderer.bindFrameBuffer(this.stacks.scenePasses[0].target))}drawRenderPasses(){this.stacks.scenePasses.length&&this.stacks.renderPasses.length&&this.renderer.planes.length&&(this.renderer.state.scenePassIndex=0,this.renderer.bindFrameBuffer(this.stacks.scenePasses[0].target));for(let t=0;t<this.stacks.renderPasses.length;t++)this.stacks.renderPasses[t]._startDrawing(),this.renderer.clearDepth()}drawScenePasses(){for(let t=0;t<this.stacks.scenePasses.length;t++)this.stacks.scenePasses[t]._startDrawing()}drawPingPongStack(){for(let t=0;t<this.stacks.pingPong.length;t++){let e=this.stacks.pingPong[t];e&&e._startDrawing()}}drawStack(t){for(let e=0;e<this.stacks[t].length;e++){let i=this.stacks[t][e];i&&i._startDrawing()}}draw(){this.drawPingPongStack(),this.enableShaderPass(),this.drawStack("renderTargets"),this.drawRenderPasses(),this.renderer.setBlending(!1),this.drawStack("opaque"),this.stacks.transparent.length&&(this.renderer.setBlending(!0),this.drawStack("transparent")),this.drawScenePasses()}};var Oi=class{constructor(){this.geometries=[],this.clear()}clear(){this.textures=[],this.programs=[]}getGeometryFromID(t){return this.geometries.find(e=>e.id===t)}addGeometry(t,e,i){this.geometries.push({id:t,vertices:e,uvs:i})}isSameShader(t,e){return t.localeCompare(e)===0}getProgramFromShaders(t,e){return this.programs.find(i=>this.isSameShader(i.vsCode,t)&&this.isSameShader(i.fsCode,e))}addProgram(t){this.programs.push(t)}getTextureFromSource(t){let e=typeof t=="string"?t:t.src;return this.textures.find(i=>i.source&&i.source.src===e)}addTexture(t){this.getTextureFromSource(t.source)||this.textures.push(t)}removeTexture(t){this.textures=this.textures.filter(e=>e.uuid!==t.uuid)}};var Fi=class{constructor(){this.clear()}clear(){this.queue=[]}add(t,e=!1){let i={callback:t,keep:e,timeout:null};return i.timeout=setTimeout(()=>{this.queue.push(i)},0),i}execute(){this.queue.map(t=>{t.callback&&t.callback(),clearTimeout(this.queue.timeout)}),this.queue=this.queue.filter(t=>t.keep)}};var zi=class{constructor({alpha:t,antialias:e,premultipliedAlpha:i,depth:s,failIfMajorPerformanceCaveat:r,preserveDrawingBuffer:n,stencil:a,container:o,pixelRatio:h,renderingScale:l,production:d,onError:p,onSuccess:f,onContextLost:g,onContextRestored:c,onDisposed:_,onSceneChange:m}){this.type="Renderer",this.alpha=t,this.antialias=e,this.premultipliedAlpha=i,this.depth=s,this.failIfMajorPerformanceCaveat=r,this.preserveDrawingBuffer=n,this.stencil=a,this.container=o,this.pixelRatio=h,this._renderingScale=l,this.production=d,this.onError=p,this.onSuccess=f,this.onContextLost=g,this.onContextRestored=c,this.onDisposed=_,this.onSceneChange=m,this.initState(),this.canvas=document.createElement("canvas");let b={alpha:this.alpha,premultipliedAlpha:this.premultipliedAlpha,antialias:this.antialias,depth:this.depth,failIfMajorPerformanceCaveat:this.failIfMajorPerformanceCaveat,preserveDrawingBuffer:this.preserveDrawingBuffer,stencil:this.stencil};if(this.gl=this.canvas.getContext("webgl2",b),this._isWebGL2=!!this.gl,this.gl||(this.gl=this.canvas.getContext("webgl",b)||this.canvas.getContext("experimental-webgl",b)),this.gl)this.onSuccess&&this.onSuccess();else{this.production||R(this.type+": WebGL context could not be created"),this.state.isActive=!1,this.onError&&this.onError();return}this.initRenderer()}initState(){this.state={isActive:!0,isContextLost:!0,drawingEnabled:!0,forceRender:!1,currentProgramID:null,currentGeometryID:null,forceBufferUpdate:!1,depthTest:null,blending:null,cullFace:null,frameBufferID:null,scenePassIndex:null,activeTexture:null,unpackAlignment:null,flipY:null,premultiplyAlpha:null}}initCallbackQueueManager(){this.nextRender=new Fi}initRenderer(){this.planes=[],this.renderTargets=[],this.shaderPasses=[],this.state.isContextLost=!1,this.initCallbackQueueManager(),this.setBlendFunc(),this.setDepthFunc(),this.setDepthTest(!0),this.cache=new Oi,this.scene=new Di(this),this.getExtensions(),this._contextLostHandler=this.contextLost.bind(this),this.canvas.addEventListener("webglcontextlost",this._contextLostHandler,!1),this._contextRestoredHandler=this.contextRestored.bind(this),this.canvas.addEventListener("webglcontextrestored",this._contextRestoredHandler,!1)}getExtensions(){this.extensions=[],this._isWebGL2?(this.extensions.EXT_color_buffer_float=this.gl.getExtension("EXT_color_buffer_float"),this.extensions.OES_texture_float_linear=this.gl.getExtension("OES_texture_float_linear"),this.extensions.EXT_texture_filter_anisotropic=this.gl.getExtension("EXT_texture_filter_anisotropic"),this.extensions.WEBGL_lose_context=this.gl.getExtension("WEBGL_lose_context")):(this.extensions.OES_vertex_array_object=this.gl.getExtension("OES_vertex_array_object"),this.extensions.OES_texture_float=this.gl.getExtension("OES_texture_float"),this.extensions.OES_texture_float_linear=this.gl.getExtension("OES_texture_float_linear"),this.extensions.OES_texture_half_float=this.gl.getExtension("OES_texture_half_float"),this.extensions.OES_texture_half_float_linear=this.gl.getExtension("OES_texture_half_float_linear"),this.extensions.EXT_texture_filter_anisotropic=this.gl.getExtension("EXT_texture_filter_anisotropic"),this.extensions.OES_element_index_uint=this.gl.getExtension("OES_element_index_uint"),this.extensions.OES_standard_derivatives=this.gl.getExtension("OES_standard_derivatives"),this.extensions.EXT_sRGB=this.gl.getExtension("EXT_sRGB"),this.extensions.WEBGL_depth_texture=this.gl.getExtension("WEBGL_depth_texture"),this.extensions.WEBGL_draw_buffers=this.gl.getExtension("WEBGL_draw_buffers"),this.extensions.WEBGL_lose_context=this.gl.getExtension("WEBGL_lose_context"))}contextLost(t){this.state.isContextLost=!0,!!this.state.isActive&&(t.preventDefault(),this.nextRender.add(()=>this.onContextLost&&this.onContextLost()))}restoreContext(){!this.state.isActive||(this.initState(),this.gl&&this.extensions.WEBGL_lose_context?this.extensions.WEBGL_lose_context.restoreContext():(!this.gl&&!this.production?R(this.type+": Could not restore the context because the context is not defined"):!this.extensions.WEBGL_lose_context&&!this.production&&R(this.type+": Could not restore the context because the restore context extension is not defined"),this.onError&&this.onError()))}isContextexFullyRestored(){let t=!0;for(let e=0;e<this.renderTargets.length;e++){this.renderTargets[e].textures[0]._canDraw||(t=!1);break}if(t)for(let e=0;e<this.planes.length;e++)if(this.planes[e]._canDraw){for(let i=0;i<this.planes[e].textures.length;i++)if(!this.planes[e].textures[i]._canDraw){t=!1;break}}else{t=!1;break}if(t)for(let e=0;e<this.shaderPasses.length;e++)if(this.shaderPasses[e]._canDraw){for(let i=0;i<this.shaderPasses[e].textures.length;i++)if(!this.shaderPasses[e].textures[i]._canDraw){t=!1;break}}else{t=!1;break}return t}contextRestored(){this.getExtensions(),this.setBlendFunc(),this.setDepthFunc(),this.setDepthTest(!0),this.cache.clear(),this.scene.initStacks();for(let e=0;e<this.renderTargets.length;e++)this.renderTargets[e]._restoreContext();for(let e=0;e<this.planes.length;e++)this.planes[e]._restoreContext();for(let e=0;e<this.shaderPasses.length;e++)this.shaderPasses[e]._restoreContext();let t=this.nextRender.add(()=>{this.isContextexFullyRestored()&&(t.keep=!1,this.state.isContextLost=!1,this.onContextRestored&&this.onContextRestored(),this.onSceneChange(),this.needRender())},!0)}setPixelRatio(t){this.pixelRatio=t}setSize(){if(!this.gl)return;let t=this.container.getBoundingClientRect();this._boundingRect={width:t.width*this.pixelRatio,height:t.height*this.pixelRatio,top:t.top*this.pixelRatio,left:t.left*this.pixelRatio};let e=!!navigator.userAgent.match(/Version\/[\d\.]+.*Safari/),i=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;if(e&&i){let s=function(r){let n=0;for(;r&&!isNaN(r.offsetTop);)n+=r.offsetTop-r.scrollTop,r=r.offsetParent;return n};this._boundingRect.top=s(this.container)*this.pixelRatio}this.canvas.style.width=Math.floor(this._boundingRect.width/this.pixelRatio)+"px",this.canvas.style.height=Math.floor(this._boundingRect.height/this.pixelRatio)+"px",this.canvas.width=Math.floor(this._boundingRect.width*this._renderingScale),this.canvas.height=Math.floor(this._boundingRect.height*this._renderingScale),this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}resize(){for(let t=0;t<this.planes.length;t++)this.planes[t]._canDraw&&this.planes[t].resize();for(let t=0;t<this.shaderPasses.length;t++)this.shaderPasses[t]._canDraw&&this.shaderPasses[t].resize();for(let t=0;t<this.renderTargets.length;t++)this.renderTargets[t].resize();this.needRender()}clear(){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}clearDepth(){this.gl.clear(this.gl.DEPTH_BUFFER_BIT)}clearColor(){this.gl.clear(this.gl.COLOR_BUFFER_BIT)}bindFrameBuffer(t,e){let i=null;t?(i=t.index,i!==this.state.frameBufferID&&(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,t._frameBuffer),this.gl.viewport(0,0,t._size.width,t._size.height),t._shouldClear&&!e&&this.clear())):this.state.frameBufferID!==null&&(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)),this.state.frameBufferID=i}setDepthTest(t){t&&!this.state.depthTest?(this.state.depthTest=t,this.gl.enable(this.gl.DEPTH_TEST)):!t&&this.state.depthTest&&(this.state.depthTest=t,this.gl.disable(this.gl.DEPTH_TEST))}setDepthFunc(){this.gl.depthFunc(this.gl.LEQUAL)}setBlending(t=!1){t&&!this.state.blending?(this.state.blending=t,this.gl.enable(this.gl.BLEND)):!t&&this.state.blending&&(this.state.blending=t,this.gl.disable(this.gl.BLEND))}setBlendFunc(){this.gl.enable(this.gl.BLEND),this.premultipliedAlpha?this.gl.blendFuncSeparate(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA):this.gl.blendFuncSeparate(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA)}setFaceCulling(t){if(this.state.cullFace!==t)if(this.state.cullFace=t,t==="none")this.gl.disable(this.gl.CULL_FACE);else{let e=t==="front"?this.gl.FRONT:this.gl.BACK;this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(e)}}useProgram(t){(this.state.currentProgramID===null||this.state.currentProgramID!==t.id)&&(this.gl.useProgram(t.program),this.state.currentProgramID=t.id)}removePlane(t){!this.gl||(this.planes=this.planes.filter(e=>e.uuid!==t.uuid),this.scene.removePlane(t),t=null,this.gl&&this.clear(),this.onSceneChange())}removeRenderTarget(t){if(!this.gl)return;let e=this.planes.find(i=>i.type!=="PingPongPlane"&&i.target&&i.target.uuid===t.uuid);for(let i=0;i<this.planes.length;i++)this.planes[i].target&&this.planes[i].target.uuid===t.uuid&&(this.planes[i].target=null);this.renderTargets=this.renderTargets.filter(i=>i.uuid!==t.uuid);for(let i=0;i<this.renderTargets.length;i++)this.renderTargets[i].index=i;t=null,this.gl&&this.clear(),e&&this.scene.resetPlaneStacks(),this.onSceneChange()}removeShaderPass(t){!this.gl||(this.shaderPasses=this.shaderPasses.filter(e=>e.uuid!==t.uuid),this.scene.removeShaderPass(t),t=null,this.gl&&this.clear(),this.onSceneChange())}enableDrawing(){this.state.drawingEnabled=!0}disableDrawing(){this.state.drawingEnabled=!1}needRender(){this.state.forceRender=!0}render(){!this.gl||(this.clear(),this.state.currentGeometryID=null,this.scene.draw())}deletePrograms(){for(let t=0;t<this.cache.programs.length;t++){let e=this.cache.programs[t];this.gl.deleteProgram(e.program)}}dispose(){if(!this.gl)return;for(this.state.isActive=!1;this.planes.length>0;)this.removePlane(this.planes[0]);for(;this.shaderPasses.length>0;)this.removeShaderPass(this.shaderPasses[0]);for(;this.renderTargets.length>0;)this.removeRenderTarget(this.renderTargets[0]);let t=this.nextRender.add(()=>{this.planes.length===0&&this.shaderPasses.length===0&&this.renderTargets.length===0&&(t.keep=!1,this.deletePrograms(),this.clear(),this.canvas.removeEventListener("webgllost",this._contextLostHandler,!1),this.canvas.removeEventListener("webglrestored",this._contextRestoredHandler,!1),this.gl&&this.extensions.WEBGL_lose_context&&this.extensions.WEBGL_lose_context.loseContext(),this.canvas.width=this.canvas.width,this.gl=null,this.container.removeChild(this.canvas),this.container=null,this.canvas=null,this.onDisposed&&this.onDisposed())},!0)}};var Vi=class{constructor({xOffset:t=0,yOffset:e=0,lastXDelta:i=0,lastYDelta:s=0,shouldWatch:r=!0,onScroll:n=()=>{}}={}){this.xOffset=t,this.yOffset=e,this.lastXDelta=i,this.lastYDelta=s,this.shouldWatch=r,this.onScroll=n,this.handler=this.scroll.bind(this,!0),this.shouldWatch&&window.addEventListener("scroll",this.handler,{passive:!0})}scroll(){this.updateScrollValues(window.pageXOffset,window.pageYOffset)}updateScrollValues(t,e){let i=this.xOffset;this.xOffset=t,this.lastXDelta=i-this.xOffset;let s=this.yOffset;this.yOffset=e,this.lastYDelta=s-this.yOffset,this.onScroll&&this.onScroll(this.lastXDelta,this.lastYDelta)}dispose(){this.shouldWatch&&window.removeEventListener("scroll",this.handler,{passive:!0})}};var Qn="8.1.3",Be=class{constructor({container:t,alpha:e=!0,premultipliedAlpha:i=!1,antialias:s=!0,depth:r=!0,failIfMajorPerformanceCaveat:n=!0,preserveDrawingBuffer:a=!1,stencil:o=!1,autoResize:h=!0,autoRender:l=!0,watchScroll:d=!0,pixelRatio:p=window.devicePixelRatio||1,renderingScale:f=1,production:g=!1}={}){this.type="Curtains",this._autoResize=h,this._autoRender=l,this._watchScroll=d,this.pixelRatio=p,f=isNaN(f)?1:parseFloat(f),this._renderingScale=Math.max(.25,Math.min(1,f)),this.premultipliedAlpha=i,this.alpha=e,this.antialias=s,this.depth=r,this.failIfMajorPerformanceCaveat=n,this.preserveDrawingBuffer=a,this.stencil=o,this.production=g,this.errors=!1,t?this.setContainer(t):this.production||R(this.type+": no container provided in the initial parameters. Use setContainer() method to set one later and initialize the WebGL context")}setContainer(t){if(t)if(typeof t=="string")if(t=document.getElementById(t),t)this.container=t;else{let e=document.createElement("div");e.setAttribute("id","curtains-canvas"),document.body.appendChild(e),this.container=e,this.production||R('Curtains: no valid container HTML element or ID provided, created a div with "curtains-canvas" ID instead')}else t instanceof Element&&(this.container=t);else{let e=document.createElement("div");e.setAttribute("id","curtains-canvas"),document.body.appendChild(e),this.container=e,this.production||R('Curtains: no valid container HTML element or ID provided, created a div with "curtains-canvas" ID instead')}this._initCurtains()}_initCurtains(){this.planes=[],this.renderTargets=[],this.shaderPasses=[],this._initRenderer(),!!this.gl&&(this._initScroll(),this._setSize(),this._addListeners(),this.container.appendChild(this.canvas),console.log("curtains.js - v"+Qn),this._animationFrameID=null,this._autoRender&&this._animate())}_initRenderer(){this.renderer=new zi({alpha:this.alpha,antialias:this.antialias,premultipliedAlpha:this.premultipliedAlpha,depth:this.depth,failIfMajorPerformanceCaveat:this.failIfMajorPerformanceCaveat,preserveDrawingBuffer:this.preserveDrawingBuffer,stencil:this.stencil,container:this.container,pixelRatio:this.pixelRatio,renderingScale:this._renderingScale,production:this.production,onError:()=>this._onRendererError(),onSuccess:()=>this._onRendererSuccess(),onContextLost:()=>this._onRendererContextLost(),onContextRestored:()=>this._onRendererContextRestored(),onDisposed:()=>this._onRendererDisposed(),onSceneChange:()=>this._keepSync()}),this.gl=this.renderer.gl,this.canvas=this.renderer.canvas}restoreContext(){this.renderer.restoreContext()}_animate(){this.render(),this._animationFrameID=window.requestAnimationFrame(this._animate.bind(this))}enableDrawing(){this.renderer.enableDrawing()}disableDrawing(){this.renderer.disableDrawing()}needRender(){this.renderer.needRender()}nextRender(t,e=!1){return this.renderer.nextRender.add(t,e)}clear(){this.renderer&&this.renderer.clear()}clearDepth(){this.renderer&&this.renderer.clearDepth()}clearColor(){this.renderer&&this.renderer.clearColor()}isWebGL2(){return this.gl?this.renderer._isWebGL2:!1}render(){this.renderer.nextRender.execute(),!(!this.renderer.state.drawingEnabled&&!this.renderer.state.forceRender)&&(this.renderer.state.forceRender&&(this.renderer.state.forceRender=!1),this._onRenderCallback&&this._onRenderCallback(),this.renderer.render())}_addListeners(){this._resizeHandler=null,this._autoResize&&(this._resizeHandler=this.resize.bind(this,!0),window.addEventListener("resize",this._resizeHandler,!1))}setPixelRatio(t,e){this.pixelRatio=parseFloat(Math.max(t,1))||1,this.renderer.setPixelRatio(t),this.resize(e)}_setSize(){this.renderer.setSize(),this._scrollManager.shouldWatch&&(this._scrollManager.xOffset=window.pageXOffset,this._scrollManager.yOffset=window.pageYOffset)}getBoundingRect(){return this.renderer._boundingRect}resize(t){!this.gl||(this._setSize(),this.renderer.resize(),this.nextRender(()=>{this._onAfterResizeCallback&&t&&this._onAfterResizeCallback()}))}_initScroll(){this._scrollManager=new Vi({xOffset:window.pageXOffset,yOffset:window.pageYOffset,lastXDelta:0,lastYDelta:0,shouldWatch:this._watchScroll,onScroll:(t,e)=>this._updateScroll(t,e)})}_updateScroll(t,e){for(let i=0;i<this.planes.length;i++)this.planes[i].watchScroll&&this.planes[i].updateScrollPosition(t,e);this.renderer.needRender(),this._onScrollCallback&&this._onScrollCallback()}updateScrollValues(t,e){this._scrollManager.updateScrollValues(t,e)}getScrollDeltas(){return{x:this._scrollManager.lastXDelta,y:this._scrollManager.lastYDelta}}getScrollValues(){return{x:this._scrollManager.xOffset,y:this._scrollManager.yOffset}}_keepSync(){this.planes=this.renderer.planes,this.shaderPasses=this.renderer.shaderPasses,this.renderTargets=this.renderer.renderTargets}lerp(t,e,i){return ar(t,e,i)}onAfterResize(t){return t&&(this._onAfterResizeCallback=t),this}onError(t){return t&&(this._onErrorCallback=t),this}_onRendererError(){setTimeout(()=>{this._onErrorCallback&&!this.errors&&this._onErrorCallback(),this.errors=!0},0)}onSuccess(t){return t&&(this._onSuccessCallback=t),this}_onRendererSuccess(){"requestIdleCallback"in window?window.requestIdleCallback(()=>{this._onSuccessCallback&&this._onSuccessCallback()}):setTimeout(()=>{this._onSuccessCallback&&this._onSuccessCallback()},0)}onContextLost(t){return t&&(this._onContextLostCallback=t),this}_onRendererContextLost(){this._onContextLostCallback&&this._onContextLostCallback()}onContextRestored(t){return t&&(this._onContextRestoredCallback=t),this}_onRendererContextRestored(){this._onContextRestoredCallback&&this._onContextRestoredCallback()}onRender(t){return t&&(this._onRenderCallback=t),this}onScroll(t){return t&&(this._onScrollCallback=t),this}dispose(){this.renderer.dispose()}_onRendererDisposed(){this._animationFrameID&&window.cancelAnimationFrame(this._animationFrameID),this._resizeHandler&&window.removeEventListener("resize",this._resizeHandler,!1),this._scrollManager&&this._scrollManager.dispose()}};var Ii=class{constructor(t,e,i){if(this.type="Uniforms",!t||t.type!=="Renderer")U(this.type+": Renderer not passed as first argument",t);else if(!t.gl){U(this.type+": Renderer WebGL context is undefined",t);return}if(this.renderer=t,this.gl=t.gl,this.program=e,this.uniforms={},i)for(let s in i){let r=i[s];this.uniforms[s]={name:r.name,type:r.type,value:r.value.clone&&typeof r.value.clone=="function"?r.value.clone():r.value,update:null}}}handleUniformSetting(t){switch(t.type){case"1i":t.update=this.setUniform1i.bind(this);break;case"1iv":t.update=this.setUniform1iv.bind(this);break;case"1f":t.update=this.setUniform1f.bind(this);break;case"1fv":t.update=this.setUniform1fv.bind(this);break;case"2i":t.update=this.setUniform2i.bind(this);break;case"2iv":t.update=this.setUniform2iv.bind(this);break;case"2f":t.update=this.setUniform2f.bind(this);break;case"2fv":t.update=this.setUniform2fv.bind(this);break;case"3i":t.update=this.setUniform3i.bind(this);break;case"3iv":t.update=this.setUniform3iv.bind(this);break;case"3f":t.update=this.setUniform3f.bind(this);break;case"3fv":t.update=this.setUniform3fv.bind(this);break;case"4i":t.update=this.setUniform4i.bind(this);break;case"4iv":t.update=this.setUniform4iv.bind(this);break;case"4f":t.update=this.setUniform4f.bind(this);break;case"4fv":t.update=this.setUniform4fv.bind(this);break;case"mat2":t.update=this.setUniformMatrix2fv.bind(this);break;case"mat3":t.update=this.setUniformMatrix3fv.bind(this);break;case"mat4":t.update=this.setUniformMatrix4fv.bind(this);break;default:this.renderer.production||R(this.type+": This uniform type is not handled : ",t.type)}}setInternalFormat(t){t.value.type==="Vec2"?(t._internalFormat="Vec2",t.lastValue=t.value.clone()):t.value.type==="Vec3"?(t._internalFormat="Vec3",t.lastValue=t.value.clone()):t.value.type==="Mat4"?(t._internalFormat="Mat4",t.lastValue=t.value.clone()):t.value.type==="Quat"?(t._internalFormat="Quat",t.lastValue=t.value.clone()):Array.isArray(t.value)?(t._internalFormat="array",t.lastValue=Array.from(t.value)):t.value.constructor===Float32Array?(t._internalFormat="mat",t.lastValue=t.value):(t._internalFormat="float",t.lastValue=t.value)}setUniforms(){if(this.uniforms)for(let t in this.uniforms){let e=this.uniforms[t];e.location=this.gl.getUniformLocation(this.program,e.name),e._internalFormat||this.setInternalFormat(e),e.type||(e._internalFormat==="Vec2"?e.type="2f":e._internalFormat==="Vec3"?e.type="3f":e._internalFormat==="Mat4"?e.type="mat4":e._internalFormat==="array"?e.value.length===4?(e.type="4f",this.renderer.production||R(this.type+": No uniform type declared for "+e.name+", applied a 4f (array of 4 floats) uniform type")):e.value.length===3?(e.type="3f",this.renderer.production||R(this.type+": No uniform type declared for "+e.name+", applied a 3f (array of 3 floats) uniform type")):e.value.length===2&&(e.type="2f",this.renderer.production||R(this.type+": No uniform type declared for "+e.name+", applied a 2f (array of 2 floats) uniform type")):e._internalFormat==="mat"?e.value.length===16?(e.type="mat4",this.renderer.production||R(this.type+": No uniform type declared for "+e.name+", applied a mat4 (4x4 matrix array) uniform type")):e.value.length===9?(e.type="mat3",this.renderer.production||R(this.type+": No uniform type declared for "+e.name+", applied a mat3 (3x3 matrix array) uniform type")):e.value.length===4&&(e.type="mat2",this.renderer.production||R(this.type+": No uniform type declared for "+e.name+", applied a mat2 (2x2 matrix array) uniform type")):(e.type="1f",this.renderer.production||R(this.type+": No uniform type declared for "+e.name+", applied a 1f (float) uniform type"))),this.handleUniformSetting(e),e.update&&e.update(e)}}updateUniforms(){if(this.uniforms)for(let t in this.uniforms){let e=this.uniforms[t],i=!1;e._internalFormat==="Vec2"||e._internalFormat==="Vec3"||e._internalFormat==="Quat"?e.value.equals(e.lastValue)||(i=!0,e.lastValue.copy(e.value)):e.value.length?JSON.stringify(e.value)!==JSON.stringify(e.lastValue)&&(i=!0,e.lastValue=Array.from(e.value)):e.value!==e.lastValue&&(i=!0,e.lastValue=e.value),i&&e.update&&e.update(e)}}setUniform1i(t){this.gl.uniform1i(t.location,t.value)}setUniform1iv(t){this.gl.uniform1iv(t.location,t.value)}setUniform1f(t){this.gl.uniform1f(t.location,t.value)}setUniform1fv(t){this.gl.uniform1fv(t.location,t.value)}setUniform2i(t){t._internalFormat==="Vec2"?this.gl.uniform2i(t.location,t.value.x,t.value.y):this.gl.uniform2i(t.location,t.value[0],t.value[1])}setUniform2iv(t){t._internalFormat==="Vec2"?this.gl.uniform2iv(t.location,[t.value.x,t.value.y]):this.gl.uniform2iv(t.location,t.value)}setUniform2f(t){t._internalFormat==="Vec2"?this.gl.uniform2f(t.location,t.value.x,t.value.y):this.gl.uniform2f(t.location,t.value[0],t.value[1])}setUniform2fv(t){t._internalFormat==="Vec2"?this.gl.uniform2fv(t.location,[t.value.x,t.value.y]):this.gl.uniform2fv(t.location,t.value)}setUniform3i(t){t._internalFormat==="Vec3"?this.gl.uniform3i(t.location,t.value.x,t.value.y,t.value.z):this.gl.uniform3i(t.location,t.value[0],t.value[1],t.value[2])}setUniform3iv(t){t._internalFormat==="Vec3"?this.gl.uniform3iv(t.location,[t.value.x,t.value.y,t.value.z]):this.gl.uniform3iv(t.location,t.value)}setUniform3f(t){t._internalFormat==="Vec3"?this.gl.uniform3f(t.location,t.value.x,t.value.y,t.value.z):this.gl.uniform3f(t.location,t.value[0],t.value[1],t.value[2])}setUniform3fv(t){t._internalFormat==="Vec3"?this.gl.uniform3fv(t.location,[t.value.x,t.value.y,t.value.z]):this.gl.uniform3fv(t.location,t.value)}setUniform4i(t){t._internalFormat==="Quat"?this.gl.uniform4i(t.location,t.value.elements[0],t.value.elements[1],t.value.elements[2],t.value[3]):this.gl.uniform4i(t.location,t.value[0],t.value[1],t.value[2],t.value[3])}setUniform4iv(t){t._internalFormat==="Quat"?this.gl.uniform4iv(t.location,[t.value.elements[0],t.value.elements[1],t.value.elements[2],t.value[3]]):this.gl.uniform4iv(t.location,t.value)}setUniform4f(t){t._internalFormat==="Quat"?this.gl.uniform4f(t.location,t.value.elements[0],t.value.elements[1],t.value.elements[2],t.value[3]):this.gl.uniform4f(t.location,t.value[0],t.value[1],t.value[2],t.value[3])}setUniform4fv(t){t._internalFormat==="Quat"?this.gl.uniform4fv(t.location,[t.value.elements[0],t.value.elements[1],t.value.elements[2],t.value[3]]):this.gl.uniform4fv(t.location,t.value)}setUniformMatrix2fv(t){this.gl.uniformMatrix2fv(t.location,!1,t.value)}setUniformMatrix3fv(t){this.gl.uniformMatrix3fv(t.location,!1,t.value)}setUniformMatrix4fv(t){t._internalFormat==="Mat4"?this.gl.uniformMatrix4fv(t.location,!1,t.value.elements):this.gl.uniformMatrix4fv(t.location,!1,t.value)}};var Zn=`
precision mediump float;
`,It=Zn.replace(/\n/g,"");var Kn=`
attribute vec3 aVertexPosition;
attribute vec2 aTextureCoord;
`,Ue=Kn.replace(/\n/g,"");var Jn=`
varying vec3 vVertexPosition;
varying vec2 vTextureCoord;
`,Bt=Jn.replace(/\n/g,"");var $n=It+Ue+Bt+`
uniform mat4 uMVMatrix;
uniform mat4 uPMatrix;

void main() {
    vTextureCoord = aTextureCoord;
    vVertexPosition = aVertexPosition;
    
    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
}
`,or=$n.replace(/\n/g,"");var ta=It+Bt+`
void main() {
    gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
}
`,hr=ta.replace(/\n/g,"");var ea=It+Ue+Bt+`
void main() {
    vTextureCoord = aTextureCoord;
    vVertexPosition = aVertexPosition;
    
    gl_Position = vec4(aVertexPosition, 1.0);
}
`,lr=ea.replace(/\n/g,"");var ia=It+Bt+`
uniform sampler2D uRenderTexture;

void main() {
    gl_FragColor = texture2D(uRenderTexture, vTextureCoord);
}
`,ur=ia.replace(/\n/g,"");var dr=0,Ne=class{constructor(t,{parent:e,vertexShader:i,fragmentShader:s}={}){if(this.type="Program",!t||t.type!=="Renderer")U(this.type+": Renderer not passed as first argument",t);else if(!t.gl){U(this.type+": Renderer WebGL context is undefined",t);return}this.renderer=t,this.gl=this.renderer.gl,this.parent=e,this.defaultVsCode=this.parent.type==="Plane"?or:lr,this.defaultFsCode=this.parent.type==="Plane"?hr:ur,i?this.vsCode=i:(!this.renderer.production&&this.parent.type==="Plane"&&R(this.parent.type+": No vertex shader provided, will use a default one"),this.vsCode=this.defaultVsCode),s?this.fsCode=s:(this.renderer.production||R(this.parent.type+": No fragment shader provided, will use a default one"),this.fsCode=this.defaultFsCode),this.compiled=!0,this.setupProgram()}createShader(t,e){let i=this.gl.createShader(e);if(this.gl.shaderSource(i,t),this.gl.compileShader(i),!this.renderer.production&&!this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS)){let s=e===this.gl.VERTEX_SHADER?"vertex shader":"fragment shader",n=this.gl.getShaderSource(i).split(`
`);for(let a=0;a<n.length;a++)n[a]=a+1+": "+n[a];return n=n.join(`
`),R(this.type+": Errors occurred while compiling the",s,`:
`,this.gl.getShaderInfoLog(i)),U(n),R(this.type+": Will use a default",s),this.createShader(e===this.gl.VERTEX_SHADER?this.defaultVsCode:this.defaultFsCode,e)}return i}useNewShaders(){this.vertexShader=this.createShader(this.vsCode,this.gl.VERTEX_SHADER),this.fragmentShader=this.createShader(this.fsCode,this.gl.FRAGMENT_SHADER),(!this.vertexShader||!this.fragmentShader)&&(this.renderer.production||R(this.type+": Unable to find or compile the vertex or fragment shader"))}setupProgram(){let t=this.renderer.cache.getProgramFromShaders(this.vsCode,this.fsCode);t?(this.vertexShader=t.vertexShader,this.fragmentShader=t.fragmentShader,this.activeUniforms=t.activeUniforms,this.activeAttributes=t.activeAttributes,this.createProgram()):(this.useNewShaders(),this.compiled&&(this.createProgram(),this.renderer.cache.addProgram(this)))}createProgram(){if(dr++,this.id=dr,this.program=this.gl.createProgram(),this.gl.attachShader(this.program,this.vertexShader),this.gl.attachShader(this.program,this.fragmentShader),this.gl.linkProgram(this.program),!this.renderer.production&&!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS)){R(this.type+": Unable to initialize the shader program: "+this.gl.getProgramInfoLog(this.program)),R(this.type+": Will use default vertex and fragment shaders"),this.vertexShader=this.createShader(this.defaultVsCode,this.gl.VERTEX_SHADER),this.fragmentShader=this.createShader(this.defaultFsCode,this.gl.FRAGMENT_SHADER),this.createProgram();return}if(this.gl.deleteShader(this.vertexShader),this.gl.deleteShader(this.fragmentShader),!this.activeUniforms||!this.activeAttributes){this.activeUniforms={textures:[],textureMatrices:[]};let t=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_UNIFORMS);for(let i=0;i<t;i++){let s=this.gl.getActiveUniform(this.program,i);s.type===this.gl.SAMPLER_2D&&this.activeUniforms.textures.push(s.name),s.type===this.gl.FLOAT_MAT4&&s.name!=="uMVMatrix"&&s.name!=="uPMatrix"&&this.activeUniforms.textureMatrices.push(s.name)}this.activeAttributes=[];let e=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES);for(let i=0;i<e;i++){let s=this.gl.getActiveAttrib(this.program,i);this.activeAttributes.push(s.name)}}}createUniforms(t){this.uniformsManager=new Ii(this.renderer,this.program,t),this.setUniforms()}setUniforms(){this.renderer.useProgram(this),this.uniformsManager.setUniforms()}updateUniforms(){this.renderer.useProgram(this),this.uniformsManager.updateUniforms()}};var Bi=class{constructor(t,{program:e=null,width:i=1,height:s=1}={}){if(this.type="Geometry",!t||t.type!=="Renderer")U(this.type+": Renderer not passed as first argument",t);else if(!t.gl){U(this.type+": Renderer WebGL context is undefined",t);return}this.renderer=t,this.gl=this.renderer.gl,this.definition={id:i*s+i,width:i,height:s},this.setDefaultAttributes(),this.setVerticesUVs()}restoreContext(t){this.program=null,this.setDefaultAttributes(),this.setVerticesUVs(),this.setProgram(t)}setDefaultAttributes(){this.attributes={vertexPosition:{name:"aVertexPosition",size:3,isActive:!1},textureCoord:{name:"aTextureCoord",size:3,isActive:!1}}}setVerticesUVs(){let t=this.renderer.cache.getGeometryFromID(this.definition.id);t?(this.attributes.vertexPosition.array=t.vertices,this.attributes.textureCoord.array=t.uvs):(this.computeVerticesUVs(),this.renderer.cache.addGeometry(this.definition.id,this.attributes.vertexPosition.array,this.attributes.textureCoord.array))}setProgram(t){this.program=t,this.initAttributes(),this.renderer._isWebGL2?(this._vao=this.gl.createVertexArray(),this.gl.bindVertexArray(this._vao)):this.renderer.extensions.OES_vertex_array_object&&(this._vao=this.renderer.extensions.OES_vertex_array_object.createVertexArrayOES(),this.renderer.extensions.OES_vertex_array_object.bindVertexArrayOES(this._vao)),this.initializeBuffers()}initAttributes(){for(let t in this.attributes){if(this.attributes[t].isActive=this.program.activeAttributes.includes(this.attributes[t].name),!this.attributes[t].isActive)return;this.attributes[t].location=this.gl.getAttribLocation(this.program.program,this.attributes[t].name),this.attributes[t].buffer=this.gl.createBuffer(),this.attributes[t].numberOfItems=this.definition.width*this.definition.height*this.attributes[t].size*2}}computeVerticesUVs(){this.attributes.vertexPosition.array=[],this.attributes.textureCoord.array=[];let t=this.attributes.vertexPosition.array,e=this.attributes.textureCoord.array;for(let i=0;i<this.definition.height;i++){let s=i/this.definition.height;for(let r=0;r<this.definition.width;r++){let n=r/this.definition.width;e.push(n),e.push(s),e.push(0),t.push((n-.5)*2),t.push((s-.5)*2),t.push(0),e.push(n+1/this.definition.width),e.push(s),e.push(0),t.push((n+1/this.definition.width-.5)*2),t.push((s-.5)*2),t.push(0),e.push(n),e.push(s+1/this.definition.height),e.push(0),t.push((n-.5)*2),t.push((s+1/this.definition.height-.5)*2),t.push(0),e.push(n),e.push(s+1/this.definition.height),e.push(0),t.push((n-.5)*2),t.push((s+1/this.definition.height-.5)*2),t.push(0),e.push(n+1/this.definition.width),e.push(s),e.push(0),t.push((n+1/this.definition.width-.5)*2),t.push((s-.5)*2),t.push(0),e.push(n+1/this.definition.width),e.push(s+1/this.definition.height),e.push(0),t.push((n+1/this.definition.width-.5)*2),t.push((s+1/this.definition.height-.5)*2),t.push(0)}}}initializeBuffers(){if(!!this.attributes){for(let t in this.attributes){if(!this.attributes[t].isActive)return;this.gl.enableVertexAttribArray(this.attributes[t].location),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.attributes[t].buffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.attributes[t].array),this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.attributes[t].location,this.attributes[t].size,this.gl.FLOAT,!1,0,0)}this.renderer.state.currentGeometryID=this.definition.id}}bindBuffers(){if(this._vao)this.renderer._isWebGL2?this.gl.bindVertexArray(this._vao):this.renderer.extensions.OES_vertex_array_object.bindVertexArrayOES(this._vao);else for(let t in this.attributes){if(!this.attributes[t].isActive)return;this.gl.enableVertexAttribArray(this.attributes[t].location),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.attributes[t].buffer),this.gl.vertexAttribPointer(this.attributes[t].location,this.attributes[t].size,this.gl.FLOAT,!1,0,0)}this.renderer.state.currentGeometryID=this.definition.id}draw(){this.gl.drawArrays(this.gl.TRIANGLES,0,this.attributes.vertexPosition.numberOfItems)}dispose(){this._vao&&(this.renderer._isWebGL2?this.gl.deleteVertexArray(this._vao):this.renderer.extensions.OES_vertex_array_object.deleteVertexArrayOES(this._vao));for(let t in this.attributes){if(!this.attributes[t].isActive)return;this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.attributes[t].buffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,1,this.gl.STATIC_DRAW),this.gl.deleteBuffer(this.attributes[t].buffer)}this.attributes=null,this.renderer.state.currentGeometryID=null}};var K=class{constructor(t=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])){this.type="Mat4",this.elements=t}setFromArray(t){for(let e=0;e<this.elements.length;e++)this.elements[e]=t[e];return this}copy(t){let e=t.elements;return this.elements[0]=e[0],this.elements[1]=e[1],this.elements[2]=e[2],this.elements[3]=e[3],this.elements[4]=e[4],this.elements[5]=e[5],this.elements[6]=e[6],this.elements[7]=e[7],this.elements[8]=e[8],this.elements[9]=e[9],this.elements[10]=e[10],this.elements[11]=e[11],this.elements[12]=e[12],this.elements[13]=e[13],this.elements[14]=e[14],this.elements[15]=e[15],this}clone(){return new K().copy(this)}multiply(t){let e=this.elements,i=t.elements,s=new K;return s.elements[0]=i[0]*e[0]+i[1]*e[4]+i[2]*e[8]+i[3]*e[12],s.elements[1]=i[0]*e[1]+i[1]*e[5]+i[2]*e[9]+i[3]*e[13],s.elements[2]=i[0]*e[2]+i[1]*e[6]+i[2]*e[10]+i[3]*e[14],s.elements[3]=i[0]*e[3]+i[1]*e[7]+i[2]*e[11]+i[3]*e[15],s.elements[4]=i[4]*e[0]+i[5]*e[4]+i[6]*e[8]+i[7]*e[12],s.elements[5]=i[4]*e[1]+i[5]*e[5]+i[6]*e[9]+i[7]*e[13],s.elements[6]=i[4]*e[2]+i[5]*e[6]+i[6]*e[10]+i[7]*e[14],s.elements[7]=i[4]*e[3]+i[5]*e[7]+i[6]*e[11]+i[7]*e[15],s.elements[8]=i[8]*e[0]+i[9]*e[4]+i[10]*e[8]+i[11]*e[12],s.elements[9]=i[8]*e[1]+i[9]*e[5]+i[10]*e[9]+i[11]*e[13],s.elements[10]=i[8]*e[2]+i[9]*e[6]+i[10]*e[10]+i[11]*e[14],s.elements[11]=i[8]*e[3]+i[9]*e[7]+i[10]*e[11]+i[11]*e[15],s.elements[12]=i[12]*e[0]+i[13]*e[4]+i[14]*e[8]+i[15]*e[12],s.elements[13]=i[12]*e[1]+i[13]*e[5]+i[14]*e[9]+i[15]*e[13],s.elements[14]=i[12]*e[2]+i[13]*e[6]+i[14]*e[10]+i[15]*e[14],s.elements[15]=i[12]*e[3]+i[13]*e[7]+i[14]*e[11]+i[15]*e[15],s}getInverse(){let t=this.elements,e=new K,i=e.elements,s=t[0],r=t[1],n=t[2],a=t[3],o=t[4],h=t[5],l=t[6],d=t[7],p=t[8],f=t[9],g=t[10],c=t[11],_=t[12],m=t[13],b=t[14],v=t[15],P=s*h-r*o,x=s*l-n*o,y=s*d-a*o,T=r*l-n*h,S=r*d-a*h,w=n*d-a*l,E=p*m-f*_,C=p*b-g*_,z=p*v-c*_,I=f*b-g*m,O=f*v-c*m,B=g*v-c*b,M=P*B-x*O+y*I+T*z-S*C+w*E;return M?(M=1/M,i[0]=(h*B-l*O+d*I)*M,i[1]=(n*O-r*B-a*I)*M,i[2]=(m*w-b*S+v*T)*M,i[3]=(g*S-f*w-c*T)*M,i[4]=(l*z-o*B-d*C)*M,i[5]=(s*B-n*z+a*C)*M,i[6]=(b*y-_*w-v*x)*M,i[7]=(p*w-g*y+c*x)*M,i[8]=(o*O-h*z+d*E)*M,i[9]=(r*z-s*O-a*E)*M,i[10]=(_*S-m*y+v*P)*M,i[11]=(f*y-p*S-c*P)*M,i[12]=(h*C-o*I-l*E)*M,i[13]=(s*I-r*C+n*E)*M,i[14]=(m*x-_*T-b*P)*M,i[15]=(p*T-f*x+g*P)*M,e):null}scale(t){let e=this.elements;return e[0]*=t.x,e[1]*=t.x,e[2]*=t.x,e[3]*=t.x,e[4]*=t.y,e[5]*=t.y,e[6]*=t.y,e[7]*=t.y,e[8]*=t.z,e[9]*=t.z,e[10]*=t.z,e[11]*=t.z,this}compose(t,e,i){let s=this.elements,r=e.elements[0],n=e.elements[1],a=e.elements[2],o=e.elements[3],h=r+r,l=n+n,d=a+a,p=r*h,f=r*l,g=r*d,c=n*l,_=n*d,m=a*d,b=o*h,v=o*l,P=o*d,x=i.x,y=i.y,T=i.z;return s[0]=(1-(c+m))*x,s[1]=(f+P)*x,s[2]=(g-v)*x,s[3]=0,s[4]=(f-P)*y,s[5]=(1-(p+m))*y,s[6]=(_+b)*y,s[7]=0,s[8]=(g+v)*T,s[9]=(_-b)*T,s[10]=(1-(p+c))*T,s[11]=0,s[12]=t.x,s[13]=t.y,s[14]=t.z,s[15]=1,this}composeFromOrigin(t,e,i,s){let r=this.elements,n=e.elements[0],a=e.elements[1],o=e.elements[2],h=e.elements[3],l=n+n,d=a+a,p=o+o,f=n*l,g=n*d,c=n*p,_=a*d,m=a*p,b=o*p,v=h*l,P=h*d,x=h*p,y=i.x,T=i.y,S=i.z,w=s.x,E=s.y,C=s.z,z=(1-(_+b))*y,I=(g+x)*y,O=(c-P)*y,B=(g-x)*T,M=(1-(f+b))*T,q=(m+v)*T,pt=(c+P)*S,gt=(m-v)*S,Rt=(1-(f+_))*S;return r[0]=z,r[1]=I,r[2]=O,r[3]=0,r[4]=B,r[5]=M,r[6]=q,r[7]=0,r[8]=pt,r[9]=gt,r[10]=Rt,r[11]=0,r[12]=t.x+w-(z*w+B*E+pt*C),r[13]=t.y+E-(I*w+M*E+gt*C),r[14]=t.z+C-(O*w+q*E+Rt*C),r[15]=1,this}};var W=class{constructor(t=0,e=t){this.type="Vec2",this._x=t,this._y=e}get x(){return this._x}get y(){return this._y}set x(t){let e=t!==this._x;this._x=t,e&&this._onChangeCallback&&this._onChangeCallback()}set y(t){let e=t!==this._y;this._y=t,e&&this._onChangeCallback&&this._onChangeCallback()}onChange(t){return t&&(this._onChangeCallback=t),this}set(t,e){return this._x=t,this._y=e,this}add(t){return this._x+=t.x,this._y+=t.y,this}addScalar(t){return this._x+=t,this._y+=t,this}sub(t){return this._x-=t.x,this._y-=t.y,this}subScalar(t){return this._x-=t,this._y-=t,this}multiply(t){return this._x*=t.x,this._y*=t.y,this}multiplyScalar(t){return this._x*=t,this._y*=t,this}copy(t){return this._x=t.x,this._y=t.y,this}clone(){return new W(this._x,this._y)}sanitizeNaNValuesWith(t){return this._x=isNaN(this._x)?t.x:parseFloat(this._x),this._y=isNaN(this._y)?t.y:parseFloat(this._y),this}max(t){return this._x=Math.max(this._x,t.x),this._y=Math.max(this._y,t.y),this}min(t){return this._x=Math.min(this._x,t.x),this._y=Math.min(this._y,t.y),this}equals(t){return this._x===t.x&&this._y===t.y}normalize(){let t=this._x*this._x+this._y*this._y;return t>0&&(t=1/Math.sqrt(t)),this._x*=t,this._y*=t,this}dot(t){return this._x*t.x+this._y*t.y}};var k=class{constructor(t=0,e=t,i=t){this.type="Vec3",this._x=t,this._y=e,this._z=i}get x(){return this._x}get y(){return this._y}get z(){return this._z}set x(t){let e=t!==this._x;this._x=t,e&&this._onChangeCallback&&this._onChangeCallback()}set y(t){let e=t!==this._y;this._y=t,e&&this._onChangeCallback&&this._onChangeCallback()}set z(t){let e=t!==this._z;this._z=t,e&&this._onChangeCallback&&this._onChangeCallback()}onChange(t){return t&&(this._onChangeCallback=t),this}set(t,e,i){return this._x=t,this._y=e,this._z=i,this}add(t){return this._x+=t.x,this._y+=t.y,this._z+=t.z,this}addScalar(t){return this._x+=t,this._y+=t,this._z+=t,this}sub(t){return this._x-=t.x,this._y-=t.y,this._z-=t.z,this}subScalar(t){return this._x-=t,this._y-=t,this._z-=t,this}multiply(t){return this._x*=t.x,this._y*=t.y,this._z*=t.z,this}multiplyScalar(t){return this._x*=t,this._y*=t,this._z*=t,this}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this}clone(){return new k(this._x,this._y,this._z)}sanitizeNaNValuesWith(t){return this._x=isNaN(this._x)?t.x:parseFloat(this._x),this._y=isNaN(this._y)?t.y:parseFloat(this._y),this._z=isNaN(this._z)?t.z:parseFloat(this._z),this}max(t){return this._x=Math.max(this._x,t.x),this._y=Math.max(this._y,t.y),this._z=Math.max(this._z,t.z),this}min(t){return this._x=Math.min(this._x,t.x),this._y=Math.min(this._y,t.y),this._z=Math.min(this._z,t.z),this}equals(t){return this._x===t.x&&this._y===t.y&&this._z===t.z}normalize(){let t=this._x*this._x+this._y*this._y+this._z*this._z;return t>0&&(t=1/Math.sqrt(t)),this._x*=t,this._y*=t,this._z*=t,this}dot(t){return this._x*t.x+this._y*t.y+this._z*t.z}applyMat4(t){let e=this._x,i=this._y,s=this._z,r=t.elements,n=r[3]*e+r[7]*i+r[11]*s+r[15];return n=n||1,this._x=(r[0]*e+r[4]*i+r[8]*s+r[12])/n,this._y=(r[1]*e+r[5]*i+r[9]*s+r[13])/n,this._z=(r[2]*e+r[6]*i+r[10]*s+r[14])/n,this}applyQuat(t){let e=this._x,i=this._y,s=this._z,r=t.elements[0],n=t.elements[1],a=t.elements[2],o=t.elements[3],h=o*e+n*s-a*i,l=o*i+a*e-r*s,d=o*s+r*i-n*e,p=-r*e-n*i-a*s;return this._x=h*o+p*-r+l*-a-d*-n,this._y=l*o+p*-n+d*-r-h*-a,this._z=d*o+p*-a+h*-n-l*-r,this}project(t){return this.applyMat4(t.viewMatrix).applyMat4(t.projectionMatrix),this}unproject(t){return this.applyMat4(t.projectionMatrix.getInverse()).applyMat4(t.worldMatrix),this}};var Ui=new W,sa=new k,ra=new K,nt=class{constructor(t,{isFBOTexture:e=!1,fromTexture:i=!1,loader:s,sampler:r,floatingPoint:n="none",premultiplyAlpha:a=!1,anisotropy:o=1,generateMipmap:h=null,wrapS:l,wrapT:d,minFilter:p,magFilter:f}={}){if(this.type="Texture",t=t&&t.renderer||t,!t||t.type!=="Renderer")U(this.type+": Renderer not passed as first argument",t);else if(!t.gl){t.production||U(this.type+": Unable to create a "+this.type+" because the Renderer WebGL context is not defined");return}if(this.renderer=t,this.gl=this.renderer.gl,this.uuid=ue(),this._globalParameters={unpackAlignment:4,flipY:!e,premultiplyAlpha:!1,shouldPremultiplyAlpha:a,floatingPoint:n,type:this.gl.UNSIGNED_BYTE,internalFormat:this.gl.RGBA,format:this.gl.RGBA},this.parameters={anisotropy:o,generateMipmap:h,wrapS:l||this.gl.CLAMP_TO_EDGE,wrapT:d||this.gl.CLAMP_TO_EDGE,minFilter:p||this.gl.LINEAR,magFilter:f||this.gl.LINEAR,_shouldUpdate:!0},this._initState(),this.sourceType=e?"fbo":"empty",this._useCache=!0,this._samplerName=r,this._sampler={isActive:!1,isTextureBound:!1,texture:this.gl.createTexture()},this._textureMatrix={matrix:new K,isActive:!1},this._size={width:1,height:1},this.scale=new W(1),this.scale.onChange(()=>this.resize()),this.offset=new W,this.offset.onChange(()=>this.resize()),this._loader=s,this._sourceLoaded=!1,this._uploaded=!1,this._willUpdate=!1,this.shouldUpdate=!1,this._forceUpdate=!1,this.userData={},this._canDraw=!1,i){this._copyOnInit=!0,this._copiedFrom=i;return}this._copyOnInit=!1,this._initTexture()}_initState(){this._state={anisotropy:1,generateMipmap:!1,wrapS:null,wrapT:null,minFilter:null,magFilter:this.gl.LINEAR}}_initTexture(){this.gl.bindTexture(this.gl.TEXTURE_2D,this._sampler.texture),this.sourceType==="empty"&&(this._globalParameters.flipY=!1,this._updateGlobalTexParameters(),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,1,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,new Uint8Array([0,0,0,255])),this._canDraw=!0)}_restoreFromTexture(){this._copyOnInit||this._initTexture(),this._parent&&(this._setTextureUniforms(),this._setSize()),this.copy(this._copiedFrom),this._canDraw=!0}_restoreContext(){if(this._canDraw=!1,this._sampler.texture=this.gl.createTexture(),this._sampler.isActive=!1,this._sampler.isTextureBound=!1,this._textureMatrix.isActive=!1,this._initState(),this._state.generateMipmap=!1,this.parameters._shouldUpdate=!0,!this._copiedFrom)this._initTexture(),this._parent&&this._setParent(),this.source&&(this.setSource(this.source),this.sourceType==="image"?this.renderer.cache.addTexture(this):this.needUpdate()),this._canDraw=!0;else{let t=this.renderer.nextRender.add(()=>{this._copiedFrom._canDraw&&(this._restoreFromTexture(),t.keep=!1)},!0)}}addParent(t){if(!t||t.type!=="Plane"&&t.type!=="PingPongPlane"&&t.type!=="ShaderPass"&&t.type!=="RenderTarget"){this.renderer.production||R(this.type+": cannot add texture as a child of ",t," because it is not a valid parent");return}this._parent=t,this.index=this._parent.textures.length,this._parent.textures.push(this),this._setParent()}_setParent(){if(this._sampler.name=this._samplerName||"uSampler"+this.index,this._textureMatrix.name=this._samplerName?this._samplerName+"Matrix":"uTextureMatrix"+this.index,this._parent._program){if(!this._parent._program.compiled){this.renderer.production||R(this.type+": Unable to create the texture because the program is not valid");return}if(this._setTextureUniforms(),this._copyOnInit){let t=this.renderer.nextRender.add(()=>{this._copiedFrom._canDraw&&this._copiedFrom._uploaded&&(this.copy(this._copiedFrom),t.keep=!1)},!0);return}this.source?this._parent.loader&&this._parent.loader._addSourceToParent(this.source,this.sourceType):this._size={width:this._parent._boundingRect.document.width,height:this._parent._boundingRect.document.height},this._setSize()}else this._parent.type==="RenderTarget"&&(this._size={width:this._parent._size&&this._parent._size.width||this.renderer._boundingRect.width,height:this._parent._size&&this._parent._size.height||this.renderer._boundingRect.height},this._upload(),this._updateTexParameters(),this._canDraw=!0)}hasParent(){return!!this._parent}_setTextureUniforms(){let t=this._parent._program.activeUniforms;for(let e=0;e<t.textures.length;e++)t.textures[e]===this._sampler.name&&(this._sampler.isActive=!0,this.renderer.useProgram(this._parent._program),this._sampler.location=this.gl.getUniformLocation(this._parent._program.program,this._sampler.name),t.textureMatrices.find(s=>s===this._textureMatrix.name)&&(this._textureMatrix.isActive=!0,this._textureMatrix.location=this.gl.getUniformLocation(this._parent._program.program,this._textureMatrix.name)),this.gl.uniform1i(this._sampler.location,this.index))}copy(t){if(!t||t.type!=="Texture"){this.renderer.production||R(this.type+": Unable to set the texture from texture:",t);return}this._globalParameters=Object.assign({},t._globalParameters),this._state=Object.assign({},t._state),this.parameters.generateMipmap=t.parameters.generateMipmap,this._state.generateMipmap=null,this._size=t._size,!this._sourceLoaded&&t._sourceLoaded&&this._onSourceLoadedCallback&&this._onSourceLoadedCallback(),this._sourceLoaded=t._sourceLoaded,!this._uploaded&&t._uploaded&&this._onSourceUploadedCallback&&this._onSourceUploadedCallback(),this._uploaded=t._uploaded,this.sourceType=t.sourceType,this.source=t.source,this._videoFrameCallbackID=t._videoFrameCallbackID,this._sampler.texture=t._sampler.texture,this._copiedFrom=t,this._parent&&this._parent._program&&(!this._canDraw||!this._textureMatrix.matrix)&&(this._setSize(),this._canDraw=!0),this._updateTexParameters()}setSource(t){if(!this._sampler.texture)return;this._sourceLoaded||this.renderer.nextRender.add(()=>this._onSourceLoadedCallback&&this._onSourceLoadedCallback());let e=t.tagName.toUpperCase()==="IMG"?"image":t.tagName.toLowerCase();if((e==="video"||e==="canvas")&&(this._useCache=!1),this._useCache){let i=this.renderer.cache.getTextureFromSource(t);if(i&&i.uuid!==this.uuid){this._uploaded||(this.renderer.nextRender.add(()=>this._onSourceUploadedCallback&&this._onSourceUploadedCallback()),this._uploaded=!0),this.copy(i),this.resize();return}}if(this.sourceType==="empty"||this.sourceType!==e)if(e==="video")this._willUpdate=!1,this.shouldUpdate=!0;else if(e==="canvas")this._willUpdate=!0,this.shouldUpdate=!0;else if(e==="image")this._willUpdate=!1,this.shouldUpdate=!1;else{this.renderer.production||R(this.type+": this HTML tag could not be converted into a texture:",t.tagName);return}this.source=t,this.sourceType=e,this._size={width:this.source.naturalWidth||this.source.width||this.source.videoWidth,height:this.source.naturalHeight||this.source.height||this.source.videoHeight},this._sourceLoaded=!0,this.gl.bindTexture(this.gl.TEXTURE_2D,this._sampler.texture),this.resize(),this._globalParameters.flipY=!0,this._globalParameters.premultiplyAlpha=this._globalParameters.shouldPremultiplyAlpha,this.sourceType==="image"&&(this.parameters.generateMipmap=this.parameters.generateMipmap||this.parameters.generateMipmap===null,this.parameters._shouldUpdate=this.parameters.generateMipmap,this._state.generateMipmap=!1,this._upload()),this.renderer.needRender()}_updateGlobalTexParameters(){this.renderer.state.unpackAlignment!==this._globalParameters.unpackAlignment&&(this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,this._globalParameters.unpackAlignment),this.renderer.state.unpackAlignment=this._globalParameters.unpackAlignment),this.renderer.state.flipY!==this._globalParameters.flipY&&(this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,this._globalParameters.flipY),this.renderer.state.flipY=this._globalParameters.flipY),this.renderer.state.premultiplyAlpha!==this._globalParameters.premultiplyAlpha&&(this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this._globalParameters.premultiplyAlpha),this.renderer.state.premultiplyAlpha=this._globalParameters.premultiplyAlpha),this._globalParameters.floatingPoint==="half-float"?this.renderer._isWebGL2&&this.renderer.extensions.EXT_color_buffer_float?(this._globalParameters.internalFormat=this.gl.RGBA16F,this._globalParameters.type=this.gl.HALF_FLOAT):this.renderer.extensions.OES_texture_half_float?this._globalParameters.type=this.renderer.extensions.OES_texture_half_float.HALF_FLOAT_OES:this.renderer.production||R(this.type+": could not use half-float textures because the extension is not available"):this._globalParameters.floatingPoint==="float"&&(this.renderer._isWebGL2&&this.renderer.extensions.EXT_color_buffer_float?(this._globalParameters.internalFormat=this.gl.RGBA16F,this._globalParameters.type=this.gl.FLOAT):this.renderer.extensions.OES_texture_float?this._globalParameters.type=this.renderer.extensions.OES_texture_half_float.FLOAT:this.renderer.production||R(this.type+": could not use float textures because the extension is not available"))}_updateTexParameters(){this.index&&this.renderer.state.activeTexture!==this.index&&this._bindTexture(),this.parameters.wrapS!==this._state.wrapS&&(!this.renderer._isWebGL2&&(!ft(this._size.width)||!ft(this._size.height))&&(this.parameters.wrapS=this.gl.CLAMP_TO_EDGE),this.parameters.wrapS!==this.gl.REPEAT&&this.parameters.wrapS!==this.gl.CLAMP_TO_EDGE&&this.parameters.wrapS!==this.gl.MIRRORED_REPEAT&&(this.renderer.production||R(this.type+": Wrong wrapS value",this.parameters.wrapS,"for this texture:",this,`
gl.CLAMP_TO_EDGE wrapping will be used instead`),this.parameters.wrapS=this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.parameters.wrapS),this._state.wrapS=this.parameters.wrapS),this.parameters.wrapT!==this._state.wrapT&&(!this.renderer._isWebGL2&&(!ft(this._size.width)||!ft(this._size.height))&&(this.parameters.wrapT=this.gl.CLAMP_TO_EDGE),this.parameters.wrapT!==this.gl.REPEAT&&this.parameters.wrapT!==this.gl.CLAMP_TO_EDGE&&this.parameters.wrapT!==this.gl.MIRRORED_REPEAT&&(this.renderer.production||R(this.type+": Wrong wrapT value",this.parameters.wrapT,"for this texture:",this,`
gl.CLAMP_TO_EDGE wrapping will be used instead`),this.parameters.wrapT=this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.parameters.wrapT),this._state.wrapT=this.parameters.wrapT),this.parameters.generateMipmap&&!this._state.generateMipmap&&this.source&&(!this.renderer._isWebGL2&&(!ft(this._size.width)||!ft(this._size.height))?this.parameters.generateMipmap=!1:this.gl.generateMipmap(this.gl.TEXTURE_2D),this._state.generateMipmap=this.parameters.generateMipmap),this.parameters.minFilter!==this._state.minFilter&&(!this.renderer._isWebGL2&&(!ft(this._size.width)||!ft(this._size.height))&&(this.parameters.minFilter=this.gl.LINEAR),!this.parameters.generateMipmap&&this.parameters.generateMipmap!==null&&(this.parameters.minFilter=this.gl.LINEAR),this.parameters.minFilter!==this.gl.LINEAR&&this.parameters.minFilter!==this.gl.NEAREST&&this.parameters.minFilter!==this.gl.NEAREST_MIPMAP_NEAREST&&this.parameters.minFilter!==this.gl.LINEAR_MIPMAP_NEAREST&&this.parameters.minFilter!==this.gl.NEAREST_MIPMAP_LINEAR&&this.parameters.minFilter!==this.gl.LINEAR_MIPMAP_LINEAR&&(this.renderer.production||R(this.type+": Wrong minFilter value",this.parameters.minFilter,"for this texture:",this,`
gl.LINEAR filtering will be used instead`),this.parameters.minFilter=this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.parameters.minFilter),this._state.minFilter=this.parameters.minFilter),this.parameters.magFilter!==this._state.magFilter&&(!this.renderer._isWebGL2&&(!ft(this._size.width)||!ft(this._size.height))&&(this.parameters.magFilter=this.gl.LINEAR),this.parameters.magFilter!==this.gl.LINEAR&&this.parameters.magFilter!==this.gl.NEAREST&&(this.renderer.production||R(this.type+": Wrong magFilter value",this.parameters.magFilter,"for this texture:",this,`
gl.LINEAR filtering will be used instead`),this.parameters.magFilter=this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.parameters.magFilter),this._state.magFilter=this.parameters.magFilter);let t=this.renderer.extensions.EXT_texture_filter_anisotropic;if(t&&this.parameters.anisotropy!==this._state.anisotropy){let e=this.gl.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.parameters.anisotropy=Math.max(1,Math.min(this.parameters.anisotropy,e)),this.gl.texParameterf(this.gl.TEXTURE_2D,t.TEXTURE_MAX_ANISOTROPY_EXT,this.parameters.anisotropy),this._state.anisotropy=this.parameters.anisotropy}}setWrapS(t){this.parameters.wrapS!==t&&(this.parameters.wrapS=t,this.parameters._shouldUpdate=!0)}setWrapT(t){this.parameters.wrapT!==t&&(this.parameters.wrapT=t,this.parameters._shouldUpdate=!0)}setMinFilter(t){this.parameters.minFilter!==t&&(this.parameters.minFilter=t,this.parameters._shouldUpdate=!0)}setMagFilter(t){this.parameters.magFilter!==t&&(this.parameters.magFilter=t,this.parameters._shouldUpdate=!0)}setAnisotropy(t){t=isNaN(t)?this.parameters.anisotropy:t,this.parameters.anisotropy!==t&&(this.parameters.anisotropy=t,this.parameters._shouldUpdate=!0)}needUpdate(){this._forceUpdate=!0}_videoFrameCallback(){this._willUpdate=!0,this.source.requestVideoFrameCallback(()=>this._videoFrameCallback())}_upload(){this._updateGlobalTexParameters(),this.source?this.gl.texImage2D(this.gl.TEXTURE_2D,0,this._globalParameters.internalFormat,this._globalParameters.format,this._globalParameters.type,this.source):this.sourceType==="fbo"&&this.gl.texImage2D(this.gl.TEXTURE_2D,0,this._globalParameters.internalFormat,this._size.width,this._size.height,0,this._globalParameters.format,this._globalParameters.type,this.source||null),this._uploaded||(this.renderer.nextRender.add(()=>this._onSourceUploadedCallback&&this._onSourceUploadedCallback()),this._uploaded=!0)}_getSizes(){if(this.sourceType==="fbo")return{parentWidth:this._parent._boundingRect.document.width,parentHeight:this._parent._boundingRect.document.height,sourceWidth:this._parent._boundingRect.document.width,sourceHeight:this._parent._boundingRect.document.height,xOffset:0,yOffset:0};let t=this._parent.scale?Ui.set(this._parent.scale.x,this._parent.scale.y):Ui.set(1,1),e=this._parent._boundingRect.document.width*t.x,i=this._parent._boundingRect.document.height*t.y,s=this._size.width,r=this._size.height,n=s/r,a=e/i,o=0,h=0;return a>n?h=Math.min(0,i-e*(1/n)):a<n&&(o=Math.min(0,e-i*n)),{parentWidth:e,parentHeight:i,sourceWidth:s,sourceHeight:r,xOffset:o,yOffset:h}}setScale(t){if(!t.type||t.type!=="Vec2"){this.renderer.production||R(this.type+": Cannot set scale because the parameter passed is not of Vec2 type:",t);return}t.sanitizeNaNValuesWith(this.scale).max(Ui.set(.001,.001)),t.equals(this.scale)||(this.scale.copy(t),this.resize())}setOffset(t){if(!t.type||t.type!=="Vec2"){this.renderer.production||R(this.type+": Cannot set offset because the parameter passed is not of Vec2 type:",scale);return}t.sanitizeNaNValuesWith(this.offset),t.equals(this.offset)||(this.offset.copy(t),this.resize())}_setSize(){if(this._parent&&this._parent._program){let t=this._getSizes();this._updateTextureMatrix(t)}}resize(){this.sourceType==="fbo"?(this._size={width:this._parent._size&&this._parent._size.width||this._parent._boundingRect.document.width,height:this._parent._size&&this._parent._size.height||this._parent._boundingRect.document.height},this._copiedFrom||(this.gl.bindTexture(this.gl.TEXTURE_2D,this._sampler.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this._globalParameters.internalFormat,this._size.width,this._size.height,0,this._globalParameters.format,this._globalParameters.type,null))):this.source&&(this._size={width:this.source.naturalWidth||this.source.width||this.source.videoWidth,height:this.source.naturalHeight||this.source.height||this.source.videoHeight}),this._setSize()}_updateTextureMatrix(t){let e=sa.set(t.parentWidth/(t.parentWidth-t.xOffset),t.parentHeight/(t.parentHeight-t.yOffset),1);e.x/=this.scale.x,e.y/=this.scale.y,this._textureMatrix.matrix=ra.setFromArray([e.x,0,0,0,0,e.y,0,0,0,0,1,0,(1-e.x)/2+this.offset.x,(1-e.y)/2+this.offset.y,0,1]),this._updateMatrixUniform()}_updateMatrixUniform(){this._textureMatrix.isActive&&(this.renderer.useProgram(this._parent._program),this.gl.uniformMatrix4fv(this._textureMatrix.location,!1,this._textureMatrix.matrix.elements))}_onSourceLoaded(t){this.setSource(t),this.sourceType==="image"&&this.renderer.cache.addTexture(this)}_bindTexture(){this._canDraw&&(this.renderer.state.activeTexture!==this.index&&(this.gl.activeTexture(this.gl.TEXTURE0+this.index),this.renderer.state.activeTexture=this.index),this.gl.bindTexture(this.gl.TEXTURE_2D,this._sampler.texture),this._sampler.isTextureBound||(this._sampler.isTextureBound=!!this.gl.getParameter(this.gl.TEXTURE_BINDING_2D),this._sampler.isTextureBound&&this.renderer.needRender()))}_draw(){this._sampler.isActive&&(this._bindTexture(),this.sourceType==="video"&&this.source&&!this._videoFrameCallbackID&&this.source.readyState>=this.source.HAVE_CURRENT_DATA&&!this.source.paused&&(this._willUpdate=!0),(this._forceUpdate||this._willUpdate&&this.shouldUpdate)&&(this._state.generateMipmap=!1,this._upload()),this.sourceType==="video"&&(this._willUpdate=!1),this._forceUpdate=!1),this.parameters._shouldUpdate&&(this._updateTexParameters(),this.parameters._shouldUpdate=!1)}onSourceLoaded(t){return t&&(this._onSourceLoadedCallback=t),this}onSourceUploaded(t){return t&&(this._onSourceUploadedCallback=t),this}_dispose(t=!1){this.sourceType==="video"||this.sourceType==="image"&&!this.renderer.state.isActive?(this._loader&&this._loader._removeSource(this),this.source=null):this.sourceType==="canvas"&&(this.source.width=this.source.width,this.source=null),this._parent=null,this.gl&&!this._copiedFrom&&(t||this.sourceType!=="image"||!this.renderer.state.isActive)&&(this._canDraw=!1,this.renderer.cache.removeTexture(this),this.gl.activeTexture(this.gl.TEXTURE0+this.index),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.gl.deleteTexture(this._sampler.texture),this._sampler.texture=null)}};var de=class{constructor(t,e="anonymous"){if(this.type="TextureLoader",t=t&&t.renderer||t,!t||t.type!=="Renderer")U(this.type+": Renderer not passed as first argument",t);else if(!t.gl){U(this.type+": Renderer WebGL context is undefined",t);return}this.renderer=t,this.gl=this.renderer.gl,this.crossOrigin=e,this.elements=[]}_addElement(t,e,i,s){let r={source:t,texture:e,load:this._sourceLoaded.bind(this,t,e,i),error:this._sourceLoadError.bind(this,t,s)};return this.elements.push(r),r}_sourceLoadError(t,e,i){e&&e(t,i)}_sourceLoaded(t,e,i){e._sourceLoaded||(e._onSourceLoaded(t),this._parent&&(this._increment&&this._increment(),this.renderer.nextRender.add(()=>this._parent._onLoadingCallback&&this._parent._onLoadingCallback(e))),i&&i(e))}_getSourceType(t){let e;return typeof t=="string"?t.match(/\.(jpeg|jpg|jfif|pjpeg|pjp|gif|bmp|png|webp|svg|avif|apng)$/)!==null?e="image":t.match(/\.(webm|mp4|mpg|mpeg|avi|ogg|ogm|ogv|mov|av1)$/)!==null&&(e="video"):t.tagName.toUpperCase()==="IMG"?e="image":t.tagName.toUpperCase()==="VIDEO"?e="video":t.tagName.toUpperCase()==="CANVAS"&&(e="canvas"),e}_createImage(t){if(typeof t=="string"||!t.hasAttribute("crossOrigin")){let e=new Image;return e.crossOrigin=this.crossOrigin,typeof t=="string"?e.src=t:(e.src=t.src,t.hasAttribute("data-sampler")&&e.setAttribute("data-sampler",t.getAttribute("data-sampler"))),e}else return t}_createVideo(t){if(typeof t=="string"||t.getAttribute("crossOrigin")===null){let e=document.createElement("video");return e.crossOrigin=this.crossOrigin,typeof t=="string"?e.src=t:(e.src=t.src,t.hasAttribute("data-sampler")&&e.setAttribute("data-sampler",t.getAttribute("data-sampler"))),e}else return t}loadSource(t,e,i,s){switch(this._getSourceType(t)){case"image":this.loadImage(t,e,i,s);break;case"video":this.loadVideo(t,e,i,s);break;case"canvas":this.loadCanvas(t,e,i);break;default:this._sourceLoadError(t,s,"this source could not be converted into a texture: "+t);break}}loadSources(t,e,i,s){for(let r=0;r<t.length;r++)this.loadSource(t[r],e,i,s)}loadImage(t,e={},i,s){let r=this.renderer.cache.getTextureFromSource(t),n=Object.assign({},e);if(this._parent&&(n=Object.assign(n,this._parent._texturesOptions)),n.loader=this,r){n.sampler=typeof t!="string"&&t.hasAttribute("data-sampler")?t.getAttribute("data-sampler"):n.sampler,n.fromTexture=r;let l=new nt(this.renderer,n);this._sourceLoaded(r.source,l,i),this._parent&&this._addToParent(l,r.source,"image");return}let a=this._createImage(t);n.sampler=a.hasAttribute("data-sampler")?a.getAttribute("data-sampler"):n.sampler;let o=new nt(this.renderer,n),h=this._addElement(a,o,i,s);a.complete?this._sourceLoaded(a,o,i):a.decode?a.decode().then(this._sourceLoaded.bind(this,a,o,i)).catch(()=>{a.addEventListener("load",h.load,!1),a.addEventListener("error",h.error,!1)}):(a.addEventListener("load",h.load,!1),a.addEventListener("error",h.error,!1)),this._parent&&this._addToParent(o,a,"image")}loadImages(t,e,i,s){for(let r=0;r<t.length;r++)this.loadImage(t[r],e,i,s)}loadVideo(t,e={},i,s){let r=this._createVideo(t);r.preload=!0,r.muted=!0,r.loop=!0,r.setAttribute("playsinline",""),r.crossOrigin=this.crossOrigin;let n=Object.assign({},e);this._parent&&(n=Object.assign(e,this._parent._texturesOptions)),n.loader=this,n.sampler=r.hasAttribute("data-sampler")?r.getAttribute("data-sampler"):n.sampler;let a=new nt(this.renderer,n),o=this._addElement(r,a,i,s);r.addEventListener("canplaythrough",o.load,!1),r.addEventListener("error",o.error,!1),r.readyState>=r.HAVE_FUTURE_DATA&&i&&this._sourceLoaded(r,a,i),r.load(),this._addToParent&&this._addToParent(a,r,"video"),"requestVideoFrameCallback"in HTMLVideoElement.prototype&&(o.videoFrameCallback=a._videoFrameCallback.bind(a),a._videoFrameCallbackID=r.requestVideoFrameCallback(o.videoFrameCallback))}loadVideos(t,e,i,s){for(let r=0;r<t.length;r++)this.loadVideo(t[r],e,i,s)}loadCanvas(t,e={},i){let s=Object.assign({},e);this._parent&&(s=Object.assign(e,this._parent._texturesOptions)),s.loader=this,s.sampler=t.hasAttribute("data-sampler")?t.getAttribute("data-sampler"):s.sampler;let r=new nt(this.renderer,s);this._addElement(t,r,i,null),this._sourceLoaded(t,r,i),this._parent&&this._addToParent(r,t,"canvas")}loadCanvases(t,e,i){for(let s=0;s<t.length;s++)this.loadCanvas(t[s],e,i)}_removeSource(t){let e=this.elements.find(i=>i.texture.uuid===t.uuid);e&&(t.sourceType==="image"?e.source.removeEventListener("load",e.load,!1):t.sourceType==="video"&&(e.videoFrameCallback&&t._videoFrameCallbackID&&e.source.cancelVideoFrameCallback(t._videoFrameCallbackID),e.source.removeEventListener("canplaythrough",e.load,!1),e.source.pause(),e.source.removeAttribute("src"),e.source.load()),e.source.removeEventListener("error",e.error,!1))}};var Ni=class extends de{constructor(t,e,{sourcesLoaded:i=0,sourcesToLoad:s=0,complete:r=!1,onComplete:n=()=>{}}={}){super(t,e.crossOrigin);this.type="PlaneTextureLoader",this._parent=e,this._parent.type!=="Plane"&&this._parent.type!=="PingPongPlane"&&this._parent.type!=="ShaderPass"&&(R(this.type+": Wrong parent type assigned to this loader"),this._parent=null),this.sourcesLoaded=i,this.sourcesToLoad=s,this.complete=r,this.onComplete=n}_setLoaderSize(t){this.sourcesToLoad=t,this.sourcesToLoad===0&&(this.complete=!0,this.renderer.nextRender.add(()=>this.onComplete&&this.onComplete()))}_increment(){this.sourcesLoaded++,this.sourcesLoaded>=this.sourcesToLoad&&!this.complete&&(this.complete=!0,this.renderer.nextRender.add(()=>this.onComplete&&this.onComplete()))}_addSourceToParent(t,e){if(e==="image"){let i=this._parent.images;!i.find(r=>r.src===t.src)&&i.push(t)}else if(e==="video"){let i=this._parent.videos;!i.find(r=>r.src===t.src)&&i.push(t)}else if(e==="canvas"){let i=this._parent.canvases;!i.find(r=>r.isSameNode(t))&&i.push(t)}}_addToParent(t,e,i){this._addSourceToParent(e,i),this._parent&&t.addParent(this._parent)}};var Wi=class{constructor(t,e="Mesh",{vertexShaderID:i,fragmentShaderID:s,vertexShader:r,fragmentShader:n,uniforms:a={},widthSegments:o=1,heightSegments:h=1,renderOrder:l=0,depthTest:d=!0,cullFace:p="back",texturesOptions:f={},crossOrigin:g="anonymous"}={}){if(this.type=e,t=t&&t.renderer||t,(!t||t.type!=="Renderer")&&(U(this.type+": Curtains not passed as first argument or Curtains Renderer is missing",t),setTimeout(()=>{this._onErrorCallback&&this._onErrorCallback()},0)),this.renderer=t,this.gl=this.renderer.gl,!this.gl){this.renderer.production||U(this.type+": Unable to create a "+this.type+" because the Renderer WebGL context is not defined"),setTimeout(()=>{this._onErrorCallback&&this._onErrorCallback()},0);return}this._canDraw=!1,this.renderOrder=l,this._depthTest=d,this.cullFace=p,this.cullFace!=="back"&&this.cullFace!=="front"&&this.cullFace!=="none"&&(this.cullFace="back"),this.textures=[],this._texturesOptions=Object.assign({premultiplyAlpha:!1,anisotropy:1,floatingPoint:"none",wrapS:this.gl.CLAMP_TO_EDGE,wrapT:this.gl.CLAMP_TO_EDGE,minFilter:this.gl.LINEAR,magFilter:this.gl.LINEAR},f),this.crossOrigin=g,!r&&i&&document.getElementById(i)&&(r=document.getElementById(i).innerHTML),!n&&s&&document.getElementById(s)&&(n=document.getElementById(s).innerHTML),this._initMesh(),o=parseInt(o),h=parseInt(h),this._geometry=new Bi(this.renderer,{width:o,height:h}),this._program=new Ne(this.renderer,{parent:this,vertexShader:r,fragmentShader:n}),this._program.compiled?(this._program.createUniforms(a),this.uniforms=this._program.uniformsManager.uniforms,this._geometry.setProgram(this._program),this.renderer.onSceneChange()):this.renderer.nextRender.add(()=>this._onErrorCallback&&this._onErrorCallback())}_initMesh(){this.uuid=ue(),this.loader=new Ni(this.renderer,this,{sourcesLoaded:0,initSourcesToLoad:0,complete:!1,onComplete:()=>{this._onReadyCallback&&this._onReadyCallback(),this.renderer.needRender()}}),this.images=[],this.videos=[],this.canvases=[],this.userData={},this._canDraw=!0}_restoreContext(){this._canDraw=!1,this._matrices&&(this._matrices=null),this._program=new Ne(this.renderer,{parent:this,vertexShader:this._program.vsCode,fragmentShader:this._program.fsCode}),this._program.compiled&&(this._geometry.restoreContext(this._program),this._program.createUniforms(this.uniforms),this.uniforms=this._program.uniformsManager.uniforms,this._programRestored())}setRenderTarget(t){if(!t||t.type!=="RenderTarget"){this.renderer.production||R(this.type+": Could not set the render target because the argument passed is not a RenderTarget class object",t);return}this.type==="Plane"&&this.renderer.scene.removePlane(this),this.target=t,this.type==="Plane"&&this.renderer.scene.addPlane(this)}setRenderOrder(t=0){t=isNaN(t)?this.renderOrder:parseInt(t),t!==this.renderOrder&&(this.renderOrder=t,this.renderer.scene.setPlaneRenderOrder(this))}createTexture(t={}){let e=new nt(this.renderer,Object.assign(this._texturesOptions,t));return e.addParent(this),e}addTexture(t){if(!t||t.type!=="Texture"){this.renderer.production||R(this.type+": cannot add ",t," to this "+this.type+" because it is not a valid texture");return}t.addParent(this)}loadSources(t,e={},i,s){for(let r=0;r<t.length;r++)this.loadSource(t[r],e,i,s)}loadSource(t,e={},i,s){this.loader.loadSource(t,Object.assign(e,this._texturesOptions),r=>{i&&i(r)},(r,n)=>{this.renderer.production||R(this.type+": this HTML tag could not be converted into a texture:",r.tagName),s&&s(r,n)})}loadImage(t,e={},i,s){this.loader.loadImage(t,Object.assign(e,this._texturesOptions),r=>{i&&i(r)},(r,n)=>{this.renderer.production||R(this.type+`: There has been an error:
`,n,`
while loading this image:
`,r),s&&s(r,n)})}loadVideo(t,e={},i,s){this.loader.loadVideo(t,Object.assign(e,this._texturesOptions),r=>{i&&i(r)},(r,n)=>{this.renderer.production||R(this.type+`: There has been an error:
`,n,`
while loading this video:
`,r),s&&s(r,n)})}loadCanvas(t,e={},i){this.loader.loadCanvas(t,Object.assign(e,this._texturesOptions),s=>{i&&i(s)})}loadImages(t,e={},i,s){for(let r=0;r<t.length;r++)this.loadImage(t[r],e,i,s)}loadVideos(t,e={},i,s){for(let r=0;r<t.length;r++)this.loadVideo(t[r],e,i,s)}loadCanvases(t,e={},i){for(let s=0;s<t.length;s++)this.loadCanvas(t[s],e,i)}playVideos(){for(let t=0;t<this.textures.length;t++){let e=this.textures[t];if(e.sourceType==="video"){let i=e.source.play();i!==void 0&&i.catch(s=>{this.renderer.production||R(this.type+": Could not play the video : ",s)})}}}_draw(){this.renderer.setDepthTest(this._depthTest),this.renderer.setFaceCulling(this.cullFace),this._program.updateUniforms(),this._geometry.bindBuffers(),this.renderer.state.forceBufferUpdate=!1;for(let t=0;t<this.textures.length;t++)if(this.textures[t]._draw(),this.textures[t]._sampler.isActive&&!this.textures[t]._sampler.isTextureBound)return;this._geometry.draw(),this.renderer.state.activeTexture=null,this._onAfterRenderCallback&&this._onAfterRenderCallback()}onError(t){return t&&(this._onErrorCallback=t),this}onLoading(t){return t&&(this._onLoadingCallback=t),this}onReady(t){return t&&(this._onReadyCallback=t),this}onRender(t){return t&&(this._onRenderCallback=t),this}onAfterRender(t){return t&&(this._onAfterRenderCallback=t),this}remove(){this._canDraw=!1,this.target&&this.renderer.bindFrameBuffer(null),this._dispose(),this.type==="Plane"?this.renderer.removePlane(this):this.type==="ShaderPass"&&(this.target&&(this.target._shaderPass=null,this.target.remove(),this.target=null),this.renderer.removeShaderPass(this))}_dispose(){if(this.gl){this._geometry&&this._geometry.dispose(),this.target&&this.type==="ShaderPass"&&(this.renderer.removeRenderTarget(this.target),this.textures.shift());for(let t=0;t<this.textures.length;t++)this.textures[t]._dispose();this.textures=[]}}};var cr=new W,na=new W,Pe=class extends Wi{constructor(t,e,i="DOMMesh",{widthSegments:s,heightSegments:r,renderOrder:n,depthTest:a,cullFace:o,uniforms:h,vertexShaderID:l,fragmentShaderID:d,vertexShader:p,fragmentShader:f,texturesOptions:g,crossOrigin:c}={}){l=l||e&&e.getAttribute("data-vs-id"),d=d||e&&e.getAttribute("data-fs-id"),super(t,i,{widthSegments:s,heightSegments:r,renderOrder:n,depthTest:a,cullFace:o,uniforms:h,vertexShaderID:l,fragmentShaderID:d,vertexShader:p,fragmentShader:f,texturesOptions:g,crossOrigin:c}),!!this.gl&&(this.htmlElement=e,(!this.htmlElement||this.htmlElement.length===0)&&(this.renderer.production||R(this.type+": The HTML element you specified does not currently exists in the DOM")),this._setDocumentSizes())}_setDocumentSizes(){let t=this.htmlElement.getBoundingClientRect();this._boundingRect||(this._boundingRect={}),this._boundingRect.document={width:t.width*this.renderer.pixelRatio,height:t.height*this.renderer.pixelRatio,top:t.top*this.renderer.pixelRatio,left:t.left*this.renderer.pixelRatio}}getBoundingRect(){return{width:this._boundingRect.document.width,height:this._boundingRect.document.height,top:this._boundingRect.document.top,left:this._boundingRect.document.left,right:this._boundingRect.document.left+this._boundingRect.document.width,bottom:this._boundingRect.document.top+this._boundingRect.document.height}}resize(){this._setDocumentSizes(),this.type==="Plane"&&(this.setPerspective(this.camera.fov,this.camera.near,this.camera.far),this._setWorldSizes(),this._applyWorldPositions());for(let t=0;t<this.textures.length;t++)this.textures[t].resize();this.renderer.nextRender.add(()=>this._onAfterResizeCallback&&this._onAfterResizeCallback())}mouseToPlaneCoords(t){let e=this.scale?this.scale:na.set(1,1),i=cr.set((this._boundingRect.document.width-this._boundingRect.document.width*e.x)/2,(this._boundingRect.document.height-this._boundingRect.document.height*e.y)/2),s={width:this._boundingRect.document.width*e.x/this.renderer.pixelRatio,height:this._boundingRect.document.height*e.y/this.renderer.pixelRatio,top:(this._boundingRect.document.top+i.y)/this.renderer.pixelRatio,left:(this._boundingRect.document.left+i.x)/this.renderer.pixelRatio};return cr.set((t.x-s.left)/s.width*2-1,1-(t.y-s.top)/s.height*2)}onAfterResize(t){return t&&(this._onAfterResizeCallback=t),this}};var ji=class{constructor({fov:t=50,near:e=.1,far:i=150,width:s,height:r,pixelRatio:n=1}={}){this.position=new k,this.projectionMatrix=new K,this.worldMatrix=new K,this.viewMatrix=new K,this._shouldUpdate=!1,this.setSize(),this.setPerspective(t,e,i,s,r,n)}setFov(t){t=isNaN(t)?this.fov:parseFloat(t),t=Math.max(1,Math.min(t,179)),t!==this.fov&&(this.fov=t,this.setPosition(),this._shouldUpdate=!0),this.setCSSPerspective()}setNear(t){t=isNaN(t)?this.near:parseFloat(t),t=Math.max(t,.01),t!==this.near&&(this.near=t,this._shouldUpdate=!0)}setFar(t){t=isNaN(t)?this.far:parseFloat(t),t=Math.max(t,50),t!==this.far&&(this.far=t,this._shouldUpdate=!0)}setPixelRatio(t){t!==this.pixelRatio&&(this._shouldUpdate=!0),this.pixelRatio=t}setSize(t,e){(t!==this.width||e!==this.height)&&(this._shouldUpdate=!0),this.width=t,this.height=e}setPerspective(t,e,i,s,r,n){this.setPixelRatio(n),this.setSize(s,r),this.setFov(t),this.setNear(e),this.setFar(i),this._shouldUpdate&&this.updateProjectionMatrix()}setPosition(){this.position.set(0,0,1),this.worldMatrix.setFromArray([1,0,0,0,0,1,0,0,0,0,1,0,this.position.x,this.position.y,this.position.z,1]),this.viewMatrix=this.viewMatrix.copy(this.worldMatrix).getInverse()}setCSSPerspective(){this.CSSPerspective=Math.pow(Math.pow(this.width/(2*this.pixelRatio),2)+Math.pow(this.height/(2*this.pixelRatio),2),.5)/Math.tan(this.fov*.5*Math.PI/180)}getScreenRatiosFromFov(t=0){let e=this.position.z;t<e?t-=e:t+=e;let i=this.fov*Math.PI/180,s=2*Math.tan(i/2)*Math.abs(t);return{width:s*this.width/this.height,height:s}}updateProjectionMatrix(){let t=this.width/this.height,e=this.near*Math.tan(Math.PI/180*.5*this.fov),i=2*e,s=t*i,r=-.5*s,n=r+s,a=e-i,o=2*this.near/(n-r),h=2*this.near/(e-a),l=(n+r)/(n-r),d=(e+a)/(e-a),p=-(this.far+this.near)/(this.far-this.near),f=-2*this.far*this.near/(this.far-this.near);this.projectionMatrix.setFromArray([o,0,0,0,0,h,0,0,l,d,p,-1,0,0,f,0])}forceUpdate(){this._shouldUpdate=!0}cancelUpdate(){this._shouldUpdate=!1}};var Zt=class{constructor(t=new Float32Array([0,0,0,1]),e="XYZ"){this.type="Quat",this.elements=t,this.axisOrder=e}setFromArray(t){return this.elements[0]=t[0],this.elements[1]=t[1],this.elements[2]=t[2],this.elements[3]=t[3],this}setAxisOrder(t){switch(t=t.toUpperCase(),t){case"XYZ":case"YXZ":case"ZXY":case"ZYX":case"YZX":case"XZY":this.axisOrder=t;break;default:this.axisOrder="XYZ"}return this}copy(t){return this.elements=t.elements,this.axisOrder=t.axisOrder,this}clone(){return new Zt().copy(this)}equals(t){return this.elements[0]===t.elements[0]&&this.elements[1]===t.elements[1]&&this.elements[2]===t.elements[2]&&this.elements[3]===t.elements[3]&&this.axisOrder===t.axisOrder}setFromVec3(t){let e=t.x*.5,i=t.y*.5,s=t.z*.5,r=Math.cos(e),n=Math.cos(i),a=Math.cos(s),o=Math.sin(e),h=Math.sin(i),l=Math.sin(s);return this.axisOrder==="XYZ"?(this.elements[0]=o*n*a+r*h*l,this.elements[1]=r*h*a-o*n*l,this.elements[2]=r*n*l+o*h*a,this.elements[3]=r*n*a-o*h*l):this.axisOrder==="YXZ"?(this.elements[0]=o*n*a+r*h*l,this.elements[1]=r*h*a-o*n*l,this.elements[2]=r*n*l-o*h*a,this.elements[3]=r*n*a+o*h*l):this.axisOrder==="ZXY"?(this.elements[0]=o*n*a-r*h*l,this.elements[1]=r*h*a+o*n*l,this.elements[2]=r*n*l+o*h*a,this.elements[3]=r*n*a-o*h*l):this.axisOrder==="ZYX"?(this.elements[0]=o*n*a-r*h*l,this.elements[1]=r*h*a+o*n*l,this.elements[2]=r*n*l-o*h*a,this.elements[3]=r*n*a+o*h*l):this.axisOrder==="YZX"?(this.elements[0]=o*n*a+r*h*l,this.elements[1]=r*h*a+o*n*l,this.elements[2]=r*n*l-o*h*a,this.elements[3]=r*n*a-o*h*l):this.axisOrder==="XZY"&&(this.elements[0]=o*n*a-r*h*l,this.elements[1]=r*h*a-o*n*l,this.elements[2]=r*n*l+o*h*a,this.elements[3]=r*n*a+o*h*l),this}};var aa=new W,oa=new k,ha=new k,la=new k,ua=new k,da=new k,ca=new k,dt=new k,ct=new k,fr=new Zt,fa=new k(.5,.5,0),pa=new k,ga=new k,_a=new k,ma=new k,xa=new W,Ut=class extends Pe{constructor(t,e,{widthSegments:i,heightSegments:s,renderOrder:r,depthTest:n,cullFace:a,uniforms:o,vertexShaderID:h,fragmentShaderID:l,vertexShader:d,fragmentShader:p,texturesOptions:f,crossOrigin:g,alwaysDraw:c=!1,visible:_=!0,transparent:m=!1,drawCheckMargins:b={top:0,right:0,bottom:0,left:0},autoloadSources:v=!0,watchScroll:P=!0,fov:x=50}={}){super(t,e,"Plane",{widthSegments:i,heightSegments:s,renderOrder:r,depthTest:n,cullFace:a,uniforms:o,vertexShaderID:h,fragmentShaderID:l,vertexShader:d,fragmentShader:p,texturesOptions:f,crossOrigin:g});!this.gl||(this.index=this.renderer.planes.length,this.target=null,this.alwaysDraw=c,this._shouldDraw=!0,this.visible=_,this._transparent=m,this.drawCheckMargins=b,this.autoloadSources=v,this.watchScroll=P,this._updateMVMatrix=!1,this.camera=new ji({fov:x,width:this.renderer._boundingRect.width,height:this.renderer._boundingRect.height,pixelRatio:this.renderer.pixelRatio}),this._program.compiled&&(this._initPlane(),this.renderer.scene.addPlane(this),this.renderer.planes.push(this)))}_programRestored(){this.target&&this.setRenderTarget(this.renderer.renderTargets[this.target.index]),this._initMatrices(),this.setPerspective(this.camera.fov,this.camera.near,this.camera.far),this._setWorldSizes(),this._applyWorldPositions(),this.renderer.scene.addPlane(this);for(let t=0;t<this.textures.length;t++)this.textures[t]._parent=this,this.textures[t]._restoreContext();this._canDraw=!0}_initPlane(){this._initTransformValues(),this._initPositions(),this.setPerspective(this.camera.fov,this.camera.near,this.camera.far),this._initSources()}_initTransformValues(){this.rotation=new k,this.rotation.onChange(()=>this._applyRotation()),this.quaternion=new Zt,this.relativeTranslation=new k,this.relativeTranslation.onChange(()=>this._setTranslation()),this._translation=new k,this.scale=new k(1),this.scale.onChange(()=>{this.scale.z=1,this._applyScale()}),this.transformOrigin=new k(.5,.5,0),this.transformOrigin.onChange(()=>{this._setWorldTransformOrigin(),this._updateMVMatrix=!0})}resetPlane(t){this._initTransformValues(),this._setWorldTransformOrigin(),t!==null&&!!t?(this.htmlElement=t,this.resize()):!t&&!this.renderer.production&&R(this.type+": You are trying to reset a plane with a HTML element that does not exist. The old HTML element will be kept instead.")}removeRenderTarget(){this.target&&(this.renderer.scene.removePlane(this),this.target=null,this.renderer.scene.addPlane(this))}_initPositions(){this._initMatrices(),this._setWorldSizes(),this._applyWorldPositions()}_initMatrices(){let t=new K;this._matrices={world:{matrix:t},modelView:{name:"uMVMatrix",matrix:t,location:this.gl.getUniformLocation(this._program.program,"uMVMatrix")},projection:{name:"uPMatrix",matrix:t,location:this.gl.getUniformLocation(this._program.program,"uPMatrix")},modelViewProjection:{matrix:t}}}_setPerspectiveMatrix(){this.camera._shouldUpdate&&(this.renderer.useProgram(this._program),this.gl.uniformMatrix4fv(this._matrices.projection.location,!1,this._matrices.projection.matrix.elements)),this.camera.cancelUpdate()}setPerspective(t,e,i){this.camera.setPerspective(t,e,i,this.renderer._boundingRect.width,this.renderer._boundingRect.height,this.renderer.pixelRatio),this.renderer.state.isContextLost&&this.camera.forceUpdate(),this._matrices.projection.matrix=this.camera.projectionMatrix,this.camera._shouldUpdate&&(this._setWorldSizes(),this._applyWorldPositions(),this._translation.z=this.relativeTranslation.z/this.camera.CSSPerspective),this._updateMVMatrix=this.camera._shouldUpdate}_setMVMatrix(){this._updateMVMatrix&&(this._matrices.world.matrix=this._matrices.world.matrix.composeFromOrigin(this._translation,this.quaternion,this.scale,this._boundingRect.world.transformOrigin),this._matrices.world.matrix.scale({x:this._boundingRect.world.width,y:this._boundingRect.world.height,z:1}),this._matrices.modelView.matrix.copy(this._matrices.world.matrix),this._matrices.modelView.matrix.elements[14]-=this.camera.position.z,this._matrices.modelViewProjection.matrix=this._matrices.projection.matrix.multiply(this._matrices.modelView.matrix),this.alwaysDraw||this._shouldDrawCheck(),this.renderer.useProgram(this._program),this.gl.uniformMatrix4fv(this._matrices.modelView.location,!1,this._matrices.modelView.matrix.elements)),this._updateMVMatrix=!1}_setWorldTransformOrigin(){this._boundingRect.world.transformOrigin=new k((this.transformOrigin.x*2-1)*this._boundingRect.world.width,-(this.transformOrigin.y*2-1)*this._boundingRect.world.height,this.transformOrigin.z)}_documentToWorldSpace(t){return ha.set(t.x*this.renderer.pixelRatio/this.renderer._boundingRect.width*this._boundingRect.world.ratios.width,-(t.y*this.renderer.pixelRatio/this.renderer._boundingRect.height)*this._boundingRect.world.ratios.height,t.z)}_setWorldSizes(){let t=this.camera.getScreenRatiosFromFov();this._boundingRect.world={width:this._boundingRect.document.width/this.renderer._boundingRect.width*t.width/2,height:this._boundingRect.document.height/this.renderer._boundingRect.height*t.height/2,ratios:t},this._setWorldTransformOrigin()}_setWorldPosition(){let t={x:this._boundingRect.document.width/2+this._boundingRect.document.left,y:this._boundingRect.document.height/2+this._boundingRect.document.top},e={x:this.renderer._boundingRect.width/2+this.renderer._boundingRect.left,y:this.renderer._boundingRect.height/2+this.renderer._boundingRect.top};this._boundingRect.world.top=(e.y-t.y)/this.renderer._boundingRect.height*this._boundingRect.world.ratios.height,this._boundingRect.world.left=(t.x-e.x)/this.renderer._boundingRect.width*this._boundingRect.world.ratios.width}setScale(t){if(!t.type||t.type!=="Vec2"){this.renderer.production||R(this.type+": Cannot set scale because the parameter passed is not of Vec2 type:",t);return}t.sanitizeNaNValuesWith(this.scale).max(aa.set(.001,.001)),(t.x!==this.scale.x||t.y!==this.scale.y)&&(this.scale.set(t.x,t.y,1),this._applyScale())}_applyScale(){for(let t=0;t<this.textures.length;t++)this.textures[t].resize();this._updateMVMatrix=!0}setRotation(t){if(!t.type||t.type!=="Vec3"){this.renderer.production||R(this.type+": Cannot set rotation because the parameter passed is not of Vec3 type:",t);return}t.sanitizeNaNValuesWith(this.rotation),t.equals(this.rotation)||(this.rotation.copy(t),this._applyRotation())}_applyRotation(){this.quaternion.setFromVec3(this.rotation),this._updateMVMatrix=!0}setTransformOrigin(t){if(!t.type||t.type!=="Vec3"){this.renderer.production||R(this.type+": Cannot set transform origin because the parameter passed is not of Vec3 type:",t);return}t.sanitizeNaNValuesWith(this.transformOrigin),t.equals(this.transformOrigin)||(this.transformOrigin.copy(t),this._setWorldTransformOrigin(),this._updateMVMatrix=!0)}_setTranslation(){let t=oa.set(0,0,0);this.relativeTranslation.equals(t)||(t=this._documentToWorldSpace(this.relativeTranslation)),this._translation.set(this._boundingRect.world.left+t.x,this._boundingRect.world.top+t.y,this.relativeTranslation.z/this.camera.CSSPerspective),this._updateMVMatrix=!0}setRelativeTranslation(t){if(!t.type||t.type!=="Vec3"){this.renderer.production||R(this.type+": Cannot set translation because the parameter passed is not of Vec3 type:",t);return}t.sanitizeNaNValuesWith(this.relativeTranslation),t.equals(this.relativeTranslation)||(this.relativeTranslation.copy(t),this._setTranslation())}_applyWorldPositions(){this._setWorldPosition(),this._setTranslation()}updatePosition(){this._setDocumentSizes(),this._applyWorldPositions()}updateScrollPosition(t,e){(t||e)&&(this._boundingRect.document.top+=e*this.renderer.pixelRatio,this._boundingRect.document.left+=t*this.renderer.pixelRatio,this._applyWorldPositions())}_getIntersection(t,e){let i=e.clone().sub(t),s=t.clone();for(;s.z>-1;)s.add(i);return s}_getNearPlaneIntersections(t,e,i){let s=this._matrices.modelViewProjection.matrix;if(i.length===1)i[0]===0?(e[0]=this._getIntersection(e[1],dt.set(.95,1,0).applyMat4(s)),e.push(this._getIntersection(e[3],ct.set(-1,-.95,0).applyMat4(s)))):i[0]===1?(e[1]=this._getIntersection(e[0],dt.set(-.95,1,0).applyMat4(s)),e.push(this._getIntersection(e[2],ct.set(1,-.95,0).applyMat4(s)))):i[0]===2?(e[2]=this._getIntersection(e[3],dt.set(-.95,-1,0).applyMat4(s)),e.push(this._getIntersection(e[1],ct.set(1,.95,0).applyMat4(s)))):i[0]===3&&(e[3]=this._getIntersection(e[2],dt.set(.95,-1,0).applyMat4(s)),e.push(this._getIntersection(e[0],ct.set(-1,.95,0).applyMat4(s))));else if(i.length===2)i[0]===0&&i[1]===1?(e[0]=this._getIntersection(e[3],dt.set(-1,-.95,0).applyMat4(s)),e[1]=this._getIntersection(e[2],ct.set(1,-.95,0).applyMat4(s))):i[0]===1&&i[1]===2?(e[1]=this._getIntersection(e[0],dt.set(-.95,1,0).applyMat4(s)),e[2]=this._getIntersection(e[3],ct.set(-.95,-1,0).applyMat4(s))):i[0]===2&&i[1]===3?(e[2]=this._getIntersection(e[1],dt.set(1,.95,0).applyMat4(s)),e[3]=this._getIntersection(e[0],ct.set(-1,.95,0).applyMat4(s))):i[0]===0&&i[1]===3&&(e[0]=this._getIntersection(e[1],dt.set(.95,1,0).applyMat4(s)),e[3]=this._getIntersection(e[2],ct.set(.95,-1,0).applyMat4(s)));else if(i.length===3){let r=0;for(let n=0;n<t.length;n++)i.includes(n)||(r=n);e=[e[r]],r===0?(e.push(this._getIntersection(e[0],dt.set(-.95,1,0).applyMat4(s))),e.push(this._getIntersection(e[0],ct.set(-1,.95,0).applyMat4(s)))):r===1?(e.push(this._getIntersection(e[0],dt.set(.95,1,0).applyMat4(s))),e.push(this._getIntersection(e[0],ct.set(1,.95,0).applyMat4(s)))):r===2?(e.push(this._getIntersection(e[0],dt.set(.95,-1,0).applyMat4(s))),e.push(this._getIntersection(e[0],ct.set(1,-.95,0).applyMat4(s)))):r===3&&(e.push(this._getIntersection(e[0],dt.set(-.95,-1,0).applyMat4(s))),e.push(this._getIntersection(e[0],ct.set(-1-.95,0).applyMat4(s))))}else for(let r=0;r<t.length;r++)e[r][0]=1e4,e[r][1]=1e4;return e}_getWorldCoords(){let t=[la.set(-1,1,0),ua.set(1,1,0),da.set(1,-1,0),ca.set(-1,-1,0)],e=[],i=[];for(let o=0;o<t.length;o++){let h=t[o].applyMat4(this._matrices.modelViewProjection.matrix);e.push(h),Math.abs(h.z)>1&&i.push(o)}i.length&&(e=this._getNearPlaneIntersections(t,e,i));let s=Infinity,r=-Infinity,n=Infinity,a=-Infinity;for(let o=0;o<e.length;o++){let h=e[o];h.x<s&&(s=h.x),h.x>r&&(r=h.x),h.y<n&&(n=h.y),h.y>a&&(a=h.y)}return{top:a,right:r,bottom:n,left:s}}_computeWebGLBoundingRect(){let t=this._getWorldCoords(),e={top:1-(t.top+1)/2,right:(t.right+1)/2,bottom:1-(t.bottom+1)/2,left:(t.left+1)/2};e.width=e.right-e.left,e.height=e.bottom-e.top,this._boundingRect.worldToDocument={width:e.width*this.renderer._boundingRect.width,height:e.height*this.renderer._boundingRect.height,top:e.top*this.renderer._boundingRect.height+this.renderer._boundingRect.top,left:e.left*this.renderer._boundingRect.width+this.renderer._boundingRect.left,right:e.left*this.renderer._boundingRect.width+this.renderer._boundingRect.left+e.width*this.renderer._boundingRect.width,bottom:e.top*this.renderer._boundingRect.height+this.renderer._boundingRect.top+e.height*this.renderer._boundingRect.height}}getWebGLBoundingRect(){if(this._matrices.modelViewProjection)(!this._boundingRect.worldToDocument||this.alwaysDraw)&&this._computeWebGLBoundingRect();else return this._boundingRect.document;return this._boundingRect.worldToDocument}_getWebGLDrawRect(){return this._computeWebGLBoundingRect(),{top:this._boundingRect.worldToDocument.top-this.drawCheckMargins.top,right:this._boundingRect.worldToDocument.right+this.drawCheckMargins.right,bottom:this._boundingRect.worldToDocument.bottom+this.drawCheckMargins.bottom,left:this._boundingRect.worldToDocument.left-this.drawCheckMargins.left}}_shouldDrawCheck(){let t=this._getWebGLDrawRect();Math.round(t.right)<=this.renderer._boundingRect.left||Math.round(t.left)>=this.renderer._boundingRect.left+this.renderer._boundingRect.width||Math.round(t.bottom)<=this.renderer._boundingRect.top||Math.round(t.top)>=this.renderer._boundingRect.top+this.renderer._boundingRect.height?this._shouldDraw&&(this._shouldDraw=!1,this.renderer.nextRender.add(()=>this._onLeaveViewCallback&&this._onLeaveViewCallback())):(this._shouldDraw||this.renderer.nextRender.add(()=>this._onReEnterViewCallback&&this._onReEnterViewCallback()),this._shouldDraw=!0)}isDrawn(){return this._canDraw&&this.visible&&(this._shouldDraw||this.alwaysDraw)}enableDepthTest(t){this._depthTest=t}_initSources(){let t=0;if(this.autoloadSources){let e=this.htmlElement.getElementsByTagName("img"),i=this.htmlElement.getElementsByTagName("video"),s=this.htmlElement.getElementsByTagName("canvas");e.length&&this.loadImages(e),i.length&&this.loadVideos(i),s.length&&this.loadCanvases(s),t=e.length+i.length+s.length}this.loader._setLoaderSize(t),this._canDraw=!0}_startDrawing(){this._canDraw&&(this._onRenderCallback&&this._onRenderCallback(),this.target?this.renderer.bindFrameBuffer(this.target):this.renderer.state.scenePassIndex===null&&this.renderer.bindFrameBuffer(null),this._setPerspectiveMatrix(),this._setMVMatrix(),(this.alwaysDraw||this._shouldDraw)&&this.visible&&this._draw())}mouseToPlaneCoords(t){if(fr.setAxisOrder(this.quaternion.axisOrder),fr.equals(this.quaternion)&&fa.equals(this.transformOrigin))return super.mouseToPlaneCoords(t);{let e={x:2*(t.x/(this.renderer._boundingRect.width/this.renderer.pixelRatio))-1,y:2*(1-t.y/(this.renderer._boundingRect.height/this.renderer.pixelRatio))-1},i=this.camera.position.clone(),s=pa.set(e.x,e.y,-.5);s.unproject(this.camera),s.sub(i).normalize();let r=ga.set(0,0,-1);r.applyQuat(this.quaternion).normalize();let n=ma.set(0,0,0),a=r.dot(s);if(Math.abs(a)>=1e-4){let o=this._matrices.world.matrix.getInverse().multiply(this.camera.viewMatrix),h=this._boundingRect.world.transformOrigin.clone().add(this._translation),l=_a.set(this._translation.x-h.x,this._translation.y-h.y,this._translation.z-h.z);l.applyQuat(this.quaternion),h.add(l);let d=r.dot(h.clone().sub(i))/a;n.copy(i.add(s.multiplyScalar(d))),n.applyMat4(o)}else n.set(Infinity,Infinity,Infinity);return xa.set(n.x,n.y)}}onReEnterView(t){return t&&(this._onReEnterViewCallback=t),this}onLeaveView(t){return t&&(this._onLeaveViewCallback=t),this}};var yt=class{constructor(t,{shaderPass:e,depth:i=!1,clear:s=!0,maxWidth:r,maxHeight:n,minWidth:a=1024,minHeight:o=1024,texturesOptions:h={}}={}){if(this.type="RenderTarget",t=t&&t.renderer||t,!t||t.type!=="Renderer")U(this.type+": Renderer not passed as first argument",t);else if(!t.gl){t.production||U(this.type+": Unable to create a "+this.type+" because the Renderer WebGL context is not defined");return}this.renderer=t,this.gl=this.renderer.gl,this.index=this.renderer.renderTargets.length,this._shaderPass=e,this._depth=i,this._shouldClear=s,this._maxSize={width:r||1024*this.renderer.pixelRatio,height:n||1024*this.renderer.pixelRatio},this._minSize={width:a*this.renderer.pixelRatio,height:o*this.renderer.pixelRatio},h=Object.assign({sampler:"uRenderTexture",isFBOTexture:!0,premultiplyAlpha:!1,anisotropy:1,generateMipmap:!1,floatingPoint:"none",wrapS:this.gl.CLAMP_TO_EDGE,wrapT:this.gl.CLAMP_TO_EDGE,minFilter:this.gl.LINEAR,magFilter:this.gl.LINEAR},h),this._texturesOptions=h,this.userData={},this.uuid=ue(),this.renderer.renderTargets.push(this),this.renderer.onSceneChange(),this._initRenderTarget()}_initRenderTarget(){this._setSize(),this.textures=[],this._createFrameBuffer()}_restoreContext(){this._setSize(),this._createFrameBuffer()}_setSize(){this._shaderPass&&this._shaderPass._isScenePass?this._size={width:this.renderer._boundingRect.width,height:this.renderer._boundingRect.height}:this._size={width:Math.min(this._maxSize.width,Math.max(this._minSize.width,this.renderer._boundingRect.width)),height:Math.min(this._maxSize.height,Math.max(this._minSize.height,this.renderer._boundingRect.height))}}resize(){this._shaderPass&&(this._setSize(),this.textures[0].resize(),this.renderer.bindFrameBuffer(this,!0),this._depth&&this._bindDepthBuffer(),this.renderer.bindFrameBuffer(null))}_bindDepthBuffer(){this._depthBuffer&&(this.gl.bindRenderbuffer(this.gl.RENDERBUFFER,this._depthBuffer),this.gl.renderbufferStorage(this.gl.RENDERBUFFER,this.gl.DEPTH_COMPONENT16,this._size.width,this._size.height),this.gl.framebufferRenderbuffer(this.gl.FRAMEBUFFER,this.gl.DEPTH_ATTACHMENT,this.gl.RENDERBUFFER,this._depthBuffer))}_createFrameBuffer(){this._frameBuffer=this.gl.createFramebuffer(),this.renderer.bindFrameBuffer(this,!0),this.textures.length?(this.textures[0]._parent=this,this.textures[0]._restoreContext()):new nt(this.renderer,this._texturesOptions).addParent(this),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,this.textures[0]._sampler.texture,0),this._depth&&(this._depthBuffer=this.gl.createRenderbuffer(),this._bindDepthBuffer()),this.renderer.bindFrameBuffer(null)}getTexture(){return this.textures[0]}remove(){if(this._shaderPass){this.renderer.production||R(this.type+": You're trying to remove a RenderTarget attached to a ShaderPass. You should remove that ShaderPass instead:",this._shaderPass);return}this._dispose(),this.renderer.removeRenderTarget(this)}_dispose(){this._frameBuffer&&(this.gl.deleteFramebuffer(this._frameBuffer),this._frameBuffer=null),this._depthBuffer&&(this.gl.deleteRenderbuffer(this._depthBuffer),this._depthBuffer=null),this.textures[0]._dispose(),this.textures=[]}};var Te=class extends Pe{constructor(t,{widthSegments:e,heightSegments:i,renderOrder:s,depthTest:r,cullFace:n,uniforms:a,vertexShaderID:o,fragmentShaderID:h,vertexShader:l,fragmentShader:d,texturesOptions:p,crossOrigin:f,depth:g=!1,clear:c=!0,renderTarget:_}={}){e=1,i=1,n="back",super(t,t.container,"ShaderPass",{widthSegments:e,heightSegments:i,renderOrder:s,depthTest:r,cullFace:n,uniforms:a,vertexShaderID:o,fragmentShaderID:h,vertexShader:l,fragmentShader:d,texturesOptions:p,crossOrigin:f}),!!this.gl&&(this._isScenePass=!0,this.index=this.renderer.shaderPasses.length,this._depth=g,this._shouldClear=c,this.target=_,this.target&&(this._isScenePass=!1,this._shouldClear=this.target._shouldClear),this._program.compiled&&(this._initShaderPass(),this.renderer.shaderPasses.push(this),this.renderer.nextRender.add(()=>{this.renderer.scene.addShaderPass(this)})))}_programRestored(){this.renderer.scene.addShaderPass(this);for(let t=0;t<this.textures.length;t++)this.textures[t]._parent=this,this.textures[t]._restoreContext();this._canDraw=!0}_initShaderPass(){this.target?(this.setRenderTarget(this.target),this.target._shaderPass=this):this._createFrameBuffer(),new nt(this.renderer,{sampler:"uRenderTexture",isFBOTexture:!0,fromTexture:this.target.getTexture()}).addParent(this),this.loader._setLoaderSize(0),this._canDraw=!0,this.renderer.needRender()}_createFrameBuffer(){let t=new yt(this.renderer,{shaderPass:this,clear:this._shouldClear,depth:this._depth,texturesOptions:this._texturesOptions});this.setRenderTarget(t)}_startDrawing(){this._canDraw&&(this._onRenderCallback&&this._onRenderCallback(),this._isScenePass?this.renderer.state.scenePassIndex+1<this.renderer.scene.stacks.scenePasses.length?(this.renderer.bindFrameBuffer(this.renderer.scene.stacks.scenePasses[this.renderer.state.scenePassIndex+1].target),this.renderer.state.scenePassIndex++):this.renderer.bindFrameBuffer(null):this.renderer.state.scenePassIndex===null&&this.renderer.bindFrameBuffer(null),this.renderer.state.forceBufferUpdate=!0,this._draw())}};var We=class extends Ut{constructor(t,e,{sampler:i="uPingPongTexture",maxWidth:s,maxHeight:r,widthSegments:n,heightSegments:a,renderOrder:o,depthTest:h,cullFace:l,uniforms:d,vertexShaderID:p,fragmentShaderID:f,vertexShader:g,fragmentShader:c,texturesOptions:_,crossOrigin:m,alwaysDraw:b,visible:v,transparent:P,drawCheckMargins:x,autoloadSources:y,watchScroll:T,fov:S}={}){if(h=!1,y=!1,super(t,e,{widthSegments:n,heightSegments:a,renderOrder:o,depthTest:h,cullFace:l,uniforms:d,vertexShaderID:p,fragmentShaderID:f,vertexShader:g,fragmentShader:c,texturesOptions:_,crossOrigin:m,alwaysDraw:b,visible:v,transparent:P,drawCheckMargins:x,autoloadSources:y,watchScroll:T,fov:S}),!this.gl)return;this.renderer.scene.removePlane(this),this.type="PingPongPlane",this.renderer.scene.addPlane(this),this.readPass=new yt(t,{depth:!1,clear:!1,maxWidth:s,maxHeight:r,texturesOptions:_}),this.writePass=new yt(t,{depth:!1,clear:!1,maxWidth:s,maxHeight:r,texturesOptions:_});let w=this.createTexture({sampler:i}),E=0;this.readPass.getTexture().onSourceUploaded(()=>{E++,this._checkIfReady(E)}),this.writePass.getTexture().onSourceUploaded(()=>{E++,this._checkIfReady(E)}),this.setRenderTarget(this.readPass),this._onRenderCallback=()=>{this.readPass&&this.writePass&&this.textures[0]&&this.textures[0]._uploaded&&this.setRenderTarget(this.writePass),this._onPingPongRenderCallback&&this._onPingPongRenderCallback()},this._onAfterRenderCallback=()=>{this.readPass&&this.writePass&&this.textures[0]&&this.textures[0]._uploaded&&this._swapPasses(),this._onPingPongAfterRenderCallback&&this._onPingPongAfterRenderCallback()}}_checkIfReady(t){t===2&&this.renderer.nextRender.add(()=>{this.textures[0].copy(this.target.getTexture())})}_swapPasses(){let t=this.readPass;this.readPass=this.writePass,this.writePass=t,this.textures[0].copy(this.readPass.getTexture())}getTexture(){return this.textures[0]}onRender(t){return t&&(this._onPingPongRenderCallback=t),this}onAfterRender(t){return t&&(this._onPingPongAfterRenderCallback=t),this}remove(){this.target=null,this.renderer.bindFrameBuffer(null),this.writePass&&(this.writePass.remove(),this.writePass=null),this.readPass&&(this.readPass.remove(),this.readPass=null),super.remove()}};var Xi=`
    precision mediump float;
    attribute vec3 aVertexPosition;
    attribute vec2 aTextureCoord;
    uniform mat4 uMVMatrix;
    uniform mat4 uPMatrix;
    uniform mat4 planeTextureMatrix;
    varying vec3 vVertexPosition;
    varying vec2 vTextureCoord;
    void main() { 
        gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
        vVertexPosition = aVertexPosition;
        vTextureCoord = (planeTextureMatrix * vec4(aTextureCoord, 0.0, 1.0)).xy;
    }
`,Hi=`
    precision mediump float;
    varying vec3 vVertexPosition;
    varying vec2 vTextureCoord;
    uniform sampler2D planeTexture;
    uniform float uOpacity;
    void main() {
        vec4 texture = texture2D(planeTexture, vTextureCoord);
        texture.a = uOpacity;
        texture.rgb *= texture.a;
        gl_FragColor = texture;
    }
`,pr=`
    precision mediump float;
    attribute vec3 aVertexPosition;
    attribute vec2 aTextureCoord;
    uniform mat4 uMVMatrix;
    uniform mat4 uPMatrix;
    uniform mat4 planeTextureMatrix;
    varying vec3 vVertexPosition;
    varying vec2 vTextureCoord;
    varying vec2 vOriginTextCoord;
    uniform float uProgress;
    uniform float uStrength;
    const float PI = 3.14159265;
    void main() { 
        vec3 vertexPosition = aVertexPosition;
        float initAmplitude = 1.0;
        float dampingDecay = 0.25;
        float angularFrequency = 1.5 * PI;
        float exponentialStrength = exp(-uProgress * dampingDecay);
        float progress = exponentialStrength * cos(uProgress * angularFrequency) * initAmplitude;        
        float leafEffect = cos(vertexPosition.y * PI * 0.5) * uProgress * uStrength;
        vertexPosition.z = leafEffect;  
        vec3 finalPosition = vertexPosition;
        gl_Position = uPMatrix * uMVMatrix * vec4(finalPosition, 1.0);
        vVertexPosition = finalPosition;
        vOriginTextCoord = aTextureCoord;
        vTextureCoord = (planeTextureMatrix * vec4(aTextureCoord, 0.0, 1.0)).xy;
    }
`,gr=`
    precision mediump float;
    varying vec3 vVertexPosition;
    varying vec2 vTextureCoord;
    varying vec2 vOriginTextCoord;
    uniform sampler2D planeTexture;
    uniform float uOpacity;
    void main() {
        vec4 texture = texture2D(planeTexture, vTextureCoord);
        float distanceToBottom = distance(vec2(vOriginTextCoord.x, 1.0), vOriginTextCoord);
        float spreadFromBottom = clamp((uOpacity * (1.0 - distanceToBottom) - 0.5) + uOpacity * 1.5, 0.0, 1.0);
        texture.a = spreadFromBottom;
        texture.rgb *= texture.a;
        gl_FragColor = texture;
    }
`;var _r=`
    precision highp float;
    attribute vec3 aVertexPosition;
    attribute vec2 aTextureCoord;
    uniform mat4 uMVMatrix;
    uniform mat4 uPMatrix;
    varying vec3 vVertexPosition;
    varying vec2 vTextureCoord;
    void main() {
        vec3 vertexPosition = aVertexPosition;
        gl_Position = uPMatrix * uMVMatrix * vec4(vertexPosition, 1.0);
        vTextureCoord = aTextureCoord;
        vVertexPosition = vertexPosition;
    }
`,mr=`
    precision highp float;
    varying vec3 vVertexPosition;
    varying vec2 vTextureCoord;
    uniform sampler2D uPingPong;
    uniform vec2 uMousePosition;
    uniform float uAlpha;
    uniform float uDissipation;
    uniform vec2 uVelocity;
    uniform float uAspect;
    uniform float uSize;
    uniform float uDensity;
    uniform float uSpreadUp;
    uniform float uAlphaTest;
    void main() {
        vec2 textCoords = vTextureCoord;
        vec4 color = texture2D(uPingPong, textCoords) * (1.0 - uDissipation);
        vec2 mouseTexPos = (uMousePosition + 1.0) * 0.5;
        vec2 cursor = vTextureCoord - mouseTexPos;
        cursor.x *= uAspect;
        vec3 stamp = vec3(uVelocity * vec2(1.0, -1.0), 1.0 - pow(1.0 - min(1.0, length(uVelocity)), 100.0));
        float falloff = smoothstep(uSize * 0.1, 0.0, length(cursor)) * uAlpha;
        color.rgb = mix(color.rgb, stamp, vec3(falloff));
        color.rgb = color.rgb * color.a;
        gl_FragColor = color;
    }
`;var xr=`
    precision highp float;
    varying vec3 vVertexPosition;
    varying vec2 vTextureCoord;
    uniform sampler2D uRenderTexture;
    uniform sampler2D uPingPongTexture;
    uniform sampler2D uBlurTexture;
    uniform vec2 uResolution;
    uniform float uTime;
    uniform float uStrength;
    uniform float uPointerOpacity;
    uniform vec2 uVelocity;       
    uniform float uShowTrailTexture;
    uniform float uShowBlurredTexture;
    float random (in vec2 st) {
        return fract(sin(dot(st.xy,
                         vec2(12.9898,78.233)))
                 * 43758.5453123);
    }
    float noise (in vec2 st) {
        vec2 i = floor(st);
        vec2 f = fract(st);
        float a = random(i);
        float b = random(i + vec2(1.0, 0.0));
        float c = random(i + vec2(0.0, 1.0));
        float d = random(i + vec2(1.0, 1.0));
        vec2 u = f*f*(3.0-2.0*f);
        return mix(a, b, u.x) +
                (c - a)* u.y * (1.0 - u.x) +
                (d - b) * u.x * u.y;
    }
    void main() {
        float pnoise = noise((gl_FragCoord.xy / uResolution.xx) * 6.25);
        vec2 displacedCoords = vTextureCoord;
        displacedCoords.x += sin((pnoise - 0.5) * 0.1) * sin(uTime * 0.0166) * uStrength;
        displacedCoords.y += sin((pnoise - 0.5) * 0.1) * sin(uTime * 0.0166) * uStrength;
        vec4 pingPongTexture = texture2D(uPingPongTexture, displacedCoords);
        vec4 renderTexture = texture2D(uRenderTexture, vTextureCoord);
        vec4 blurredTexture = texture2D(uBlurTexture, vTextureCoord);           
        gl_FragColor = mix(renderTexture, blurredTexture, pingPongTexture.b * renderTexture.a * blurredTexture.a);         
    }
`;var Gi=class{constructor({app:t,onLoading:e=()=>{}}){if(!!t)if(this.app=t,this.width=this.app.store.window.width,this.height=this.app.store.window.height,this.screenDiag=Math.hypot(this.width,this.height),this.onLoading=e,this.introImages=webglTextures&&webglTextures.intro||[],this.introImageRenderOrder=0,this.homepageImages=webglTextures&&webglTextures.grid||[],this.textures=[],this.trailPlanesEl=document.querySelectorAll(".home-trail-plane"),this.loadedEls=0,this.scroll=0,this.app.perf<=this.app.state.webglPerfThreshold&&!this.app.state.isMobile){let i=Math.min(2,this.app.state.pixelRatio);this.mouseInteraction={distance:0,ratio:1,total:0},this.curtains=new Be({container:this.app.webglContainer,production:!0,pixelRatio:i,premultipliedAlpha:!0,autoRender:!1,autoResize:!1,watchScroll:!1}).onSuccess(()=>{this.mouse=new W,this.lastMouse=new W,this.velocity=new W,this.lerpedVelocity=new W,this.app.eventsEmitter.addEvents({resize:this.onResize.bind(this),render:this.render.bind(this),scroll:this.onScroll.bind(this)}),this.trailRenderTarget=new yt(this.curtains,{depth:!1}),this.blurredRT=new yt(this.curtains,{depth:!1}),this.addPingPongPlane(),this.addTrailFXPlane();let s=this.introImages.length+this.homepageImages.length,r=new de(this.curtains);r.loadImages(this.introImages,{sampler:"planeTexture"},n=>{n.onSourceUploaded(()=>{this.loadedEls++,this.textures.push(n),this.onLoading&&this.onLoading(Math.round(100*this.loadedEls/s))})},(n,a)=>{console.warn("there has been an error",a," while loading this image",n),this.loadedEls++,this.onLoading&&this.onLoading(Math.round(100*this.loadedEls/s))}),r.loadImages(this.homepageImages,{sampler:"planeTexture",minFilter:this.curtains.gl.LINEAR_MIPMAP_NEAREST},n=>{n.onSourceUploaded(()=>{this.loadedEls++,this.textures.push(n),this.onLoading&&this.onLoading(Math.round(100*this.loadedEls/s))})},(n,a)=>{console.warn("there has been an error",a," while loading this image",n),this.loadedEls++,this.onLoading&&this.onLoading(Math.round(100*this.loadedEls/s))})}).onError(()=>{this.curtains=null,document.body.classList.add("no-curtains"),this.onLoading&&this.onLoading(100)})}else this.curtains=null,document.body.classList.add("no-curtains"),this.onLoading&&this.onLoading(100)}addPlanes(){if(this.curtains){this.addIntroPlanes(),this.addTrailPlanes();let t=document.getElementById("home-intro-plane"),e=document.querySelector(".home-trail-plane");if(!t&&!e){let i=this.curtains.planes>1;this.curtains.planes.forEach(s=>{s.type!=="PingPongPlane"&&s.remove()}),i&&this.clearScene()}this.curtains.planes.length<=1?this.curtains.disableDrawing():this.curtains.enableDrawing()}}disableDrawing(){this.curtains&&this.curtains.disableDrawing()}enableDrawing(){this.curtains&&this.curtains.planes.length>1&&this.curtains.enableDrawing()}render(){this.curtains&&(this.velocity.set(this.mouse.x-this.lastMouse.x,this.mouse.y-this.lastMouse.y),this.lerpedVelocity.set(this.curtains.lerp(this.lerpedVelocity.x,this.velocity.x,.05),this.curtains.lerp(this.lerpedVelocity.y,this.velocity.y,.05)),this.lastMouse.copy(this.mouse),this.trailPlanes&&this.trailPlanes.length&&this.trailPlanes.forEach((t,e)=>{t.userData.textScale.set(this.curtains.lerp(t.userData.textScale.x,t.userData.lerpedTextScale,.1),this.curtains.lerp(t.userData.textScale.y,t.userData.lerpedTextScale,.1)),t.textures.length&&t.textures[0].setScale(t.userData.textScale),this.blurredPlanes&&this.blurredPlanes.length>=e&&this.blurredPlanes[e].textures.length&&this.blurredPlanes[e].textures[0].setScale(t.userData.textScale)}),this.curtains&&this.curtains.render())}onResize(t){this.curtains&&this.curtains.resize(),this.width=t.width,this.height=t.height,this.screenDiag=Math.hypot(this.width,this.height),this.applyTrailPlaneParallax()}onScroll(t){this.curtains&&(this.scroll=parseFloat(t.current),this.curtains.updateScrollValues(0,this.scroll),this.applyTrailPlaneParallax())}onMouseMove(t){this.mouse.set(t.x,t.y)}addPingPongPlane(){let t=this.curtains.getBoundingRect();this.pingPong=new We(this.curtains,this.curtains.container,{vertexShader:_r,fragmentShader:mr,watchScroll:!1,autoloadSources:!1,sampler:"uPingPong",maxWidth:256*this.curtains.pixelRatio,maxHeight:256*this.curtains.pixelRatio,texturesOptions:{floatingPoint:"half-float"},uniforms:{mousePosition:{name:"uMousePosition",type:"2f",value:this.mouse},size:{name:"uSize",type:"1f",value:1.5},alpha:{name:"uAlpha",type:"1f",value:1},dissipation:{name:"uDissipation",type:"1f",value:.01},alphaTest:{name:"uAlphaTest",type:"1f",value:.125},spreadUp:{name:"uSpreadUp",type:"1f",value:0},velocity:{name:"uVelocity",type:"2f",value:this.lerpedVelocity.clone()},aspect:{name:"uAspect",type:"1f",value:t.width/t.height},density:{name:"uDensity",type:"1f",value:1}}}),this.pingPong.onRender(()=>{this.pingPong.uniforms.mousePosition.value=this.pingPong.mouseToPlaneCoords(this.mouse),this.pingPong.uniforms.velocity.value=this.lerpedVelocity.clone()}).onAfterResize(()=>{t=this.pingPong.getBoundingRect(),this.pingPong.uniforms.aspect.value=t.width/t.height})}addTrailFXPlane(){let t=this.curtains.getBoundingRect();this.trailFXPlane=new Te(this.curtains,{fragmentShader:xr,renderTarget:this.trailRenderTarget,uniforms:{resolution:{name:"uResolution",type:"2f",value:new W(t.width,t.height)},time:{name:"uTime",type:"1f",value:0},noiseStrength:{name:"uStrength",type:"1f",value:1.5},pointerOpacity:{name:"uPointerOpacity",type:"1f",value:1},velocity:{name:"uVelocity",type:"2f",value:this.velocity.clone()},showBlurredTexture:{name:"uShowBlurredTexture",type:"1f",value:0},showTrailTexture:{name:"uShowTrailTexture",type:"1f",value:0}}});let e=this.trailFXPlane.createTexture({sampler:"uPingPongTexture",fromTexture:this.pingPong.getTexture()});this.trailFXPlane.createTexture({sampler:"uBlurTexture",fromTexture:this.blurredRT.getTexture()}),this.trailFXPlane.onRender(()=>{this.trailFXPlane.uniforms.time.value++,this.trailFXPlane.uniforms.velocity.value=this.velocity.clone()}).onAfterResize(()=>{t=this.curtains.getBoundingRect(),this.trailFXPlane.uniforms.resolution.value=new W(t.width,t.height)})}addIntroPlanes(){let t=document.getElementById("home-intro-plane");if(this.introPlanesTl={tl:null,active:!1,nbPlanesShown:0,buttons:document.querySelectorAll(".home-intro-col button, #page-404-title button")},t){let e=this.curtains.getBoundingRect();this.introPlanes=[],this.introPlanesShown=0,this.introPlaneScales=[{x:1.33,y:1},{x:1,y:1},{x:1,y:1.33}],this.introImages.forEach((i,s)=>{let r=new Ut(this.curtains,t,{vertexShader:pr,fragmentShader:gr,heightSegments:30,depthTest:!1,uniforms:{progress:{name:"uProgress",type:"1f",value:0},strength:{name:"uStrength",type:"1f",value:-.25},opacity:{name:"uOpacity",type:"1f",value:1}}});this.initIntroPlane(r,s),r.userData.tween=null,this.introPlanes.push(r),r.visible=!1;let n=this.textures.find(a=>a.source&&a.source.src===i);n&&r.addTexture(n)}),this.shuffleIntroPlanes()}}observeIntroPlanes(){this.app.observers.main.observe({selector:"#home-intro-plane",stagger:250,keepObserving:!1,alwaysTrigger:!1,onElVisible:t=>{this.showIntroPlanes([this.introPlanes[0]])}}),this.introPlanesTl.buttons.length&&this.introPlanesTl.buttons.forEach(t=>{t.addEventListener("click",this.handleButtonClick.bind(this))})}initIntroPlane(t,e){let i=this.curtains.getBoundingRect(),s=this.introPlaneScales[Math.floor(Math.random()*3)];t.scale.x=s.x,t.scale.y=s.y,t.uniforms.strength.value=-.25*s.y;let r=Math.random()*.25-.125;t.rotation.z=r,t.userData.mainPosition=new k,t.userData.shown=!1,t.userData.initPosition=new k(-i.width*.5*Math.sin(r),-i.height*.25,1500),t.userData.endPosition=new k(i.width*.25*Math.sin(r),i.height*.175,500),t.relativeTranslation.copy(t.userData.initPosition),t.onAfterResize(()=>{let n=this.curtains.getBoundingRect();t.userData.initPosition=new k(-n.width*.25*Math.sin(r),-n.height*.25,1500),t.userData.endPosition=new k(n.width*.25*Math.sin(r),n.height*.25,1500),t.userData.shown?t.relativeTranslation.copy(t.userData.mainPosition):t.relativeTranslation.copy(t.userData.initPosition)})}shuffleIntroPlanes(){this.introImageRenderOrder=0;let t=this.introPlanes.length,e;for(;t!=0;)e=Math.floor(Math.random()*t),t--,[this.introPlanes[t],this.introPlanes[e]]=[this.introPlanes[e],this.introPlanes[t]];this.introPlanes.forEach((i,s)=>{i.setRenderOrder(-s),this.initIntroPlane(i,s)})}handleButtonClick(){!this.introPlanesTl.active&&this.introPlanesTl.nbPlanesShown<this.introPlanes.length?this.showIntroPlanes(this.introPlanes.slice(this.introPlanesTl.nbPlanesShown,this.introPlanes.length)):this.hideIntroPlanes([...this.introPlanes].reverse())}showIntroPlanes(t){if(this.introPlanesTl.active)return;this.introPlanesTl.active=!0,this.introPlanesTl.tl&&this.introPlanesTl.tl.kill(),this.introPlanesTl.tl=D.timeline({paused:!0,onComplete:()=>{this.introPlanesTl.active=!1}});let e=1.25,i="power2.out";t.forEach((s,r)=>{s.visible=!0,s.rotation.x=Math.PI/1.5,s.relativeTranslation.copy(s.userData.initPosition),s.uniforms.opacity.value=1,this.introPlanesTl.tl.to(s.relativeTranslation,{x:s.userData.mainPosition.x,y:s.userData.mainPosition.y,duration:e,ease:i,onComplete:()=>{s.userData.shown=!0,this.introPlanesTl.nbPlanesShown++}},r*.2).to(s.rotation,{x:0,duration:e,ease:"power4.out",onUpdate:()=>{let n=1-Math.abs(Math.cos(s.rotation.x));s.uniforms.progress.value=n,s.relativeTranslation.z=n*s.userData.initPosition.z}},r*.2)}),this.introPlanesTl.tl.restart(!0)}hideIntroPlanes(t){if(this.introPlanesTl.active)return;this.introPlanesTl.active=!0,this.introPlanesTl.tl&&this.introPlanesTl.tl.kill(),this.introPlanesTl.tl=D.timeline({paused:!0,onComplete:()=>{this.introPlanesTl.active=!1,this.shuffleIntroPlanes(),this.showIntroPlanes([this.introPlanes[0]])}});let e=1,i="power2.in";t.forEach((s,r)=>{this.introPlanesTl.tl.to(s.relativeTranslation,{x:s.userData.endPosition.x,y:s.userData.endPosition.y,duration:e,ease:i,onComplete:()=>{s.userData.shown=!1,s.visible=!1,this.introPlanesTl.nbPlanesShown--}},r*.215).to(s.rotation,{x:-Math.PI/8,duration:e,ease:i,onUpdate:()=>{let n=1-Math.abs(Math.cos(s.rotation.x));s.uniforms.progress.value=n,s.relativeTranslation.z=n*s.userData.endPosition.z}},r*.215).to(s.uniforms.opacity,{value:0,duration:e*3/4,delay:e/4,ease:i},r*.215)}),this.introPlanesTl.tl.restart(!0)}addTrailPlanes(){this.trailPlanes=[],this.blurredPlanes=[],document.querySelectorAll(".home-trail-plane").forEach((t,e)=>{let i=new Ut(this.curtains,t,{vertexShader:Xi,fragmentShader:Hi,autoloadSources:!1,uniforms:{opacity:{name:"uOpacity",type:"1f",value:0}}});i.userData.textScale=new W(1),i.userData.lerpedTextScale=1,i.userData.refIndex=e;let s=i.htmlElement.querySelector("img"),r=this.textures.find(o=>o.source&&o.source.src===s.getAttribute("src"));r&&i.addTexture(r),i.setRenderTarget(this.trailRenderTarget),i.userData.tween=null,this.trailPlanes.push(i);let n=new Ut(this.curtains,t,{vertexShader:Xi,fragmentShader:Hi,autoloadSources:!1,uniforms:{opacity:{name:"uOpacity",type:"1f",value:1}}}),a=this.textures.find(o=>o.source&&o.source.src===t.getAttribute("data-blur"));a&&n.addTexture(a),n.userData.refIndex=e,n.setRenderTarget(this.blurredRT),this.blurredPlanes.push(n)}),this.app.observers.main.observe({selector:".home-trail-plane",stagger:100,triggerRatio:.25,keepObserving:!1,alwaysTrigger:!1,onElVisible:t=>{let e=this.trailPlanes.find(s=>s.htmlElement.isSameNode(t.el)),i=this.blurredPlanes.find(s=>s.htmlElement.isSameNode(t.el));e&&i&&(e.userData.tween&&e.userData.tween.kill(),e.userData.tween=D.timeline().to(e.uniforms.opacity,{value:1,duration:.35,ease:"linear"}))}}),this.applyTrailPlaneParallax()}applyTrailPlaneParallax(){this.trailPlanes&&this.trailPlanes.length&&this.trailPlanes.forEach((t,e)=>{let i=t.getBoundingRect(),s=i.top+i.height/2,r=Math.max(0,s/this.curtains.pixelRatio-this.height*.5)/(this.height*.5),n=Math.pow(r,2)*.2+1;t.userData.lerpedTextScale=n})}removePlanes(){this.curtains&&(this.introPlanesTl.buttons.length&&this.introPlanesTl.buttons.forEach(t=>{t.removeEventListener("click",this.handleButtonClick.bind(this))}),this.introPlanesTl.buttons=[],this.introPlanesTl.tl&&this.introPlanesTl.tl.kill(),this.introPlanesTl.active=!1,this.introPlanesTl.nbPlanesShown=0,this.curtains.planes.forEach(t=>{t.type!=="PingPongPlane"&&(t.userData.tween&&t.userData.tween.kill(),t.remove())}),this.clearScene())}clearScene(){this.introPlanes=[],this.trailPlanes=[],this.blurredPlanes=[],this.mouseInteraction.distance=0,this.mouseInteraction.total=0,this.curtains.clear(),this.curtains.gl.bindFramebuffer(this.curtains.gl.FRAMEBUFFER,this.blurredRT._frameBuffer),this.curtains.gl.viewport(0,0,this.blurredRT._size.width,this.blurredRT._size.height),this.curtains.clear(),this.curtains.gl.bindFramebuffer(this.curtains.gl.FRAMEBUFFER,this.trailRenderTarget._frameBuffer),this.curtains.gl.viewport(0,0,this.trailRenderTarget._size.width,this.trailRenderTarget._size.height),this.curtains.clear(),this.curtains.disableDrawing()}};var Yi=class{constructor({app:t}){this.app=t,this.filterButtons=[],this.filterTl=null,this.resetTween=null,this.isFiltering=!1,this.archiveLinks=[],this.archiveThumbs=[]}init(){this.filterMenu=document.querySelector(".archive-filters-cat-list"),this.filterArchive=document.querySelector(".archive-filters-post-list"),this.filterMenu&&this.filterArchive&&(this.filterButtons=this.filterMenu.querySelectorAll("button"),this.duplicateArchive=this.filterArchive.cloneNode(!0),this.duplicateArchive.setAttribute("id","projects-archive-post-list-duplicate"),this.duplicateArchive.classList.add("archive-filters-post-list-duplicate"),this.filterArchive.closest(".archive-filters-post-list-content").appendChild(this.duplicateArchive),this.filterButtons.forEach(e=>{e.addEventListener("click",this.onFilterClicked.bind(this))}));let t=document.querySelectorAll(".projects-archive-thumbs-list-item");t&&!this.app.state.isMobile&&(t.forEach(e=>{this.archiveThumbs.push({el:e,tween:null,visible:!1})}),this.archiveLinks=document.querySelectorAll(".archive-post-list-item-link"),this.archiveLinks.forEach(e=>{e.addEventListener("mouseenter",this.onMouseLinkEnter.bind(this)),e.addEventListener("mouseleave",this.onMouseLinkLeave.bind(this))}))}onFilterClicked(t){let e=t.target.getAttribute("data-filter");!e||(this.filterButtons.forEach(i=>i.classList.remove("active")),t.target.classList.add("active"),this.isFiltering?this.resetTween=D.to([this.filterArchive,this.duplicateArchive],{autoAlpha:0,duration:.1,onComplete:()=>{D.set([this.filterArchive,this.duplicateArchive],{autoAlpha:1}),this.animateFilterArchive(e)}}):this.animateFilterArchive(e))}filterArchiveList(t,e){t.querySelectorAll("li").forEach(i=>{if(i.classList.contains(e)){if(i.classList.remove("hidden"),!i.classList.contains("filtered-once")){let s=i.querySelector("a");this.app.observers.main.unobserveEl(s);let r=s.querySelectorAll(".skewed-title-line");D.set(r,{autoAlpha:1})}i.classList.add("filtered-once")}else i.classList.add("hidden")})}animateFilterArchive(t){this.isFiltering=!0,this.filterTl&&this.filterTl.kill(),this.filterArchiveList(this.duplicateArchive,t);let e=this.app.store.scroll,i=this.filterArchive.querySelectorAll("li:not(.hidden)"),s=this.duplicateArchive.querySelectorAll("li:not(.hidden)");this.filterTl=D.timeline().to(i,{autoAlpha:0,duration:.2,stagger:.05,ease:"power1.out"},0).to(i,{yPercent:-100,skewY:-5,duration:.2,stagger:.05,ease:"power3.inOut"},0).fromTo(s,{autoAlpha:0},{autoAlpha:1,duration:.2,stagger:.05,ease:"power1.in",onStart:()=>{this.duplicateArchive.style.opacity=1}},.2).fromTo(s,{yPercent:50,skewY:-5},{yPercent:0,skewY:0,duration:.4,stagger:.05,ease:"power4.out",onStart:()=>{this.duplicateArchive.style.opacity=1},onComplete:()=>{this.filterArchiveList(this.filterArchive,t),D.set(this.filterArchive.querySelectorAll("li:not(.hidden)"),{autoAlpha:1,yPercent:0,skewY:0}),this.duplicateArchive.style.opacity=0,this.app.smoothScroll&&this.app.smoothScroll.update(),this.isFiltering=!1}},.2),e.y!==0&&this.filterTl.to(e,{y:0,duration:.5,ease:"power1.out",onUpdate:()=>{window.scrollTo(0,e.y),this.app.smoothScroll&&this.app.smoothScroll.scrollTo(e.y)}},0)}onMouseLinkEnter(t){let e=t.target.getAttribute("data-project");if(!e)return;let i=this.archiveThumbs.find(s=>s.el.getAttribute("id")===e+"-thumb");i&&(i.tween&&i.tween.kill(),i.visible=!0,i.tween=D.fromTo(i.el,{autoAlpha:0,rotateX:10,rotateY:10,scale:.85},{autoAlpha:1,rotateX:0,rotateY:0,scale:1,duration:.5,ease:"power2.out"}))}onMouseLinkLeave(t){this.archiveThumbs.forEach(e=>{e.visible&&(e.tween&&e.tween.kill(),e.visible=!1,e.tween=D.to(e.el,{autoAlpha:0,rotateX:-10,rotateY:-10,scale:.85,duration:.25,ease:"power2.in"}))})}destroy(){this.resetTween&&this.resetTween.kill(),this.filterTl&&this.filterTl.kill(),this.filterButtons.forEach(t=>{t.removeEventListener("click",this.onFilterClicked)}),this.filterButtons=[],this.isFiltering=!1,this.app.state.isMobile||this.archiveLinks.forEach(t=>{t.removeEventListener("mouseenter",this.onMouseLinkEnter.bind(this)),t.removeEventListener("mouseleave",this.onMouseLinkLeave.bind(this))}),this.archiveLinks=[],this.archiveThumbs.forEach(t=>{t.tween&&t.tween.kill()}),this.archiveThumbs=[]}};var qi=class{constructor({app:t}){this.app=t,this.paths=[]}init(){this.paths=[],this.tween=null,this.visibleRatio=0,document.querySelectorAll(".horizontal-path").forEach(t=>{let e={el:t,endPos:t.getBoundingClientRect().top+this.app.store.scroll.y,scale:0,visibleRatio:0};e.startPos=e.endPos-this.app.store.window.height,this.paths.push(e)}),this.showAnimation()}showAnimation(){this.tween=D.to(this,{visibleRatio:1,duration:1.5,delay:.5,ease:"power4.out",onUpdate:()=>{this.onScroll({current:this.app.store.scroll.y})}})}onResize(t){this.paths.forEach(e=>{e.endPos=pathEl.getBoundingClientRect().top+this.app.store.scroll.y,e.startPos=e.endPos-t.height})}map(t,e,i,s,r){return(t-e)/(i-e)*(r-s)+s}onScroll(t){this.paths.forEach(e=>{e.scale=Math.min(1,Math.max(0,this.map(t.current,e.startPos,e.endPos,0,1))),e.el.style.transform="scale3d("+e.scale*this.visibleRatio+", 1, 1)"})}destroy(){this.tween&&this.tween.kill(),this.paths=[]}};var Qi=class{constructor({app:t}){this.app=t,this.sizes=this.app.store.window,this.scroll=this.app.store.scroll.y,this.projectNavLinks=[]}init(){document.querySelectorAll(".single-project-nav-item").forEach((e,i)=>{let s=e.getBoundingClientRect(),r={el:e,boundingRect:s,centerOffsetTop:s.top+s.height*.5-this.sizes.height*.5,initScrollValue:this.scroll,strength:.85,parallaxValue:0,rotateValue:0,direction:e.hasAttribute("data-direction")?e.getAttribute("data-direction"):1};r.applyParallax=()=>{let n=r.centerOffsetTop-(this.scroll-r.initScrollValue);n=Math.max(0,n),n/=this.sizes.height*.5,n=Math.pow(n,2),n*=this.sizes.height*.5,r.parallaxValue=r.direction*r.strength*n,r.rotateValue=r.parallaxValue/(this.sizes.height*.5),r.el.style.transform="translate3d("+r.parallaxValue+"px, 0, 0)"},r.applyParallax(),this.projectNavLinks.push(r)})}onScroll(t){this.scroll=t.current,this.projectNavLinks.forEach(e=>{e.applyParallax()})}onResize(t){t.isMobileResize||(this.sizes=t,this.projectNavLinks.forEach(e=>{e.boudingRect=e.el.getBoundingClientRect(),e.centerOffsetTop=e.boudingRect.top+e.boundingRect.height*.5-this.sizes.height*.5,e.initScrollValue=this.scroll,e.applyParallax()}))}destroy(){this.projectNavLinks=[]}};var Zi=class{constructor({app:t}){this.app=t,!this.app.state.isMobile&&(this.cursor={parent:document.getElementById("custom-cursor"),children:[],active:null},document.querySelectorAll(".custom-cursor-inner").forEach(e=>{this.cursor.children.push({el:e,tween:null,isActive:!1})}),this.boundingRect=this.cursor.parent.getBoundingClientRect(),this.scale={x:0,y:0},this.observedEls=[],document.body.addEventListener("pointerdown",()=>{this.cursor.active&&(this.cursor.active.tween&&this.cursor.active.tween.kill(),this.tween=D.to(this.cursor.active.el,{scale:.8,duration:.2,ease:"power3.out"}))}),document.body.addEventListener("pointerup",()=>{this.cursor.active&&(this.cursor.active.tween&&this.cursor.active.tween.kill(),this.tween=D.to(this.cursor.active.el,{scale:1,duration:.2,ease:"power3.in"}))}))}onMouseMove(t){!this.cursor||!this.observedEls.length||(this.cursor.parent.style.transform="translate3d("+(t.x-this.boundingRect.width/2)+"px, "+(t.y-this.boundingRect.height/2)+"px, 0)")}observeHover(){!this.cursor||(this.observedEls=document.querySelectorAll("[data-cursor]"),this.observedEls.forEach(t=>{t.addEventListener("mouseenter",this.onMouseEnter.bind(this)),t.addEventListener("mouseleave",this.onMouseLeave.bind(this))}))}unobserveHover(){!this.cursor||(this.cursor.active&&this.onMouseLeave(),this.observedEls.forEach(t=>{t.removeEventListener("mouseenter",this.onMouseEnter),t.removeEventListener("mouseleave",this.onMouseLeave)}),this.observedEls=[])}onMouseEnter(t){if(!t.target.hasAttribute("data-cursor"))return;let e=t.target.getAttribute("data-cursor"),i=this.cursor.children.find(s=>s.el.getAttribute("id")==="custom-cursor-"+e);i&&(i.isActive=!0,this.cursor.active=i,this.animateCursor(i,!0))}onMouseLeave(){!this.cursor.active||(this.cursor.active.isActive=!1,this.animateCursor(this.cursor.active,!1),this.cursor.active=null)}animateCursor(t,e){e?t.el.classList.add("active"):t.el.classList.remove("active"),t.tween&&t.tween.kill(),t.tween=D.to(t.el,{scale:e?1:0,duration:.33,ease:"power3.inOut"})}};var Ki=class{constructor(t={}){this.options={element:t.element||document.getElementById("slider"),easing:t.easing||.1,dragSpeed:t.dragSpeed||1,duration:t.duration||750},this.app=t.app,this.sizes=this.app.store.window,this.isMouseDown=!1,this.isTranslating=!1,this.currentPosition=0,this.startPosition=0,this.endPosition=0,this.translation=0,this.slides=Array.from(this.options.element.children),this.loadImages(),this.isVisible=!1,this.app.observers.main.observe({elements:[this.options.element.closest(".slider")],stagger:100,triggerRatio:.5,keepObserving:!1,alwaysTrigger:!1,onElVisible:e=>{this.isVisible=!0,this.showSlider()}}),this.setupSlider()}loadImages(){this.images=[],this.loadedEls=0,this.isLoaded=!1,this.slides.forEach(t=>{let e=t.querySelector("img");e?e.complete?this.imageLoaded():(e.addEventListener("load",this.imageLoaded.bind(this)),this.images.push(e)):this.imageLoaded()})}imageLoaded(){this.loadedEls++,this.loadedEls===this.slides.length&&(this.isLoaded=!0,this.showSlider())}showSlider(){this.isLoaded&&this.isVisible&&(this.setBoundaries(),this.showTween=D.timeline({}).fromTo(this.slides,{rotateZ:10,yPercent:25},{rotateZ:0,yPercent:0,duration:1.25,ease:"power3.out",stagger:.175,onComplete:()=>{this.options.element.closest(".slider").classList.remove("loading")}}).fromTo(this.slides,{autoAlpha:0},{autoAlpha:1,duration:.75,ease:"linear",stagger:.175},.2))}lerp(t,e,i){return i=i<0?0:i,i=i>1?1:i,(1-i)*t+i*e}getMousePosition(t){let e;return t.targetTouches?t.targetTouches[0]?e=[t.targetTouches[0].clientX,t.targetTouches[0].clientY]:t.changedTouches[0]?e=[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:e=[t.clientX,t.clientY]:e=[t.clientX,t.clientY],e}setBoundaries(){let t=this.sizes.width-document.body.clientWidth,e=this.slides[0].getBoundingClientRect(),i=this.slides[this.slides.length-1].getBoundingClientRect(),s=e.left+i.right+t;this.boundaries={max:-1*s+this.sizes.width,min:0,sliderSize:s},this.direction=0,this.app.smoothScroll&&!this.app.smoothScroll.resizeObserver&&this.app.smoothScroll.update()}translateSlider(t){t=Math.floor(t*100)/100,this.options.element.style.transform="translate3d("+t+"px, 0, 0)",this.isTranslating&&!this.isMouseDown&&(this.isTranslating=!1),this.translation=t}render(){let t=this.lerp(this.translation,this.currentPosition,this.options.easing);this.translateSlider(t)}onMouseDown(t){this.isMouseDown=!0,this.options.element.classList.add("dragged");let e=this.getMousePosition(t);this.startPosition=e[this.direction]}onMouseMove(t){if(!this.isMouseDown)return;let e=this.getMousePosition(t);this.currentPosition=this.endPosition+(e[this.direction]-this.startPosition)*this.options.dragSpeed,this.currentPosition>this.boundaries.min&&this.currentPosition<this.boundaries.max?this.isTranslating=!0:(this.currentPosition=Math.min(this.currentPosition,this.boundaries.min),this.currentPosition=Math.max(this.currentPosition,this.boundaries.max))}onMouseUp(t){this.isMouseDown=!1,this.options.element.classList.remove("dragged"),this.endPosition=this.currentPosition;let e=this.getMousePosition(t)}onResize(t){if(t.isMobileResize)return;this.sizes=t;let e=this.boundaries?this.translation/this.boundaries.sliderSize:0;this.options.element.style.transform="translate3d(0, 0, 0)",this.setBoundaries();let i=e*this.boundaries.sliderSize;i=Math.min(i,this.boundaries.min),i=Math.max(i,this.boundaries.max),this.translateSlider(i),this.currentPosition=i,this.endPosition=i}setupSlider(){this.options.element.addEventListener("mousemove",this.onMouseMove.bind(this),{passive:!0}),this.options.element.addEventListener("mousedown",this.onMouseDown.bind(this)),window.addEventListener("mouseup",this.onMouseUp.bind(this)),this.options.element.addEventListener("touchmove",this.onMouseMove.bind(this),{passive:!0}),this.options.element.addEventListener("touchstart",this.onMouseDown.bind(this),{passive:!0}),window.addEventListener("touchend",this.onMouseUp.bind(this))}destroySlider(){this.images.forEach(t=>{t.removeEventListener("load",this.imageLoaded)}),this.options.element.removeEventListener("mousemove",this.onMouseMove,{passive:!0}),this.options.element.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mouseup",this.onMouseUp),this.options.element.removeEventListener("touchmove",this.onMouseMove,{passive:!0}),this.options.element.removeEventListener("touchstart",this.onMouseDown,{passive:!0}),window.removeEventListener("touchend",this.onMouseUp),this.showTween&&this.showTween.kill()}destroy(){this.destroySlider()}};var Ji=class{constructor({app:t,element:e}){this.app=t,this.textBlock=e,this.contactLink=null,this.textBlock.querySelectorAll("p").forEach(s=>{this.splitTextByLines(s)});let i=this.textBlock.querySelectorAll(".splitted-text-line");this.showTl=D.timeline({paused:!0}).set(this.textBlock,{autoAlpha:1}).fromTo(i,{autoAlpha:0},{autoAlpha:1,duration:.5,stagger:.05,ease:"linear"}).fromTo(i,{skewY:-5,yPercent:50},{skewY:0,yPercent:0,duration:1,stagger:.05,ease:"power4.out",onComplete:()=>{this.textBlock.classList.add("shown")}},0),this.app.observers.main.observe({elements:[this.textBlock],stagger:300,keepObserving:!1,alwaysTrigger:!1,onBeforeElVisible:s=>{s.el.hasAttribute("data-stagger")&&(s.stagger=parseInt(s.el.getAttribute("data-stagger")))},onElVisible:s=>{this.showTl&&this.showTl.restart(!0)}}),this.contactLink=document.querySelector("#contact-main-content a"),this.contactLink&&(this.contactLink.addEventListener("mouseenter",this.onMouseLinkEnter.bind(this)),this.contactLink.addEventListener("mouseleave",this.onMouseLinkLeave.bind(this)))}splitTextByLines(t){let e=[],i=[],s=[],r=0;t.childNodes.forEach(o=>{if(o.nodeName.toUpperCase()==="BR"){i.push(r);return}let h=o;if(o.nodeType===3)s.push(null);else{let _=o.cloneNode();_.textContent="",s.push(_),h=document.createTextNode(o.textContent)}let l=document.createRange();l.setStart(h,0);let d=l.getBoundingClientRect().bottom,p=h.textContent||"",f=1,g=0,c=0;if(p.length)for(;f<=p.length;)l.setStart(h,f),f<p.length-1&&l.setEnd(h,f+1),c=l.getBoundingClientRect().bottom,c>d&&(e.push(p.substr(g,f-g)),d=c,g=f,r++,s.push(null)),f++;e.push(p.substr(g)),r++});let a="";e.forEach((o,h)=>{if(s[h]){s[h].innerHTML=o;let p=document.createElement("div");p.appendChild(s[h]),o=p.innerHTML}let l=h<o.length-1?o+" ":o,d=i.find(p=>p===h)?"splitted-text-line splitted-text-line-break":"splitted-text-line";a+='<span class="'+d+'">'+l+"</span>"}),t.innerHTML=a}onMouseLinkEnter(t){document.body.classList.add("mailto-hovered")}onMouseLinkLeave(t){document.body.classList.remove("mailto-hovered")}destroy(){this.showTl&&this.showTl.kill(),this.showTl=null,this.contactLink&&(this.contactLink.removeEventListener("mouseenter",this.onMouseLinkEnter.bind(this)),this.contactLink.removeEventListener("mouseleave",this.onMouseLinkLeave.bind(this))),this.contactLink=null}};var $i=class{constructor({app:t}){this.app=t,this.videos=[]}init(){document.querySelectorAll(".single-project-video-el").forEach(t=>{let e={el:t,canPlay:!1,isPlaying:!1,listener:this.app.state.isSafari?"loadedmetadata":"canplay",hasListener:!1,isVisible:!1,promise:null};e.el.readyState>=e.el.HAVE_FUTURE_DATA?this.canPlayVideo(e):(e.el.addEventListener(e.listener,this.canPlayVideo.bind(this,e)),e.hasListener=!0),e.el.addEventListener("playing",this.onVideoPlaying.bind(this,e)),this.videos.push(e)}),this.app.observers.main.observe({selector:".single-project-video-el",stagger:0,keepObserving:!0,alwaysTrigger:!1,onElVisible:t=>{let e=this.videos.find(i=>i.el.isSameNode(t.el));e&&(e.isVisible=!0,e.isPlaying||this.playVideo(e))},onElHidden:t=>{let e=this.videos.find(i=>i.el.isSameNode(t.el));e&&(e.isVisible=!1,e.isPlaying&&this.pauseVideo(e))}})}canPlayVideo(t){t.canPlay=!0,t.isVisible&&!t.isPlaying&&this.playVideo(t)}onVideoPlaying(t){t.isPlaying=!0}playVideo(t){t.el.play()}pauseVideo(t){t.el.pause(),t.isPlaying=!1}destroy(){this.videos.forEach(t=>{t.isPlaying&&this.pauseVideo(t),t.promise=null,t.hasListener&&t.el.removeEventListener(t.listener,this.canPlayVideo),t.el.removeEventListener("playing",this.onVideoPlaying)}),this.videos=[]}};var ts=class{constructor({app:t}){this.app=t,this.button=null,this.tween=null}init(){this.button=document.getElementById("back-to-top"),this.button&&(this.button.addEventListener("click",this.goToTop.bind(this)),this.app.observers.main.observe({selector:"#back-to-top",stagger:100,keepObserving:!1,alwaysTrigger:!1,onElVisible:t=>{t.el.classList.add("visible")}}))}goToTop(){if(this.app.perf<6){let t={y:window.pageYOffset},e=Math.min(2.5,t.y/1500);this.tween=D.to(t,{duration:e,y:0,ease:"circ.inOut",onUpdate:()=>{window.scrollTo(0,t.y)}})}else window.scrollTo(0,0)}destroy(){this.tween&&this.tween.kill(),this.button&&this.button.removeEventListener("click",this.goToTop.bind(this)),this.button=null}};var yr=class{constructor({production:t=!1,useSmoothScroll:e=!1,transitionDuration:i=750,appContainer:s,webglContainer:r,analyticsID:n}){this.production=t,this.useSmoothScroll=e,this.transitionDuration=i,this.appContainer=s&&document.querySelector(s),this.webglContainer=r&&document.querySelector(r),this.analyticsID=n,this.init()}init(){this.state={loaded:!1,namespace:null,pixelRatio:window.devicePixelRatio||1,webglPerfThreshold:3,isMobile:document.body.classList.contains("mobile-body"),isSafari:!!navigator.userAgent.match(/Version\/[\d.]+.*Safari/),iOS:/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,menuOpened:!1,scrolled100vh:!1,headerTopHeight:0},this.initStore(),this.checkPerf(),this.eventsEmitter=new Li({listeners:["resize","scroll","mouse","lerpedMouse","render"]}),this.observers=[],this.initAnalytics(),window.addEventListener("load",this.onWindowLoad.bind(this)),window.addEventListener("resize",this.onResize.bind(this));let t=!1;window.addEventListener("mousemove",e=>{!this.state.isMobile&&this.state.isSafari?t||(this.onMouseMove(e),t=!0,setTimeout(()=>{t=!1},17)):this.onMouseMove(e)})}initStore(){let t=window.innerWidth,e=window.innerHeight;this.store={window:{width:t,height:e},scroll:{x:0,y:window.pageYOffset},mouse:{current:{x:0,y:0},lerped:{x:0,y:0}},pageVars:{tweens:[]},sliders:[],textBlocks:[]}}checkPerf(){this.perf=0;let t=(performance||Date).now(),e=[];for(let r=0;r<2e4;r++)e=Math.pow(Math.sin(Math.random()),2);let i=(performance||Date).now()-t;i<7?this.perf=1:i<14?this.perf=2:i<22?this.perf=3:this.perf=4;let s=window.matchMedia("(prefers-reduced-motion: reduce");window.location.href.indexOf("no-motion")!==-1?s=!1:window.location.href.indexOf("no-webgl")!==-1&&(this.perf=this.state.webglPerfThreshold+1),!s||s.matches?(this.perf=6,document.body.classList.add("no-motion")):this.perf>this.state.webglPerfThreshold&&document.body.classList.add("reduced-motion")}startServiceWorker(){"serviceWorker"in navigator&&this.production&&navigator.serviceWorker.register("/sw.js")}initAnalytics(){this.analyticsID&&this.production&&(window.dataLayer=window.dataLayer||[],this.gtag=function(){dataLayer.push(arguments)},this.gtag("js",new Date),this.gtag("config",this.analyticsID))}onResize(){let t=window.innerWidth,e=t===this.store.window.width&&this.state.isMobile;if(this.store.window={width:t,height:window.innerHeight},window.CSS&&CSS.supports("height","var(--vh)")&&!e){let i=this.store.window.height*.01;document.documentElement.style.setProperty("--vh",i+"px")}this.state.headerTopHeight=document.getElementById("header-top").getBoundingClientRect().height,this.eventsEmitter.emitEvent("resize",{width:this.store.window.width,height:this.store.window.height,isMobileResize:e})}onScroll(t){this.store.scroll={x:0,y:parseFloat(t.current||0)},this.eventsEmitter.emitEvent("scroll",t),t.current>=this.store.window.height-this.state.headerTopHeight*.5&&!this.state.scrolled100vh?(document.body.classList.add("scrolled-100vh"),this.state.scrolled100vh=!0):t.current<this.store.window.height-this.state.headerTopHeight*.5&&this.state.scrolled100vh&&(document.body.classList.remove("scrolled-100vh"),this.state.scrolled100vh=!1)}onRender(){this.store.mouse.lerped={x:this.lerp(this.store.mouse.lerped.x,this.store.mouse.current.x,.1),y:this.lerp(this.store.mouse.lerped.y,this.store.mouse.current.y,.1)},this.eventsEmitter.emitEvent("lerpedMouse",this.store.mouse.lerped),this.eventsEmitter.emitEvent("render")}onMouseMove(t){t.targetTouches?this.store.mouse.current={x:t.targetTouches[0].clientX,y:t.targetTouches[0].clientY}:this.store.mouse.current={x:t.clientX,y:t.clientY},this.eventsEmitter.emitEvent("mouse",this.store.mouse.current)}onWindowLoad(){this.setPageClasses(),!this.state.isMobile&&this.appContainer&&this.useSmoothScroll&&this.perf<6?(this.smoothScroll=new je({container:this.appContainer,inertia:.075}),this.smoothScroll.onScroll(t=>{this.onScroll(t)}),this.eventsEmitter.addEvents({resize:this.smoothScroll.resize.bind(this.smoothScroll),render:this.smoothScroll.render.bind(this.smoothScroll)}),"ResizeObserver"in window&&(this.smoothScroll.resizeObserver=new ResizeObserver(t=>{t[0]&&t[0].contentRect&&t[0].contentRect.height&&this.smoothScroll.update(t[0].contentRect.height)}),this.smoothScroll.resizeObserver.observe(this.appContainer)),this.eventsEmitter.addEvents({resize:this.smoothScroll.resize.bind(this.smoothScroll),render:this.smoothScroll.render.bind(this.smoothScroll)}),window.addEventListener("keyup",t=>{if((t.keyCode?t.keyCode:t.which)===9){let i=document.activeElement;this.smoothScroll.scrollTo(i.getBoundingClientRect().top+this.store.scroll.y-100)}})):this.perf<6&&window.addEventListener("scroll",()=>{let t=window.pageYOffset,e=t-this.store.scroll.y,i=((1-.5)*e).toFixed(2);this.onScroll({current:t,velocity:i})}),this.startServiceWorker(),this.handleMainMenu(),this.perf<6?(this.startRouting(),this.setObserver({name:"main",threshold:[0,.1,.25,.5,.75,.9,1]}),this.archiveFilters=new Yi({app:this}),this.horizontalPath=new qi({app:this}),this.eventsEmitter.addEvents({scroll:this.horizontalPath.onScroll.bind(this.horizontalPath),resize:this.horizontalPath.onResize.bind(this.horizontalPath)}),this.scrollNavLinks=new Qi({app:this}),this.eventsEmitter.addEvents({scroll:this.scrollNavLinks.onScroll.bind(this.scrollNavLinks),resize:this.scrollNavLinks.onResize.bind(this.scrollNavLinks)}),this.customCursor=new Zi({app:this}),this.eventsEmitter.addEvents({lerpedMouse:this.customCursor.onMouseMove.bind(this.customCursor)}),this.videoElements=new $i({app:this}),this.backToTop=new ts({app:this}),this.initWebGL(),D&&D.ticker.add(this.onRender.bind(this))):this.siteLoaded(!1)}handleMainMenu(){this.state.headerTopHeight=document.getElementById("header-top").getBoundingClientRect().height;let t=document.getElementById("header-menu"),e=document.querySelector("#header-top button");if(e){this.mainMenuTl=D.timeline({paused:!0,delay:this.perf<6?.2:0,onStart:()=>{this.webglLayer&&this.webglLayer.disableDrawing()}});let i=document.querySelectorAll("#header-menu a");this.mainMenuTl.fromTo(i,{autoAlpha:0},{autoAlpha:1,duration:this.perf<6?.5:0,stagger:.1,ease:"linear"}).fromTo(i,{rotateX:60,rotateY:45,yPercent:50},{rotateX:0,rotateY:0,yPercent:0,duration:this.perf<6?1:0,stagger:.1,ease:"power4.out"},0),e.addEventListener("click",()=>{document.body.classList.toggle("menu-shown"),this.state.menuOpened=!this.state.menuOpened,this.state.menuOpened?this.mainMenuTl.restart(!0):this.webglLayer&&this.webglLayer.enableDrawing(),this.toggleTabIndex()}),i.forEach(s=>{s.addEventListener("click",()=>{this.state.menuOpened=!this.state.menuOpened,this.toggleTabIndex();let r=s.getAttribute("href");(window.location.pathname===r||window.location.href===r)&&(document.body.classList.remove("menu-shown"),this.webglLayer&&this.webglLayer.enableDrawing())}),s.addEventListener("mouseenter",()=>{let r=s.getAttribute("data-color");t.style.backgroundColor=r})})}}toggleTabIndex(){this.state.menuOpened?this.appContainer.querySelectorAll("a, button").forEach(t=>{t.setAttribute("tabindex",-1)}):this.appContainer.querySelectorAll("a, button").forEach(t=>{t.setAttribute("tabindex","")})}initWebGL(){let t=document.getElementById("loader-svg-circle"),e=t.getAttribute("r");this.webglLayer=new Gi({app:this,onLoading:i=>{if(!this.state.loaded){let s=Math.PI*e*2,r=(100-i)/100*s;t.setAttribute("stroke-dashoffset",r),document.getElementById("loader-percent").innerText=i+"%",i===100&&!this.state.loaded&&(document.getElementById("loader-percent").innerHTML="<span>1</span><span>0</span><span>0</span><span>%</span>",this.state.loaded=!0,setTimeout(()=>{this.siteLoaded(!0)},200))}}})}siteLoaded(t=!0){document.getElementById("loader").classList.add("loading-finished"),document.getElementById("loader-svg-circle").setAttribute("stroke-dashoffset","615.752"),this.state.loaded=!0,document.body.classList.remove("site-loading"),t?setTimeout(()=>{this.onSiteLoaded()},1e3):this.onSiteLoaded()}onSiteLoaded(){this.onScroll({current:this.store.scroll.y}),this.onPageLoad(),this.webglLayer&&this.webglLayer.curtains&&this.eventsEmitter.addEvents({mouse:this.webglLayer.onMouseMove.bind(this.webglLayer)}),setTimeout(()=>{this.afterPageLoad()},200)}setNameSpace(){this.state.namespace=document.getElementById("page").getAttribute("data-namespace"),this.state.namespace==="projects-single"?document.body.classList.add("is-single-project"):document.body.classList.remove("is-single-project")}setPageClasses(){let t=document.getElementById("routing-inner").getAttribute("class");document.getElementById("site").setAttribute("class",t),document.getElementById("site").classList.remove("no-motion")}startRouting(){this.router=new He({container:this.appContainer||document.body,cancelNavigationClass:"out",cacheNavigatedPages:!0,preloadMedias:!1,cacheLength:20,cacheLinks:"#header-menu a, .home-list-item, #projects-archive-post-list .archive-post-list-item-link",onStart:{value:(t,e)=>{this.beforePageUnload(t,e),document.body.classList.add("page-transition")}},onLeaving:{duration:this.transitionDuration,value:(t,e)=>{this.onPageUnload(),document.body.classList.remove("menu-shown")}},onReady:{value:(t,e)=>{this.setPageClasses(),this.smoothScroll?(this.smoothScroll.resizeObserver||this.smoothScroll.update(),this.smoothScroll.scrollTo(0)):window.scrollTo(0,0),this.onPageLoad(),setTimeout(()=>{this.afterPageLoad()},200),this.analyticsID&&this.gtag&&this.production&&this.gtag("config",this.analyticsID,{page_path:window.location.pathname}),document.body.classList.remove("page-transition","transition-loading")}},onWaiting:{value:(t,e)=>{document.body.classList.add("transition-loading")}},onError:{value:()=>{document.body.classList.remove("page-transition","transition-loading")}}})}onPageLoad(){this.setNameSpace(),this.webglLayer&&this.webglLayer.addPlanes(),this.smoothScroll&&(document.querySelectorAll(".smooth-fixed-el").forEach(t=>{this.smoothScroll.fixedEls.push({el:t,position:t.hasAttribute("data-position")?parseFloat(t.getAttribute("data-position")):0})}),this.smoothScroll.updatePosition()),this.archiveFilters.init(),this.customCursor.observeHover()}afterPageLoad(){this.observers.main.observe({selector:".scroll-item",stagger:100,keepObserving:!1,alwaysTrigger:!1,onElVisible:t=>{t.el.classList.add("visible")}}),this.webglLayer&&!this.webglLayer.curtains&&this.observers.main.observe({selector:".home-list-item",stagger:100,keepObserving:!1,alwaysTrigger:!1,onElVisible:t=>{t.el.classList.add("visible")}}),document.querySelectorAll(".splitted-text-block").forEach(t=>{let e=new Ji({app:this,element:t});this.store.textBlocks.push(e)}),this.observers.main.observe({selector:".scroll-skewed-title",stagger:100,keepObserving:!1,alwaysTrigger:!1,onBeforeElVisible:t=>{t.el.classList.contains("about-clients-list-item")&&(t.stagger=50),t.el.hasAttribute("data-stagger")&&(t.stagger=parseInt(t.el.getAttribute("data-stagger")))},onElVisible:t=>{this.animateSkewedTitles(t.el)}}),this.videoElements.init(),this.backToTop.init(),this.horizontalPath.init(),this.scrollNavLinks.init(),document.querySelectorAll(".slider-inner").forEach(t=>{let e=new Ki({app:this,element:t,easing:.1,dragSpeed:this.state.isMobile?2:1});this.eventsEmitter.addEvents({resize:e.onResize.bind(e),render:e.render.bind(e)}),this.store.sliders.push(e)}),this.observers.main.observe({selector:".footer-scroll-skewed-title",stagger:100,keepObserving:!1,alwaysTrigger:!1,onElVisible:t=>{this.animateSkewedTitles(t.el)}}),this.webglLayer&&this.webglLayer.curtains&&this.webglLayer.observeIntroPlanes()}beforePageUnload(t,e){}onPageUnload(){this.webglLayer&&this.webglLayer.removePlanes();for(let t=0;t<this.store.pageVars.tweens.length;t++)this.store.pageVars.tweens[t].kill(),this.store.pageVars.tweens[t]=null;this.store.pageVars.tweens=[],this.smoothScroll&&(this.smoothScroll.scrollTo(0),this.smoothScroll.fixedEls=[]),this.archiveFilters.destroy(),this.horizontalPath.destroy(),this.scrollNavLinks.destroy(),this.videoElements.destroy(),this.backToTop.destroy(),this.customCursor.unobserveHover(),this.store.sliders.forEach(t=>t.destroy()),this.store.sliders=[],this.store.textBlocks.forEach(t=>t.destroy()),this.store.textBlocks=[],this.observers.main.unobserveAll()}setObserver({name:t,root:e,rootMargin:i,threshold:s=[0,.25,.5,.75,1],onError:r=()=>{},onElVisible:n=()=>{},onElHidden:a=()=>{}}){this.observers[t||"observer-"+this.observers.length]=new Xe({threshold:s,root:e,rootMargin:i})}animateSkewedTitles(t){let e=t.querySelectorAll(".skewed-title-line"),i=D.timeline().fromTo(e,{autoAlpha:0},{autoAlpha:1,duration:.5,stagger:.1,ease:"linear"}).fromTo(e,{skewY:-10,yPercent:100},{skewY:0,yPercent:0,duration:1,stagger:.1,ease:"power4.out"},0)}lerp(t,e,i){return i=i<0?0:i,i=i>1?1:i,(1-i)*t+i*e}},fl=new yr({analyticsID:"G-HN3EKLK2WP",production:!0,useSmoothScroll:!0,appContainer:"#routing-container",webglContainer:"#canvas"});})();
/*!
 * CSSPlugin 3.7.1
 * https://greensock.com
 *
 * Copyright 2008-2021, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/
/*!
 * GSAP 3.7.1
 * https://greensock.com
 *
 * @license Copyright 2008-2021, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/
